(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2254],{42176:function(e,t,a){"use strict";a.d(t,{D:function(){return h}});var i=a(87462),n=a(63366),r=a(67294),l=a(28714),s=a(77527),o=a(94780),d=a(73490),c=a(48836),u=a(85893);let m=["className","children"],p=e=>{let{classes:t}=e;return(0,o.Z)({root:["toolbarContainer"]},d.d,t)},f=(0,s.ZP)("div",{name:"MuiDataGrid",slot:"ToolbarContainer",overridesResolver:(e,t)=>t.toolbarContainer})(({theme:e})=>({display:"flex",alignItems:"center",flexWrap:"wrap",padding:e.spacing(.5,.5,0)})),h=r.forwardRef(function(e,t){let{className:a,children:r}=e,s=(0,n.Z)(e,m),o=(0,c.B)(),d=p(o);return r?(0,u.jsx)(f,(0,i.Z)({ref:t,className:(0,l.Z)(a,d.root),ownerState:o},s,{children:r})):null})},6132:function(e,t,a){"use strict";a.d(t,{S:function(){return p}});var i=a(87462),n=a(63366),r=a(67294),l=a(14696),s=a(10269),o=a(27476),d=a(49630),c=a(48836),u=a(85893);let m=["onClick"],p=r.forwardRef(function(e,t){var a;let{onClick:r}=e,p=(0,n.Z)(e,m),f=(0,d.l)(),h=(0,c.B)(),{open:g,openedPanelValue:b}=(0,l.P)(f,s.e);return h.disableColumnSelector?null:(0,u.jsx)(h.components.BaseButton,(0,i.Z)({ref:t,size:"small","aria-label":f.current.getLocaleText("toolbarColumnsLabel"),startIcon:(0,u.jsx)(h.components.ColumnSelectorIcon,{})},p,{onClick:e=>{g&&b===o.y.columns?f.current.hidePreferences():f.current.showPreferences(o.y.columns),null==r||r(e)}},null==(a=h.componentsProps)?void 0:a.baseButton,{children:f.current.getLocaleText("toolbarColumns")}))})},50853:function(e,t,a){"use strict";a.d(t,{M:function(){return E}});var i=a(87462),n=a(63366),r=a(67294),l=a(77527),s=a(94780),o=a(79533),d=a(66643),c=a(90198),u=a(14696),m=a(61207),p=a(10269),f=a(27476),h=a(49630),g=a(48836),b=a(73490),x=a(85893);let v=["componentsProps"],w=e=>{let{classes:t}=e;return(0,s.Z)({root:["toolbarFilterList"]},b.d,t)},y=(0,l.ZP)("ul",{name:"MuiDataGrid",slot:"ToolbarFilterList",overridesResolver:(e,t)=>t.toolbarFilterList})(({theme:e})=>({margin:e.spacing(1,1,.5),padding:e.spacing(0,1)})),E=r.forwardRef(function(e,t){var a,l;let{componentsProps:s={}}=e,b=(0,n.Z)(e,v),E=s.button||{},T=(0,h.l)(),C=(0,g.B)(),S=(0,u.P)(T,m.DY),j=(0,u.P)(T,c.WH),Z=(0,u.P)(T,p.e),L=w(C),_=r.useMemo(()=>{if(Z.open)return T.current.getLocaleText("toolbarFiltersTooltipHide");if(0===S.length)return T.current.getLocaleText("toolbarFiltersTooltipShow");let e=e=>j[e.columnField].filterOperators.find(t=>t.value===e.operatorValue).label||T.current.getLocaleText(`filterOperator${(0,d.Z)(e.operatorValue)}`).toString(),t=e=>{let{getValueAsString:t}=j[e.columnField].filterOperators.find(t=>t.value===e.operatorValue);return t?t(e.value):e.value};return(0,x.jsxs)("div",{children:[T.current.getLocaleText("toolbarFiltersTooltipActive")(S.length),(0,x.jsx)(y,{className:L.root,ownerState:C,children:S.map((a,n)=>(0,i.Z)({},j[a.columnField]&&(0,x.jsx)("li",{children:`${j[a.columnField].headerName||a.columnField}
                  ${e(a)}
                  ${a.value?t(a):""}`},n)))})]})},[T,C,Z.open,S,j,L]);return C.disableColumnFilter?null:(0,x.jsx)(C.components.BaseTooltip,(0,i.Z)({title:_,enterDelay:1e3},b,null==(a=C.componentsProps)?void 0:a.baseTooltip,{children:(0,x.jsx)(C.components.BaseButton,(0,i.Z)({ref:t,size:"small","aria-label":T.current.getLocaleText("toolbarFiltersLabel"),startIcon:(0,x.jsx)(o.Z,{badgeContent:S.length,color:"primary",children:(0,x.jsx)(C.components.OpenFilterButtonIcon,{})})},E,{onClick:e=>{var t;let{open:a,openedPanelValue:i}=Z;a&&i===f.y.filters?T.current.hideFilterPanel():T.current.showFilterPanel(),null==(t=E.onClick)||t.call(E,e)}},null==(l=C.componentsProps)?void 0:l.baseButton,{children:T.current.getLocaleText("toolbarFilters")}))}))})},6241:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/superadmin/users",function(){return a(24372)}])},17553:function(e,t,a){"use strict";var i=a(85893),n=a(67294),r=a(45697),l=a.n(r),s=a(70760),o=a(44723);let d=n.forwardRef(function(e,t){return(0,i.jsx)(o.Z,{elevation:6,ref:t,variant:"filled",...e})});function c(e){let{openSnackbar:t,message:a,severity:r="info",closeHandlerCB:l=()=>{}}=e,[o,c]=(0,n.useState)(t);(0,n.useEffect)(()=>{c(t)},[t]);let u=()=>{c(!1),l()},m=function(e){if(null==e)return"";if("string"==typeof e)return e;if(e instanceof Error)return e.message||e.toString();if("object"==typeof e&&"string"==typeof e.message)return e.message;try{return JSON.stringify(e)}catch(t){return String(e)}}(a);return(0,i.jsx)(s.Z,{open:o,autoHideDuration:3e3,onClose:u,children:(0,i.jsx)(d,{onClose:u,severity:r,sx:{width:"100%"},children:m})})}c.propTypes={openSnackbar:l().bool,message:l().any,severity:l().string,closeHandlerCB:l().func},t.Z=c},2782:function(e,t,a){"use strict";var i=a(64836);t.Z=void 0;var n=i(a(33651)),r=a(85893);t.Z=(0,n.default)([(0,r.jsx)("path",{d:"M21 19.1H3V5h18zM21 3H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"},"0"),(0,r.jsx)("path",{d:"M14.59 8 12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41z"},"1")],"CancelPresentation")},91194:function(e,t,a){"use strict";a(67294);var i=a(13077),n=a(85893);t.Z=(0,i.Z)((0,n.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft")},59367:function(e,t,a){"use strict";a(67294);var i=a(13077),n=a(85893);t.Z=(0,i.Z)((0,n.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight")},24372:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return q}});var i=a(85893),n=a(45697),r=a.n(n),l=a(67294),s=a(98813),o=a(94459);class d{isValidEmail(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return/^[a-z.A-Z.0-9]+@[a-zA-Z0-9]+\.[A-Za-z]+$/.test(e)&&""!==e}isValidName(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return/[a-zA-Z0-9. ]+$/.test(e.trim())&&""!==e}isValidPassword(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.length>0}}let c=new d,u=c.isValidEmail.bind(c),m=c.isValidName.bind(c),p=c.isValidPassword.bind(c);var f=a(65328),h=a(45773),g=a(60990),b=a(96788),x=a(16729),v=a(17553),w=a(42176),y=a(6132),E=a(50853),T=a(64740),C=a(65806),S=a(94143),j=a(15972),Z=a(29346),L=a(13539),_=a(26541),I={width:"parent",display:"flex",flexDirection:"column","& .MuiTextField-root, button":{marginTop:e=>e.spacing(2)}},R={fontSize:"12px",marginTop:e=>e.spacing(3),marginBottom:"4px"},U={marginBottom:e=>e.spacing(2)};function P(e){let{state:t,loadstatus:a,onTextChange:n,type:r="create",inputValidation:l,handleInputClick:s}=e;return(0,i.jsxs)(g.Z,{component:"form",noValidate:!0,autoComplete:"off",sx:I,children:["create"!==r&&(0,i.jsx)(_.Z,{id:"uid",label:"Enter UID",variant:"standard",size:"small",disabled:!0,value:t.uid}),(0,i.jsx)(_.Z,{id:"email",label:"Enter email",variant:"standard",size:"small",error:""!==l.email,helperText:""!==l.email?l.email:"",disabled:a.isLoading,value:t.email,onChange:n,onClick:s}),(0,i.jsx)(_.Z,{id:"displayname",label:"Enter display name",variant:"standard",size:"small",error:""!==l.displayname,helperText:""!==l.displayname?l.displayname:"",disabled:a.isLoading,value:t.displayname,onChange:n,onClick:s}),(0,i.jsx)(_.Z,{id:"password",label:"Enter password",type:"password",placeholder:"create"===t.mode?"Enter password":"Password will not be updated if left blank",variant:"standard",size:"small",error:""!==l.password&&"create"===r,helperText:""!==l.password&&"create"===r?l.password:"",disabled:a.isLoading,value:t.password,onChange:n,onClick:s}),(0,i.jsx)(S.Z,{sx:R,id:"accountlevel-label",children:"Account Type"}),(0,i.jsxs)(Z.Z,{labelId:"accountlevel-label",id:"account_level",size:"small",sx:U,disabled:a.isLoading,value:t.account_level,onChange:n,children:[(0,i.jsx)(j.Z,{value:1,size:"small",children:"Superadmin"}),(0,i.jsx)(j.Z,{value:2,size:"small",children:"Admin"})]}),(0,i.jsx)(C.Z,{control:(0,i.jsx)(L.Z,{checked:t.disabled,disabled:a.isLoading,id:"disabled",name:"disabled",onChange:n}),label:"Account Disabled"}),(0,i.jsx)(C.Z,{control:(0,i.jsx)(L.Z,{checked:t.emailverified,disabled:a.isLoading,id:"emailverified",name:"emailverified",onChange:n}),label:"Email Verified"})]})}P.propTypes={state:r().object,loadstatus:r().object,onTextChange:r().func,type:r().string,inputValidation:r().object,handleInputClick:r().func};var k={width:"parent",display:"flex",justifyContent:"space-between",fontSize:"14px",alignItems:"center",padding:"12px",borderBottom:"1px solid #f0f0f0","& div:first-child":{color:"#a0a0a0"},"& div:last-child":{color:"#000"}};let A={email:"Email",displayName:"Display Name",acclevel:"Acc. Type",emailVerified:"Email Verified",disabled:"Acc. Disabled",last_signin:"Last Signin"};function D(e){let{userinfo:t}=e;return(0,i.jsx)(g.Z,{children:Object.keys(A).map(e=>(0,i.jsxs)(g.Z,{sx:k,children:[(0,i.jsx)("div",{children:A[e]}),(0,i.jsx)("div",{children:t[e].toString()})]},e))})}D.propTypes={userinfo:r().object};var B={marginTop:"24px",minHeight:500},V={background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"8px","& .MuiDataGrid-main":{borderRadius:2},"& .MuiDataGrid-virtualScrollerRenderZone":{"& .MuiDataGrid-row":{"&:nth-of-type(2n)":{backgroundColor:"rgba(235, 235, 235, .7)"}}},"& .MuiDataGrid-columnHeader:focus-within":{outline:"none !important"},"& .MuiDataGrid-columnHeaders":{color:e=>e.palette.primary.dark,fontSize:16}};function N(e){return(0,i.jsxs)(w.D,{...e,children:[(0,i.jsx)(y.S,{}),(0,i.jsx)(E.M,{})]})}let F={CREATE:0,VIEW:1,EDIT:2,DELETE:3},z={[F.CREATE]:{windowTitle:"Create a New User",buttonText:"Create User",yesBtnText:"Save"},[F.VIEW]:{windowTitle:"User Information",buttonText:"View",yesBtnText:"Edit"},[F.EDIT]:{windowTitle:"Update User Information",buttonText:"Edit",yesBtnText:"Update"},[F.DELETE]:{windowTitle:"User Information",buttonText:"Delete",yesBtnText:"Delete"}};function M(e){let{state:t,loadstatus:a,loadingusers:n,rows:r,columns:s,onTextChange:o,onEditStart:d,handleCreateUser:c,handleDeleteUser:u,handleUpdateUser:m,handleInputClick:p,inputValidation:f,usersLoadingError:h}=e,[w,y]=(0,l.useState)({}),[E,C]=(0,l.useState)(!1),[S,j]=(0,l.useState)(F.CREATE);return(0,i.jsxs)("div",{children:[(0,i.jsx)(b.Z,{variant:"h5",children:"Users Management"}),(0,i.jsx)("p",{children:"Manage admin user accounts"}),(0,i.jsx)("br",{}),(0,i.jsx)(x.Z,{isOpen:a.dialogOpen&&[F.CREATE,F.DELETE].includes(S)||E&&[F.VIEW,F.EDIT].includes(S),maxWidth:"xs",openButtonText:"Create User",title:z[S].windowTitle,confirmBtnText:z[S].yesBtnText,extraBtnText:S===F.VIEW?z[F.DELETE].buttonText:"",loading:a.isLoading,colorTheme:"secondary",modalConfirmHandlerCB:()=>{switch(S){case F.CREATE:c();break;case F.VIEW:j(F.EDIT);break;case F.EDIT:m(),j(F.CREATE)}},modalCancelHandlerCB:()=>{p(),C(!1)},modalOpenHandlerCB:()=>{j(F.CREATE),C(!0)},modalExtraHandlerCB:()=>{j(F.DELETE),u(w.uid,w.email)},children:S===F.CREATE||S===F.EDIT?(0,i.jsx)(P,{state:t,loadstatus:a,onTextChange:o,inputValidation:f,handleInputClick:p,type:"create"}):(0,i.jsx)(D,{userinfo:w})}),(0,i.jsx)(g.Z,{sx:B,style:{height:r.length<=4?"500px":"unset"},children:(0,i.jsx)(T._,{rows:r,columns:s,sx:V,rowHeight:48,autoHeight:r.length>=5,disableDensitySelector:!0,rowsPerPageOptions:[15,30,100],error:""!==h?h:null,components:{Toolbar:N},loading:n,initialState:{columns:{columnVisibilityModel:{rowId:!1}},pagination:{pageSize:12}},onRowClick:e=>{let t={...e.row};t.account_level="Admin"===t.acclevel?2:1,t.displayname=t.displayName,t.emailverified=t.emailVerified,d(t.uid,"edit"),y(t),j(F.VIEW),C(!0)}})}),(""!==a.error||""!==a.message)&&(0,i.jsx)(v.Z,{openSnackbar:!0,message:""!==a.error?a.error:a.message,severity:""!==a.error?"error":"success"})]})}M.propTypes={state:r().object,loadstatus:r().object,onTextChange:r().func,onEditStart:r().func,handleCreateUser:r().func,handleDeleteUser:r().func,handleUpdateUser:r().func,handleInputClick:r().func,inputValidation:r().object,usersLoadingError:r().string};let O={email:"",displayname:"",password:"",account_level:2,disabled:!1,emailverified:!0,mode:"create"},H={isLoading:!1,dialogOpen:!1,error:"",message:""},W={email:"",displayname:"",password:"",account_level:"",disabled:"",emailverified:""};function G(e){let[t,a]=(0,l.useState)(O),[n,r]=(0,l.useState)(H),[d,c]=(0,l.useState)(W),[f,g]=(0,l.useState)([]),{users:b,loading:x,error:v}=function(){let[e,t]=(0,l.useState)(null),[a,i]=(0,l.useState)(!0),[n,r]=(0,l.useState)("");return(0,l.useEffect)(()=>{(async()=>{try{let e=await (0,o.Rf)();i(!1),t(e.data)}catch(t){let e="";void 0!==t.response&&(e=void 0!==t.response.data?t.response.data:""),""===e&&(e=t.message),r(e)}})()},[]),{users:e,loading:a,error:n}}(),[w,y]=(0,l.useState)([]),[E,T]=(0,l.useState)([]);(0,l.useEffect)(()=>{null!==b&&g(e=>b.users)},[b]),(0,l.useEffect)(()=>{if(f.length>0){let e={email:{label:"Email",width:280},displayName:{label:"Display Name",width:200},acclevel:{label:"Acc. Type",width:120},emailVerified:{label:"Email Verified",width:125},disabled:{label:"Acc. Disabled",width:120},last_signin:{label:"Last Signin",width:250}},t=["email","displayName","acclevel","emailVerified","disabled","last_signin"].reduce((t,a,n)=>(t.push({field:a,headerName:e[a].label,width:e[a].width,align:n>1?"center":"left",headerAlign:n>1?"center":"left",editable:!1,sortable:!1,disableColumnMenu:!0,renderCell:e=>(0,i.jsx)("div",{style:{fontSize:"last_signin"===a?"13px":"14px"},children:e.value.toString()})}),t),[]);y(f.filter(e=>void 0!==e.customClaims).map((e,t)=>({id:t,uid:e.uid,email:e.email,displayName:e.displayName,acclevel:1===e.customClaims.account_level?"Superadmin":"Admin",emailVerified:e.emailVerified,disabled:e.disabled,date_created:e.metadata.creationTime,last_signin:e.metadata.lastSignInTime?e.metadata.lastSignInTime:"-"}))),T(t)}},[f]);let C=e=>{let t=Object.keys(O).reduce((t,a)=>(t[a]=e[a],t),{});if(null!==t)return t.uid=e.uid,t.account_level=e.customClaims.account_level,t.displayname=e.displayName,t.emailverified=e.emailVerified,t.password="",t},S=()=>{r({...H,dialogOpen:!0,isLoading:!0})},j=e=>{let{message:t="",error:i=""}=e;r(e=>({...H,message:t,error:i})),a(e=>({...O}))},Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"create",a=0,i={};return u(t.email)||(i.email="Please check your email input.",a+=1),m(t.displayname)||(i.displayname="Please check your display name.",a+=1),"create"!==e||p(t.password)||(i.password="Please check your password input.",a+=1),c({...d,...i}),0===a},L=async()=>{if(Z("create"))try{S(),await (0,o.r4)(t);let{data:e}=await (0,o.Rf)();g(e.users),j({message:"User successfully ".concat(t.email," created!")})}catch(e){j({error:e.response?e.response.data:e.message})}},_=async(e,t)=>{try{S(),await (0,o.h8)(e);let{data:a}=await (0,o.Rf)();g(a.users),j({message:"Successfully deleted user ".concat(t,"!")})}catch(e){j({error:e.response?e.response.data:e.message})}},I=async()=>{if(Z("edit"))try{S(),await (0,o.Nq)(t);let e=await (0,o.PR)({uid:t.uid,email:t.email}),a=f.findIndex(t=>t.uid===e.uid);if(a>=0){let t=[...f];t[a]=e,g(t)}j({message:"Successfully updated ".concat(t.email,"'s details!")})}catch(e){j({error:e.response?e.response.data:e.message})}};return(0,i.jsx)(h.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,accLevel:s.DW.SUPERADMIN,children:(0,i.jsx)(M,{state:t,loadstatus:n,loadingusers:x,rows:w,columns:E,onTextChange:e=>{let{id:i,value:l,checked:s}=e.target,o=void 0!==i?i:"account_level";["emailverified","disabled"].includes(o)&&(l=s),a({...t,[o]:l}),(""!==n.error||""!==n.message||Object.keys(d).filter(e=>""!==d[e]).length>0)&&(r(H),c(W))},onEditStart:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"create",i=C(f.find(t=>t.uid===e));a(i={...i,mode:t})},handleCreateUser:L,handleDeleteUser:_,handleUpdateUser:I,handleInputClick:e=>{if(e){let{id:i}=e.target;a({...t,[i]:""})}else a(O),r(H);c(W)},inputValidation:d,usersLoadingError:v})})}G.propTypes={loading:r().bool,user:r().object,onBtnLogoutClick:r().func,accLevel:r().number};var q=(0,f.Z)(G)},94459:function(e,t,a){"use strict";a.d(t,{r4:function(){return o},h8:function(){return c},PR:function(){return u},Rf:function(){return m},Nq:function(){return d}});var i=a(9669),n=a.n(i),r=a(15426);class l extends r.Z{async createUser(e){let t={};["email","displayname","password","account_level","disabled","emailverified"].forEach(a=>{if(void 0!==e[a]&&""!==e[a])t[a]=e[a];else throw Error("Please check your input.")});let a=await this.createRequestObject({body:t});return(await n()({...a,url:this.USERS_API,method:"POST"})).data}async updateUser(e){let t={};["uid","email","displayname","password","disabled","emailverified","account_level"].forEach(a=>{if(void 0===e[a.toLowerCase()]||"password"===a||""!==e[a])t[a]=e[a];else throw Error("Please check your input.")});let a=await this.createRequestObject({body:t});return(await n()({...a,url:this.USERS_API,method:"PATCH"})).data}async deleteUser(e){let t=await this.createRequestObject({});return(await n().delete("".concat(this.USERS_API,"/").concat(e),t)).data}async getUser(e){let{uid:t,email:a}=e,i={};t&&(i={uid:t}),a&&(i={email:a});let r=await this.createRequestObject({params:i});return(await n().get("".concat(this.BASE_URL,"/user"),r)).data}constructor(){super(),this.getUsers=async()=>await n().get(this.USERS_API_LIST),this.BASE_URL="https://acap-mimaropa-server.onrender.com/api",this.USERS_API="".concat(this.BASE_URL,"/user"),this.USERS_API_LIST="".concat(this.BASE_URL,"/users")}}let s=new l,o=s.createUser.bind(s),d=s.updateUser.bind(s),c=s.deleteUser.bind(s),u=s.getUser.bind(s),m=s.getUsers.bind(s)}},function(e){e.O(0,[3153,7023,3745,1664,6541,955,7958,4073,4959,5837,6080,4723,760,20,4740,4588,2888,9774,179],function(){return e(e.s=6241)}),_N_E=e.O()}]);