(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3807],{27033:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/cropping-calendars",function(){return n(68956)}])},32209:function(e,t,n){"use strict";var a=n(85893),r=n(96788);let s=(0,n(77527).ZP)(e=>(0,a.jsx)(r.Z,{component:"p",variant:"caption",...e}))(e=>{let{theme:t}=e;return{color:t.palette.text.secondary,"& a":{color:t.palette.green.dark,textDecoration:"none"},"& a:visited":{color:t.palette.green.dark},"& a:hover, span:hover":{textDecoration:"underline"}}});t.Z=s},9883:function(e,t,n){"use strict";var a=n(85893),r=n(51015);let s=(0,n(77527).ZP)(e=>(0,a.jsx)(r.Z,{...e}))(e=>{let{theme:t}=e;return{width:"150px",height:t.spacing(5)}});t.Z=s},20481:function(e,t,n){"use strict";var a=n(85893),r=n(26541);let s=(0,n(77527).ZP)(e=>(0,a.jsx)(r.Z,{...e}))(e=>{let{theme:t}=e;return{width:"100%",fontSize:"12px",marginTop:t.spacing(1),"& .MuiOutlinedInput-root":{paddingRight:0,paddingLeft:0},"& .MuiOutlinedInput-input":{padding:t.spacing(1)}}});t.Z=s},22233:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z}});var a=n(85893),r=n(67294),s=n(45697),i=n.n(s),l=n(20481),o=n(60990),c=n(68573),d=n(96788),p=n(16729),u=n(17553),f=n(75415),g=n(41653),x=n(9883),m={container:{marginTop:"16px",width:"100%"},textfield:{fontSize:"14px"},fileInputContainer:{height:"0px",width:"0px",overflow:"hidden"}},h=n(32209);function v(e){let{file:t,state:n,name:s,label:i="",textContent:v="",fileAccepts:j,isDisabled:b=!1,handleUpload:y,onUploadClick:Z,handleResetMessage:C,setSelectedFile:w,clearFile:S}=e,_=(0,r.useRef)();return(0,r.useEffect)(()=>{null===t&&(_.current.value=null)},[t]),(0,a.jsxs)(c.ZP,{container:!0,sx:m.container,children:[n.open&&(0,a.jsx)(p.Z,{isOpen:!0,title:"Upload file",contentText:n.modalMsg,loading:n.loading,openButtonText:null,modalCancelHandlerCB:C,modalConfirmHandlerCB:y}),""!==n.msg&&(0,a.jsx)(u.Z,{openSnackbar:!0,message:n.msg,severity:n.type,closeHandlerCB:C}),(0,a.jsxs)(c.ZP,{item:!0,xs:12,lg:6,sx:m.wrapper,children:[(0,a.jsx)(d.Z,{variant:"subtitle2",children:i}),(0,a.jsx)(h.Z,{children:v}),(0,a.jsx)(l.Z,{size:"small",disabled:!0,value:null!==t?t[0].name:"",sx:{fontSize:"10px"},InputProps:{style:m.textfield,startAdornment:(0,a.jsxs)(x.Z,{variant:"outlined",disableElevation:!0,component:"label",disabled:n.loading||b,sx:{width:"48px",borderTopRightRadius:0,borderBottomRightRadius:0},onClick:e=>{null!==t&&S(e)},children:[null===t?(0,a.jsx)(g.Z,{}):(0,a.jsx)(f.Z,{}),(0,a.jsx)(o.Z,{sx:m.fileInputContainer,children:(0,a.jsx)("input",{type:"file",multiple:!0,ref:_,accept:j||".xlsx, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",name:s||"excelfile",onChange:w,style:{border:"1px solid"}})})]}),endAdornment:(0,a.jsx)(x.Z,{size:"small",component:"span",variant:"contained",disableElevation:!0,disabled:null===t||n.loading,sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:Z,children:"Upload"})}})]})]})}v.propTypes={file:i().object,state:i().object,name:i().string,label:i().string,textContent:i().string,fileAccepts:i().string,isDisabled:i().bool,handleUpload:i().func,onUploadClick:i().func,handleResetMessage:i().func,setSelectedFile:i().func,clearFile:i().func};let j={success:"success",error:"error"},b={msg:"",type:"",modalMsg:"Upload selected file?",loading:!1,open:!1};function y(e){let{label:t,name:n="somefile",textContent:s,fileAccepts:i,isDisabled:l=!1,fileUploadMethod:o,onFileSelectedCB:c}=e,[d,p]=(0,r.useState)(null),[u,f]=(0,r.useState)(b),g=async e=>{if(!d||0===d.length){e.preventDefault(),f(()=>({...b,msg:"Please select a file before uploading.",type:j.error}));return}e.preventDefault();try{let e=new FormData;e.append(n,d[0]),f(e=>({...e,loading:!0,modalMsg:"Uploading file..."})),await o(e),f(()=>({...b,msg:"Upload success.",type:j.success})),p(null)}catch(t){let e=function(e){if(!e)return"";if("string"==typeof e)return e;if(e.response&&e.response.data){let t=e.response.data;if("string"==typeof t)return t;if("object"==typeof t){if("string"==typeof t.message)return t.message;try{return JSON.stringify(t)}catch(e){return String(t)}}}if(e.message&&"string"==typeof e.message)return e.message;try{return JSON.stringify(e)}catch(t){return String(e)}}(t);f(()=>({...b,msg:e,type:j.error}))}};return(0,a.jsx)(v,{file:d,state:u,label:t,name:n,textContent:s,fileAccepts:i,isDisabled:l,handleUpload:g,onUploadClick:()=>f(e=>({...e,open:!0})),handleResetMessage:()=>f(b),setSelectedFile:e=>{let t=e.target.files||null;p(t),c&&c(t),f(e=>({...e,msg:"",type:"",modalMsg:"Upload selected file?"}))},clearFile:e=>{e.preventDefault(),p(null),f(b),c&&c(null)}})}y.propTypes={name:i().string,label:i().string,textContent:i().string,fileAccepts:i().string,isDisabled:i().bool,fileUploadMethod:i().func,onFileSelectedCB:i().func};var Z=y},17553:function(e,t,n){"use strict";var a=n(85893),r=n(67294),s=n(45697),i=n.n(s),l=n(70760),o=n(44723);let c=r.forwardRef(function(e,t){return(0,a.jsx)(o.Z,{elevation:6,ref:t,variant:"filled",...e})});function d(e){let{openSnackbar:t,message:n,severity:s="info",closeHandlerCB:i=()=>{}}=e,[o,d]=(0,r.useState)(t);(0,r.useEffect)(()=>{d(t)},[t]);let p=()=>{d(!1),i()},u=function(e){if(null==e)return"";if("string"==typeof e)return e;if(e instanceof Error)return e.message||e.toString();if("object"==typeof e&&"string"==typeof e.message)return e.message;try{return JSON.stringify(e)}catch(t){return String(e)}}(n);return(0,a.jsx)(l.Z,{open:o,autoHideDuration:3e3,onClose:p,children:(0,a.jsx)(c,{onClose:p,severity:s,sx:{width:"100%"},children:u})})}d.propTypes={openSnackbar:i().bool,message:i().any,severity:i().string,closeHandlerCB:i().func},t.Z=d},68956:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var a=n(85893),r=n(65328),s=n(45773),i=n(67294),l=n(9473),o=n(96788),c=n(68573),d=n(60990),p=n(94143),u=n(15972),f=n(6897),g=n(29346),x=n(9669),m=n.n(x),h=n(15426);class v extends h.Z{async upsertCroppingCalendar(e,t){let n=await this.createRequestObject({body:e});return(await m()({...n,url:"".concat("https://acap-mimaropa-server.onrender.com/api","/uploadCroppingCalendar/").concat(t),method:"POST"})).data}}let j=new v,b=j.upsertCroppingCalendar.bind(j);var y=n(25517),Z=n(22233),C=n(9704),w={marginBottom:e=>e.spacing(3),maxWidth:"800px",color:"gray","& a":{textDecoration:"none",color:e=>e.palette.green.dark},"& a:hover":{textDecoration:"underline"},"& a:visited":{color:e=>e.palette.green.dark}},S=function(){let[e,t]=(0,i.useState)([]),[n,r]=(0,i.useState)(""),{cropList:s}=(0,C.Z)(),x=(0,l.v9)(e=>e.seasonalweather.status),m=()=>{t(e.map(e=>({...e,isValid:!1,value:""})))},h=async e=>new Promise(async(t,a)=>{try{await b(e,n),t(!0)}catch(e){a(e)}});return(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Z,{variant:"h5",children:"Cropping Calendar Management"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Manage cropping calendars"})," by uploading Excel-formatted templates."]}),(0,a.jsxs)("p",{children:["Before uploading cropping calendars with data,"," ",(0,a.jsx)("strong",{children:"first download the template"})," of the respective crop you will add into the system."]}),(0,a.jsx)("br",{}),(0,a.jsxs)(c.ZP,{container:!0,spacing:2,children:[(0,a.jsxs)(c.ZP,{item:!0,xs:12,md:6,children:[(0,a.jsx)(o.Z,{variant:"h6",children:"List of Crop Types and their Templates"}),(0,a.jsx)("br",{}),(0,a.jsxs)(o.Z,{variant:"body2",sx:w,children:[(0,a.jsx)("a",{href:"https://firebasestorage.googleapis.com/v0/b/acap-mimaropa-dev.appspot.com/o/files%2Ftemplates%2F%5Bpassed%5D%20rice_cropping_calendar_MIMA2.1.xlsx?alt=media&token=0a4750d5-fc0d-4b0d-af47-fc6e1fc92197",target:"__blank",children:"[Rice Cropping Calendar Excel template]"}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),(0,a.jsx)("a",{href:"https://firebasestorage.googleapis.com/v0/b/acap-mimaropa-dev.appspot.com/o/files%2Ftemplates%2F%5Bpassed%5D%20corn_cropping_calendar_MIMA2.1_09162024%20(1).xlsx?alt=media&token=3e6f2229-7363-4265-bc44-664512d4fe92",target:"__blank",children:"[Corn Cropping Calendar Excel template]"})]})]}),(0,a.jsxs)(c.ZP,{item:!0,xs:12,md:6,children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"Upload Cropping Calendar"})}),(0,a.jsx)(d.Z,{sx:{minWidth:120},children:(0,a.jsxs)(f.Z,{fullWidth:!0,children:[(0,a.jsx)(p.Z,{id:"demo-simple-select-label",children:"Crop Type"}),(0,a.jsx)(g.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:n,label:"Crop Type",onChange:e=>{r(e.target.value)},children:s.map(e=>(0,a.jsx)(u.Z,{value:e,children:e},e))})]})}),(0,a.jsx)("br",{}),(0,a.jsxs)(c.ZP,{item:!0,xs:12,children:[(0,a.jsx)(Z.Z,{label:"Upload an excel file",name:"excelfile",fileAccepts:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",isDisabled:x===y.G.PENDING||!n,fileUploadMethod:h,onFileSelectedCB:e=>{e||m()}}),(0,a.jsxs)(o.Z,{variant:"caption",children:["Please select ",(0,a.jsx)("strong",{children:"Crop Type"})," first before uploading a file."]})]})]})]})]})},_=n(98813),k=(0,r.Z)(function(e){let{loading:t,user:n,onBtnLogoutClick:r}=e;return(0,a.jsx)(s.Z,{loading:t,user:n,onBtnLogoutClick:r,accLevel:_.DW.ADMIN,children:(0,a.jsx)(S,{})})})},9704:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(67294),r=n(61061);function s(){let[e,t]=(0,a.useState)([]),[n,s]=(0,a.useState)(!1),[i,l]=(0,a.useState)("");return(0,a.useEffect)(()=>{(async()=>{var e,n,a;try{s(!0);let n=await (0,r.TQ)();t(null!==(e=null==n?void 0:n.list)&&void 0!==e?e:[]),s(!1),l("")}catch(e){l(null!==(a=null==e?void 0:null===(n=e.response)||void 0===n?void 0:n.data)&&void 0!==a?a:e.message),s(!1),t([])}})()},[]),{cropList:e,loading:n,error:i}}}},function(e){e.O(0,[3153,7023,3745,1664,6541,955,7958,4073,4959,6080,4723,760,609,4588,2888,9774,179],function(){return e(e.s=27033)}),_N_E=e.O()}]);