(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{18197:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/analytics",function(){return n(77126)}])},77126:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return K}});var r=n(85893),a=n(65328),i=n(45773),s=n(67294),o=n(93454),l=n(84166),c=n(96788),d=n(60990),p=n(76592),x=n(70360),h=n(46577),u=n(8863),g=n(19827),m=n(92608),b=n(735),f=n(51015),j=n(97182),v=n(44723),y=n(81873),Z=n(56912),w=n(21038),k=n(52857),C=n(41796),F=n(18745),S=n(93333),A=n(23580),B=n(65250),T=n(58127),D=n(52145),R=n(97201),E=n(95371),M=n(61120),q=n.n(M),N=n(91819);let I=[{label:"Today",value:"today"},{label:"7 Days",value:"7d"},{label:"30 Days",value:"30d"}],P={open_bulletins_page:"Open Bulletins Page",view_bulletin:"View Bulletin",download_bulletin_pdf:"Download Bulletin PDF"};function W(e){return Number(e||0).toLocaleString()}function z(e){let{title:t,value:n,subtext:a,accent:i="#1976d2",suffix:d="",variantStyles:p,icon:x}=e,h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:700,[n,r]=(0,s.useState)(0);return(0,s.useEffect)(()=>{let n,a;let i=Number(e||0);return n=requestAnimationFrame(function e(s){a||(a=s);let o=Math.min((s-a)/t,1);r(Math.round(i*o)),o<1&&(n=requestAnimationFrame(e))}),()=>{n&&cancelAnimationFrame(n)}},[e,t]),n}(n),u=!!p.kpiSolid;return(0,r.jsxs)(o.Z,{className:"print-kpi-card",sx:{...p.kpi,borderTop:u?"none":"3px solid ".concat(i),bgcolor:u?i:p.kpi.bgcolor},children:[(0,r.jsxs)(l.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:1,children:[(0,r.jsx)(c.Z,{variant:"body2",sx:{fontWeight:700,textTransform:"uppercase"},color:u?"rgba(255,255,255,0.88)":"text.secondary",children:t}),x&&(0,r.jsx)(x,{sx:{fontSize:22,color:u?"rgba(255,255,255,0.9)":i}})]}),(0,r.jsxs)(c.Z,{variant:"h5",sx:{fontWeight:700,mt:.8,color:u?"#fff":"inherit"},children:[W(h),d]}),(0,r.jsx)(c.Z,{variant:"caption",color:u?"rgba(255,255,255,0.9)":"text.secondary",children:a})]})}function L(e){let{data:t,variantStyles:n}=e,a=(0,F.Z)(),i=(0,s.useMemo)(()=>(null==t?void 0:t.length)?Math.max(...t.map(e=>e.views),100):100,[t]),o=(0,s.useMemo)(()=>(null==t?void 0:t.length)?t.map((e,n)=>{let r=26+668*n/Math.max(t.length-1,1),a=194-e.views/i*168;return"".concat(r,",").concat(a)}).join(" "):"",[t,i]);return(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Traffic Trend"}),(0,r.jsx)(d.Z,{sx:{width:"100%",overflowX:"auto"},children:(0,r.jsxs)("svg",{width:"100%",viewBox:"0 0 ".concat(720," ").concat(220),role:"img","aria-label":"Traffic trend line chart",children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"analyticsTrendArea",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,r.jsx)("stop",{offset:"0%",stopColor:(0,C.Fq)(n.chartLine,n.chartAreaOpacity)}),(0,r.jsx)("stop",{offset:"100%",stopColor:(0,C.Fq)(n.chartLine,0)})]})}),(0,r.jsx)("rect",{x:"0",y:"0",width:720,height:220,fill:"transparent"}),(0,r.jsx)("line",{x1:26,y1:194,x2:694,y2:194,stroke:n.chartAxis,strokeWidth:"1"}),(0,r.jsx)("line",{x1:26,y1:26,x2:26,y2:194,stroke:n.chartAxis,strokeWidth:"1"}),n.chartAreaOpacity>0&&o&&(0,r.jsx)("polygon",{fill:"url(#analyticsTrendArea)",points:"".concat(26,",").concat(194," ").concat(o," ").concat(694,",").concat(194)}),(0,r.jsx)("polyline",{fill:"none",stroke:n.chartLine||a.palette.primary.main,strokeWidth:"3",points:o,style:{transition:"all 0.5s ease"}})]})}),(0,r.jsx)(c.Z,{variant:"caption",color:"text.secondary",children:"Daily views for selected range"})]})}function U(e,t,n,r,a){let i=r*Math.PI/180,s=a*Math.PI/180,o=e+n*Math.cos(i),l=t+n*Math.sin(i),c=e+n*Math.cos(s),d=t+n*Math.sin(s);return"M ".concat(o," ").concat(l," A ").concat(n," ").concat(n," 0 ").concat(a-r<=180?0:1," 1 ").concat(c," ").concat(d)}function _(e){let{data:t,totalSessions:n,variantStyles:a}=e,i=["#00838F","#0C9BA8","#2DB4BE","#4FC2CA","#73CAD0","#97D7DC"],s=-90,o=(t||[]).map((e,t)=>{let r=Number(e.sessions||0),a=n>0?r/n*360:0,o={...e,color:i[t%i.length],percent:n>0?r/n*100:0,startAngle:s,endAngle:s+a};return s+=a,o});return(0,r.jsxs)(l.Z,{spacing:1.2,alignItems:"center",children:[(0,r.jsxs)(d.Z,{sx:{position:"relative",width:180,height:180},children:[(0,r.jsxs)("svg",{width:180,height:180,viewBox:"0 0 ".concat(180," ").concat(180),role:"img","aria-label":"Traffic sources donut chart",children:[(0,r.jsx)("circle",{cx:90,cy:90,r:81,stroke:a.barTrack,strokeWidth:18,fill:"none"}),o.map(e=>(0,r.jsx)("path",{d:U(90,90,81,e.startAngle,e.endAngle),stroke:e.color,strokeWidth:18,fill:"none",strokeLinecap:"butt"},"".concat(e.source,"-arc")))]}),(0,r.jsxs)(l.Z,{spacing:0,alignItems:"center",justifyContent:"center",sx:{position:"absolute",inset:0,pointerEvents:"none"},children:[(0,r.jsx)(c.Z,{variant:"h6",sx:{fontWeight:700,lineHeight:1},children:W(n)}),(0,r.jsx)(c.Z,{variant:"caption",color:"text.secondary",children:"Sessions"})]})]}),(0,r.jsx)(l.Z,{spacing:.4,sx:{width:"100%"},children:o.map(e=>(0,r.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,r.jsxs)(l.Z,{direction:"row",spacing:.8,alignItems:"center",children:[(0,r.jsx)(d.Z,{sx:{width:10,height:10,borderRadius:"2px",bgcolor:e.color}}),(0,r.jsx)(c.Z,{variant:"caption",children:e.source})]}),(0,r.jsxs)(c.Z,{variant:"caption",color:"text.secondary",children:[e.percent.toFixed(1),"%"]})]},"".concat(e.source,"-legend")))})]})}function O(e){let{steps:t,variantStyles:n}=e,a=(t||[]).reduce((e,t)=>e+Number(t.count||0),0),i=["#00838F","#1565C0","#EF6C00","#2DB4BE","#73CAD0"],s=-90,o=(t||[]).map((e,t)=>{let n=Number(e.count||0),r=a>0?n/a*360:0,o={...e,color:i[t%i.length],percent:a>0?n/a*100:0,startAngle:s,endAngle:s+r};return s+=r,o});return(0,r.jsxs)(l.Z,{spacing:1.2,alignItems:"center",children:[(0,r.jsx)(c.Z,{variant:"caption",color:"text.secondary",children:"Step Share"}),(0,r.jsxs)(d.Z,{sx:{position:"relative",width:170,height:170},children:[(0,r.jsxs)("svg",{width:170,height:170,viewBox:"0 0 ".concat(170," ").concat(170),role:"img","aria-label":"User journey step share donut chart",children:[(0,r.jsx)("circle",{cx:85,cy:85,r:77,stroke:(0,C.Fq)(n.funnelBar||"#00838F",.25),strokeWidth:16,fill:"none"}),o.map(e=>(0,r.jsx)("path",{d:U(85,85,77,e.startAngle,e.endAngle),stroke:e.color,strokeWidth:16,fill:"none",strokeLinecap:"butt"},"".concat(e.key,"-journey-arc")))]}),(0,r.jsxs)(l.Z,{spacing:0,alignItems:"center",justifyContent:"center",sx:{position:"absolute",inset:0,pointerEvents:"none"},children:[(0,r.jsx)(c.Z,{variant:"h6",sx:{fontWeight:700,lineHeight:1},children:W(a)}),(0,r.jsx)(c.Z,{variant:"caption",color:"text.secondary",children:"Events"})]})]}),(0,r.jsx)(l.Z,{spacing:.4,sx:{width:"100%"},children:o.map(e=>(0,r.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,r.jsxs)(l.Z,{direction:"row",spacing:.8,alignItems:"center",children:[(0,r.jsx)(d.Z,{sx:{width:10,height:10,borderRadius:"2px",bgcolor:e.color}}),(0,r.jsx)(c.Z,{variant:"caption",children:e.label})]}),(0,r.jsxs)(c.Z,{variant:"caption",color:"text.secondary",children:[e.percent.toFixed(1),"%"]})]},"".concat(e.key,"-journey-legend")))})]})}function H(e){let{data:t,variantStyles:n}=e,a=(0,s.useMemo)(()=>(null==t?void 0:t.length)?Math.max(...t.map(e=>e.sessions),1):1,[t]),i=(0,s.useMemo)(()=>(t||[]).reduce((e,t)=>e+Number(t.sessions||0),0),[t]);return(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Traffic Sources"}),(0,r.jsxs)(d.Z,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"180px 1fr"},gap:1.6,alignItems:"start"},children:[(0,r.jsx)(_,{data:t,totalSessions:i,variantStyles:n}),(0,r.jsx)(l.Z,{spacing:1.2,children:(t||[]).map(e=>(0,r.jsxs)(d.Z,{children:[(0,r.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",children:[(0,r.jsx)(c.Z,{variant:"body2",children:e.source}),(0,r.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:W(e.sessions)})]}),(0,r.jsx)(d.Z,{sx:{height:8,bgcolor:n.quotaTrack||n.barTrack,borderRadius:6,mt:.6,overflow:"hidden"},children:(0,r.jsx)(d.Z,{sx:{height:"100%",width:"".concat(e.sessions/a*100,"%"),bgcolor:n.quotaBar||n.sourceBar,borderRadius:6,transition:"width 0.45s ease"}})})]},e.source))})]})]})}function G(e){let{data:t,variantStyles:n}=e;return(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Most Performed Actions"}),(0,r.jsxs)(p.Z,{size:"small",children:[(0,r.jsx)(x.Z,{sx:n.tableHead,children:(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(u.Z,{children:"Action"}),(0,r.jsx)(u.Z,{align:"right",children:"Count"})]})}),(0,r.jsx)(g.Z,{children:(t||[]).map(e=>(0,r.jsxs)(h.Z,{hover:!0,sx:n.tableRow,children:[(0,r.jsx)(u.Z,{children:P[e.eventName]||e.eventName}),(0,r.jsx)(u.Z,{align:"right",children:W(e.count)})]},e.eventName))})]})]})}function Y(e){let{data:t,variantStyles:n}=e,a=(0,s.useMemo)(()=>(null==t?void 0:t.steps)||[],[t]),i=(0,s.useMemo)(()=>a.length?Math.max(...a.map(e=>e.count),1):1,[a]),o=(0,s.useMemo)(()=>a.length<2?[]:a.slice(0,-1).map((e,t)=>{let n=a[t+1],r=Number(e.count||0),i=Number(n.count||0),s=r>0?i/r*100:0;return{key:"".concat(e.key,"-").concat(n.key),dropoffPercent:Math.max(0,Number((100-s).toFixed(1))),continuedPercent:Math.max(0,Number(s.toFixed(1)))}}),[a]);return(0,r.jsxs)(d.Z,{children:[(0,r.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",sx:{mb:1},children:[(0,r.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"User Journey"}),(0,r.jsxs)(c.Z,{variant:"caption",color:"text.secondary",children:["Completion Rate: ",Number((null==t?void 0:t.conversionRate)||0).toFixed(1),"%"]})]}),(0,r.jsxs)(d.Z,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"170px 1fr"},gap:1.6,alignItems:"start"},children:[(0,r.jsx)(O,{steps:a,variantStyles:n}),(0,r.jsx)(l.Z,{spacing:1.2,children:a.map((e,t)=>(0,r.jsxs)(d.Z,{children:[(0,r.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",children:[(0,r.jsx)(c.Z,{variant:"body2",children:e.label}),(0,r.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:W(e.count)})]}),(0,r.jsx)(d.Z,{sx:{height:8,bgcolor:(0,C.Fq)(n.funnelBar||"#00838F",.2),borderRadius:6,mt:.6,overflow:"hidden"},children:(0,r.jsx)(d.Z,{sx:{height:"100%",width:"".concat(e.count/i*100,"%"),bgcolor:n.funnelBar,borderRadius:6,transition:"width 0.45s ease"}})}),o[t]&&(0,r.jsxs)(c.Z,{variant:"caption",color:"text.secondary",children:["Drop-off to next step: ",o[t].dropoffPercent,"% • Continued: ",o[t].continuedPercent,"%"]})]},e.key))})]})]})}function V(e){var t;let{label:n,item:a,variantStyles:i}=e;return(0,r.jsxs)(d.Z,{children:[(0,r.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",children:[(0,r.jsx)(c.Z,{variant:"body2",children:n}),(0,r.jsxs)(c.Z,{variant:"body2",color:"text.secondary",children:[W(a.used)," / ",W(a.limit)," (",(t=a.percent,"".concat(Number(t||0).toFixed(0),"%")),")"]})]}),(0,r.jsx)(m.Z,{variant:"determinate",value:a.percent,sx:{mt:.8,height:8,borderRadius:6,bgcolor:null==i?void 0:i.quotaTrack,"& .MuiLinearProgress-bar":{bgcolor:null==i?void 0:i.quotaBar}}})]})}function X(e){let{children:t,variantStyles:n,accent:a="#00838F",hideInPrint:i=!1,className:s=""}=e;return(0,r.jsx)(o.Z,{className:s?"print-panel ".concat(s):"print-panel",sx:{...n.panel,borderTop:"3px solid ".concat(a),"@media print":i?{display:"none !important"}:void 0},children:t})}var J=function(){var e,t,n,a,i,m,M,P;let U=(0,F.Z)(),[_,O]=(0,s.useState)("7d"),[J,Q]=(0,s.useState)(!0),[K,$]=(0,s.useState)(!1),[ee,et]=(0,s.useState)(""),[en,er]=(0,s.useState)(null),ea=(0,s.useMemo)(()=>(function(e,t){let n={page:{},panel:{p:2.2,borderRadius:2},kpi:{p:2.5,borderRadius:2},kpiSolid:!1,chartAxis:"#D5D8DC",chartLine:e.palette.primary.main,chartAreaOpacity:0,barTrack:"#EDF1F5",sourceBar:e.palette.primary.main,funnelBar:e.palette.success.main,quotaTrack:"#EDF1F5",quotaBar:e.palette.primary.main,tableHead:{},tableRow:{},alertItem:{p:1.2}};return"soft"===t?{...n,panel:{p:2.2,borderRadius:2.5,border:"1px solid ".concat((0,C.Fq)(e.palette.divider,.9)),bgcolor:(0,C.Fq)(e.palette.background.paper,.96)},kpi:{p:2.5,borderRadius:2.5,border:"1px solid ".concat((0,C.Fq)(e.palette.divider,.9))},chartAreaOpacity:.16,barTrack:(0,C.Fq)(e.palette.primary.main,.08),tableHead:{bgcolor:(0,C.Fq)(e.palette.primary.main,.05)},tableRow:{"&:nth-of-type(even)":{bgcolor:(0,C.Fq)(e.palette.primary.main,.03)}},alertItem:{p:1.2,borderRadius:2,borderColor:(0,C.Fq)(e.palette.divider,.9)}}:"modern"===t?{...n,panel:{p:2.2,borderRadius:3,border:"1px solid ".concat((0,C.Fq)(e.palette.divider,.75)),boxShadow:e.shadows[1]},kpi:{p:2.5,borderRadius:3,border:"1px solid ".concat((0,C.Fq)(e.palette.divider,.75)),transition:"transform 0.2s ease","&:hover":{transform:"translateY(-2px)"}},chartAreaOpacity:.24,barTrack:(0,C.Fq)(e.palette.text.primary,.06),sourceBar:e.palette.info.main,funnelBar:e.palette.success.main,tableHead:{bgcolor:(0,C.Fq)(e.palette.info.main,.08)},tableRow:{"&:hover":{bgcolor:(0,C.Fq)(e.palette.info.main,.05)}},alertItem:{p:1.2,borderRadius:2,borderColor:(0,C.Fq)(e.palette.divider,.75)}}:"executive"===t?{...n,page:{bgcolor:"#ECEFF1",p:1.8,borderRadius:.5},panel:{p:1.8,borderRadius:0,border:"none",boxShadow:"0 4px 12px rgba(15, 28, 45, 0.18)",bgcolor:"#FFFFFF",borderTop:"2px solid #C6CCD2"},kpi:{p:2.5,borderRadius:0,border:"none",boxShadow:"none",borderBottom:"none"},kpiSolid:!0,chartAreaOpacity:.1,chartAxis:"#BFC3CF",chartLine:"#2D3261",barTrack:"#C8CCD8",sourceBar:"#2D3261",funnelBar:"#00838F",quotaTrack:"#C8CCD8",quotaBar:"#00838F",tableHead:{bgcolor:"#EFF2F5","& .MuiTableCell-root":{fontWeight:700}},tableRow:{"&:nth-of-type(even)":{bgcolor:"#F8FAFC"}},alertItem:{p:1.2,borderRadius:0,borderColor:"#D0D7DE",boxShadow:"none"}}:n})(U,"executive"),[U]),ei=(0,s.useMemo)(()=>["#1565c0","#2e7d32","#00838f","#6a1b9a","#ef6c00"],[]),es=(0,s.useCallback)(()=>{try{window.focus(),window.print()}catch(e){console.error("Print failed:",e)}},[]),eo=(0,s.useCallback)(async()=>{if("undefined"==typeof document)return;let e=document.getElementById("admin-analytics-print-root");if(!e){et("Unable to find report content for PDF export");return}et(""),$(!0);let t=null;try{(t=e.cloneNode(!0)).id="admin-analytics-export-clone",t.style.width="1180px",t.style.maxWidth="1180px",t.style.padding="8px",t.style.background="#ffffff",t.style.position="fixed",t.style.left="-10000px",t.style.top="0",t.style.zIndex="-1",t.style.transform="none",t.style.pointerEvents="none",document.body.appendChild(t);let n=await q()(t,{scale:1.8,useCORS:!0,backgroundColor:"#ffffff",logging:!1,windowWidth:t.scrollWidth,windowHeight:t.scrollHeight,ignoreElements:e=>{var t;return(null==e?void 0:null===(t=e.classList)||void 0===t?void 0:t.contains("exclude-from-pdf"))||!1}}),r=n.toDataURL("image/png"),a=new N.kH({orientation:"portrait",unit:"mm",format:"a4",compress:!0}),i=a.internal.pageSize.getWidth(),s=a.internal.pageSize.getHeight(),o=s-12,l=n.width/n.height,c=i-12,d=c/l;d>o&&(c=(d=o)*l);let p=(i-c)/2,x=(s-d)/2;a.addImage(r,"PNG",p,x,c,d,void 0,"FAST");let h=new Date().toISOString().slice(0,10),u="analytics-report-".concat(_,"-").concat(h,".pdf"),g=a.output("blob"),m=URL.createObjectURL(g),b=document.createElement("a");b.href=m,b.download=u,document.body.appendChild(b),b.click(),b.remove(),URL.revokeObjectURL(m)}catch(e){console.error("PDF export failed:",e),et("Export PDF failed. Please try again.")}finally{t&&t.parentNode&&t.parentNode.removeChild(t),$(!1)}},[_]),el=(0,s.useCallback)(async()=>{Q(!0),et("");try{let e=await fetch("/api/admin/analytics/overview?range=".concat(_));if(!e.ok)throw Error("Failed to load dashboard metrics");let t=await e.json();er(t)}catch(e){et(e.message||"Unable to load metrics")}finally{Q(!1)}},[_]);return(0,s.useEffect)(()=>{el()},[el]),(0,s.useEffect)(()=>{let e=setInterval(()=>{el()},6e4);return()=>clearInterval(e)},[el]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.Z,{styles:{"@media print":{"@page":{size:"A4 portrait",margin:"10mm"},"body *":{visibility:"hidden"},"#admin-analytics-print-root, #admin-analytics-print-root *":{visibility:"visible"},"#admin-analytics-print-root":{position:"absolute",left:0,top:0,width:"100%",margin:0,padding:"6px",background:"#fff",transform:"scale(0.96)",transformOrigin:"top left",lineHeight:1.25},"#admin-analytics-print-root .MuiTypography-root":{fontSize:"0.82rem"},"#admin-analytics-print-root .MuiTypography-h5":{fontSize:"1.2rem"},"#admin-analytics-print-root .MuiTypography-h6":{fontSize:"1rem"},"#admin-analytics-print-root .MuiTypography-subtitle1":{fontSize:"0.92rem"},"#admin-analytics-print-root .MuiPaper-root":{boxShadow:"0 0 0 1px #D7DEE8",borderRadius:"2px"},"#admin-analytics-print-root .print-panel":{breakInside:"avoid",pageBreakInside:"avoid",background:"#F8FAFC !important",boxShadow:"0 1px 2px rgba(15, 23, 42, 0.18), 0 0 0 1px #D7DEE8 !important"},"#admin-analytics-print-root .print-kpi-card":{boxShadow:"0 1px 2px rgba(15, 23, 42, 0.16), inset 0 0 0 1px rgba(255,255,255,0.55) !important"},"#admin-analytics-print-root .print-kpi-grid":{gridTemplateColumns:"repeat(5, minmax(0, 1fr)) !important",gap:"8px !important"},"#admin-analytics-print-root .print-main-grid, #admin-analytics-print-root .print-conversion-grid, #admin-analytics-print-root .print-bottom-grid":{gridTemplateColumns:"repeat(2, minmax(0, 1fr)) !important",gap:"8px !important"},"#admin-analytics-print-root .MuiTableCell-root":{padding:"5px 8px"},"#admin-analytics-print-root .print-top-pages tbody tr:nth-of-type(n+4)":{display:"none"},"#admin-analytics-print-root .print-alert-list > *:nth-of-type(n+3)":{display:"none"}}}}),(0,r.jsxs)(l.Z,{id:"admin-analytics-print-root",spacing:2.2,"data-print-report":"admin-analytics",sx:{...ea.page,printColorAdjust:"exact",WebkitPrintColorAdjust:"exact","@media print":{bgcolor:"#fff",p:0,gap:1.2}},children:[(0,r.jsxs)(l.Z,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",spacing:1.5,children:[(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(c.Z,{variant:"h5",sx:{fontWeight:700},children:"Analytics Dashboard"}),(0,r.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:"Monitoring for views, sessions, unique users, activity, and Firebase free-tier usage"})]}),(0,r.jsxs)(l.Z,{direction:"row",spacing:1,alignItems:"center",sx:{"@media print":{display:"none"}},children:[I.map(e=>(0,r.jsx)(f.Z,{variant:_===e.value?"contained":"outlined",size:"small",onClick:()=>O(e.value),children:e.label},e.value)),(0,r.jsx)(f.Z,{variant:"outlined",size:"small",onClick:el,children:"Refresh"})]})]}),(null==en?void 0:en.generatedAt)&&(0,r.jsxs)(c.Z,{variant:"caption",color:"text.secondary",children:["Last updated: ",new Date(en.generatedAt).toLocaleString()," (",en.source," data)"]}),J&&(0,r.jsxs)(l.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(j.Z,{size:16}),(0,r.jsx)(c.Z,{variant:"body2",children:"Loading dashboard metrics..."})]}),ee&&(0,r.jsx)(v.Z,{severity:"error",children:ee}),!J&&en&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(d.Z,{className:"print-kpi-grid",sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",lg:"repeat(5, 1fr)"},gap:1.5},children:[(0,r.jsx)(z,{title:"Total Views",value:en.kpis.totalViews.value,subtext:"".concat(en.kpis.totalViews.changePercent,"% vs previous period"),accent:ei[0],icon:S.Z,variantStyles:ea}),(0,r.jsx)(z,{title:"Sessions",value:null!==(i=null===(e=en.kpis.sessions)||void 0===e?void 0:e.value)&&void 0!==i?i:0,subtext:"".concat(null!==(m=null===(t=en.kpis.sessions)||void 0===t?void 0:t.changePercent)&&void 0!==m?m:0,"% vs previous period"),accent:ei[1],icon:A.Z,variantStyles:ea}),(0,r.jsx)(z,{title:"Unique Users",value:null!==(M=null===(n=en.kpis.uniqueUsers)||void 0===n?void 0:n.value)&&void 0!==M?M:0,subtext:"".concat(null!==(P=null===(a=en.kpis.uniqueUsers)||void 0===a?void 0:a.changePercent)&&void 0!==P?P:0,"% vs previous period"),accent:ei[2],icon:B.Z,variantStyles:ea}),(0,r.jsx)(z,{title:"Active Users (Realtime)",value:en.kpis.activeUsers.value,subtext:"Estimated in the last 5 minutes",accent:"#800020",icon:T.Z,variantStyles:ea}),(0,r.jsx)(z,{title:"Storage Used",value:en.kpis.storageUsed.percent,suffix:"%",subtext:"".concat(en.kpis.storageUsed.value," GB / ").concat(en.kpis.storageUsed.limit," GB"),accent:ei[4],icon:D.Z,variantStyles:ea})]}),(0,r.jsxs)(d.Z,{className:"print-main-grid",sx:{display:"grid",gridTemplateColumns:{xs:"1fr",lg:"1.8fr 1fr"},gap:1.8},children:[(0,r.jsx)(X,{variantStyles:ea,accent:ei[0],children:(0,r.jsx)(L,{data:en.trend,variantStyles:ea})}),(0,r.jsx)(X,{variantStyles:ea,accent:ei[1],children:(0,r.jsx)(H,{data:en.trafficSources,variantStyles:ea})})]}),(0,r.jsxs)(d.Z,{className:"print-conversion-grid",sx:{display:"grid",gridTemplateColumns:{xs:"1fr",lg:"1fr 1fr"},gap:1.8},children:[(0,r.jsx)(X,{variantStyles:ea,accent:ei[2],children:(0,r.jsx)(G,{data:en.topConversions,variantStyles:ea})}),(0,r.jsx)(X,{variantStyles:ea,accent:ei[3],children:(0,r.jsx)(Y,{data:en.conversionFunnel,variantStyles:ea})})]}),(0,r.jsxs)(d.Z,{className:"print-bottom-grid",sx:{display:"grid",gridTemplateColumns:{xs:"1fr",lg:"1.25fr 1fr"},gap:1.8},children:[(0,r.jsxs)(X,{variantStyles:ea,accent:ei[0],children:[(0,r.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Top Pages"}),(0,r.jsxs)(p.Z,{size:"small",className:"print-top-pages",children:[(0,r.jsx)(x.Z,{sx:ea.tableHead,children:(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(u.Z,{children:"Path"}),(0,r.jsx)(u.Z,{align:"right",children:"Views"}),(0,r.jsx)(u.Z,{align:"right",children:"Avg Time (sec)"})]})}),(0,r.jsx)(g.Z,{children:(en.topPages||[]).map(e=>(0,r.jsxs)(h.Z,{hover:!0,sx:ea.tableRow,children:[(0,r.jsx)(u.Z,{children:e.path}),(0,r.jsx)(u.Z,{align:"right",children:W(e.views)}),(0,r.jsx)(u.Z,{align:"right",children:e.avgTimeSec})]},e.path))})]})]}),(0,r.jsxs)(X,{variantStyles:ea,accent:ei[4],children:[(0,r.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:1.5},children:"Firebase Quota Monitor"}),(0,r.jsxs)(l.Z,{spacing:1.8,children:[(0,r.jsx)(V,{label:"Firestore Reads",item:en.quota.firestoreReads,variantStyles:ea}),(0,r.jsx)(V,{label:"Firestore Writes",item:en.quota.firestoreWrites,variantStyles:ea}),(0,r.jsx)(V,{label:"Storage (GB)",item:en.quota.storageGb,variantStyles:ea}),(0,r.jsx)(V,{label:"Bandwidth (GB)",item:en.quota.bandwidthGb,variantStyles:ea})]})]})]}),(0,r.jsxs)(X,{variantStyles:ea,accent:ei[3],hideInPrint:!0,className:"exclude-from-pdf",children:[(0,r.jsxs)(l.Z,{direction:{xs:"column",md:"row"},justifyContent:"space-between",spacing:1,children:[(0,r.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Alerts (Discord + In-App)"}),(0,r.jsx)(y.Z,{label:"".concat(en.alerts.filter(e=>"ok"!==e.status).length," active"),color:"warning",size:"small"})]}),(0,r.jsx)(Z.Z,{sx:{my:1.4}}),(0,r.jsx)(l.Z,{spacing:1.2,className:"print-alert-list",children:(en.alerts||[]).map(e=>{var t,n;return(0,r.jsx)(o.Z,{variant:"outlined",sx:ea.alertItem,children:(0,r.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(c.Z,{variant:"body2",sx:{fontWeight:600},children:e.metric}),(0,r.jsxs)(c.Z,{variant:"caption",color:"text.secondary",children:["Threshold: ",e.thresholdPercent,"% • Current: ",e.currentPercent,"%"]})]}),(0,r.jsxs)(l.Z,{direction:"row",spacing:.8,children:[(0,r.jsx)(y.Z,{label:e.status,color:"critical"===(n=e.status)?"error":"warning"===n?"warning":"success",size:"small"}),null===(t=e.channel)||void 0===t?void 0:t.map(t=>(0,r.jsx)(y.Z,{label:t,size:"small",variant:"outlined"},"".concat(e.id,"-").concat(t)))]})]})},e.id)})})]})]})]}),(0,r.jsxs)(l.Z,{sx:{position:"fixed",right:20,bottom:24,zIndex:1300,gap:1,"@media print":{display:"none"}},children:[(0,r.jsx)(w.Z,{title:"Export PDF",children:(0,r.jsx)(k.Z,{onClick:eo,"aria-label":"Export PDF",disabled:K,sx:{width:46,height:46,position:"relative",bgcolor:"#0A9CAA",background:"linear-gradient(145deg, #1ABFCC 0%, #0EA7B4 52%, #098A95 100%)",color:"#fff",border:"1px solid rgba(4, 93, 101, 0.72)",boxShadow:"-5px -5px 10px rgba(255,255,255,0.22), 8px 10px 16px rgba(7, 74, 82, 0.36), inset 0 1px 0 rgba(255,255,255,0.28), inset 0 -1px 0 rgba(6, 76, 84, 0.5)",transform:"translateY(0)",transition:"transform 0.18s ease, box-shadow 0.18s ease, background 0.2s ease","&::before":{content:'""',position:"absolute",inset:4,borderRadius:"50%",background:"radial-gradient(circle at 30% 28%, rgba(255,255,255,0.38), rgba(255,255,255,0) 60%)",pointerEvents:"none"},"&:hover":{background:"linear-gradient(145deg, #27C9D4 0%, #12B2BE 52%, #0B96A1 100%)",transform:"translateY(-1px)",boxShadow:"-6px -6px 11px rgba(255,255,255,0.24), 10px 12px 18px rgba(7, 74, 82, 0.38), inset 0 1px 0 rgba(255,255,255,0.3), inset 0 -1px 0 rgba(6, 76, 84, 0.45)"},"&:active":{transform:"translateY(1px) scale(0.98)",boxShadow:"-2px -2px 6px rgba(255,255,255,0.18), 4px 5px 10px rgba(7, 74, 82, 0.28), inset 0 2px 4px rgba(5, 90, 98, 0.35)"}},children:K?(0,r.jsx)(j.Z,{size:16,sx:{color:"#fff"}}):(0,r.jsx)(E.Z,{fontSize:"small"})})}),(0,r.jsx)(w.Z,{title:"Print Report",children:(0,r.jsx)(k.Z,{onClick:es,"aria-label":"Print Report",sx:{width:46,height:46,position:"relative",bgcolor:"#0A9CAA",background:"linear-gradient(145deg, #0FB1BF 0%, #0A9CAA 52%, #07808B 100%)",color:"#fff",border:"1px solid rgba(4, 93, 101, 0.72)",boxShadow:"-5px -5px 10px rgba(255,255,255,0.22), 8px 10px 16px rgba(7, 74, 82, 0.36), inset 0 1px 0 rgba(255,255,255,0.28), inset 0 -1px 0 rgba(6, 76, 84, 0.5)",transform:"translateY(0)",transition:"transform 0.18s ease, box-shadow 0.18s ease, background 0.2s ease","&::before":{content:'""',position:"absolute",inset:4,borderRadius:"50%",background:"radial-gradient(circle at 30% 28%, rgba(255,255,255,0.38), rgba(255,255,255,0) 60%)",pointerEvents:"none"},"&:hover":{background:"linear-gradient(145deg, #1ABFCC 0%, #0EA7B4 52%, #098A95 100%)",transform:"translateY(-1px)",boxShadow:"-6px -6px 11px rgba(255,255,255,0.24), 10px 12px 18px rgba(7, 74, 82, 0.38), inset 0 1px 0 rgba(255,255,255,0.3), inset 0 -1px 0 rgba(6, 76, 84, 0.45)"},"&:active":{transform:"translateY(1px) scale(0.98)",boxShadow:"-2px -2px 6px rgba(255,255,255,0.18), 4px 5px 10px rgba(7, 74, 82, 0.28), inset 0 2px 4px rgba(5, 90, 98, 0.35)"}},children:(0,r.jsx)(R.Z,{fontSize:"small"})})})]})]})},Q=n(98813),K=(0,a.Z)(function(e){let{loading:t,user:n,onBtnLogoutClick:a}=e;return(0,r.jsx)(i.Z,{loading:t,user:n,onBtnLogoutClick:a,accLevel:Q.DW.ADMIN,children:(0,r.jsx)(J,{})})})}},function(e){e.O(0,[2655,7847,5443,3153,7023,3745,1664,8848,6294,5229,232,4723,7008,9303,1004,8591,2888,9774,179],function(){return e(e.s=18197)}),_N_E=e.O()}]);