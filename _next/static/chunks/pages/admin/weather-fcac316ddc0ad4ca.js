(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3359],{29926:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/weather",function(){return t(9849)}])},43691:function(e,a,t){"use strict";t.d(a,{x:function(){return i},P:function(){return s}});var n=t(85893),l=t(60990),i=function(e){let{children:a,value:t,index:i,...s}=e;return(0,n.jsx)("div",{role:"tabpanel",hidden:t!==i,id:"custom-tabpanel-".concat(i),"aria-labelledby":"custom-tab-".concat(i),...s,children:t===i&&(0,n.jsx)(l.Z,{sx:{p:3},children:a})})},s=function(e){return{id:"custom-tab-".concat(e),"aria-controls":"custom-tabpanel-".concat(e)}}},9849:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return ak}});var n=t(85893),l=t(67294),i=t(9473),s=t(444),r=t(65328),o=t(45773),d=t(60990),c=t(28907),p=t(88607),u=t(43691),h=t(7520),x=t(96788),g=t(83993),m=t(49833),f=t(71713),b=t(92246),j=t(25517),v=t(26525),y=t(51015),S=t(68573),C=t(95611),Z=t(26541),w=t(73705),E=t(22233),A={marginTop:e=>e.spacing(3)},_={color:"gray",marginBottom:e=>e.spacing(1),marginTop:e=>e.spacing(1)},T={display:"flex",marginTop:"12px",maxWidth:"250px"},P=t(90117),k=t(70290),M=t(63662),L=function(e){let{state:a,file:t,isDisabled:l,handleInputChange:i,handleClearClick:s,handleFileUpload:r,handleFileSelected:o}=e;return(0,n.jsxs)(S.ZP,{container:!0,sx:A,children:[(0,n.jsx)(S.ZP,{item:!0,xs:12,children:(0,n.jsx)(E.Z,{label:"Upload an excel file",name:"excelfile",fileAccepts:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",isDisabled:l,fileUploadMethod:r,onFileSelectedCB:o})}),(0,n.jsxs)(S.ZP,{item:!0,xs:12,sx:{marginTop:"24px"},children:[(0,n.jsx)(x.Z,{variant:"h6",children:"Tropical Cyclone Input"}),(0,n.jsxs)(x.Z,{variant:"body2",sx:_,children:["Select PAGASA's shared seasonal weather forecast excel file on the",(0,n.jsx)("strong",{children:" Upload an excel file "})," selector to unlock the Tropical Cyclone Input items below.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Enter the number of tropical cyclones (0â€“10) for each month following the reference picture on the 3rd tab of the selected PAGASA excel file.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"Accepted values:"}),(0,n.jsxs)("ul",{style:{margin:0,paddingLeft:18},children:[(0,n.jsxs)("li",{children:["Single number: ",(0,n.jsx)("b",{children:(0,n.jsx)("span",{style:{color:"green"},children:"0"})}),", ",(0,n.jsx)("b",{children:(0,n.jsx)("span",{style:{color:"green"},children:"1"})}),", ",(0,n.jsx)("b",{children:(0,n.jsx)("span",{style:{color:"green"},children:"2"})}),", ",(0,n.jsx)("b",{children:(0,n.jsx)("span",{style:{color:"green"},children:"..."})})]}),(0,n.jsxs)("li",{children:["Range with ",(0,n.jsx)("b",{children:"or"}),": ",(0,n.jsx)("b",{children:(0,n.jsx)("span",{style:{color:"green"},children:"1 or 2"})})]}),(0,n.jsxs)("li",{children:["Range with ",(0,n.jsx)("b",{children:"to"}),": ",(0,n.jsx)("b",{children:(0,n.jsx)("span",{style:{color:"green"},children:"2 to 4"})})]}),(0,n.jsxs)("li",{children:["No data: ",(0,n.jsx)("b",{children:(0,n.jsx)("span",{style:{color:"green"},children:"nda"})})]})]})]})]}),(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:7,children:a.map((e,a)=>(0,n.jsx)(Z.Z,{id:"month-".concat(a),size:"small",label:e.full,value:e.value,placeholder:"".concat(e.full," no. of cyclones"),sx:T,onChange:i,disabled:l||null===t,InputProps:{startAdornment:(0,n.jsx)(C.Z,{position:"start",children:""===e.value?(0,n.jsx)(P.Z,{fontSize:"small",color:"primary"}):e.isValid?(0,n.jsx)(k.Z,{fontSize:"small",color:"secondary"}):(0,n.jsx)(M.Z,{fontSize:"small",sx:{color:w.Z[500]}})})}},a))}),(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:5,children:"\xa0"}),(0,n.jsx)(S.ZP,{item:!0,xs:12,sx:{marginTop:"12px"},children:(0,n.jsx)(y.Z,{variant:"text",onClick:s,disableElevation:!0,children:"Clear All"})})]})};let I=["1st month","2nd month","3rd month","4th month","5th month","6th month"],O=e=>{let a=String(e||"").trim().toLowerCase(),t=Array.from({length:11},(e,a)=>a.toString()).includes(a),n=/^([0-9]|10)\s+or\s+([0-9]|10)$/.test(a),l=/^([0-9]|10)\s+to\s+([0-9]|10)$/.test(a),i="nda"===a;return t||n||l||i};var D=function(){let[e,a]=(0,l.useState)([]),[t,s]=(0,l.useState)(null),[r,o]=(0,l.useState)(!1),d=(0,i.I0)(),c=(0,i.v9)(e=>e.seasonalweather.status),p=(0,i.v9)(e=>{let a=e.seasonalweather;if(!a||!a.entities)return null;let t=Object.values(a.entities);return t.length>0?t[0]:null}),u=(null==p?void 0:p.data)||null,h=e.length===I.length&&e.some(e=>!e.isValid);(0,l.useEffect)(()=>{if(6===I.length){if(u&&Array.isArray(u)&&6===u.length){a(u.map((e,a)=>({id:a,full:I[a],month:I[a],value:e.value,isValid:!0}))),o(!0);return}a(I.map((e,a)=>({id:a,full:e,month:e,isValid:!1,value:""}))),o(!1)}},[!1,u]);let x=()=>{o(!1),s(null),a(e=>e.map(e=>({...e,isValid:!1,value:""})))},g=async a=>new Promise(async(t,n)=>{if(h)return n("Please check your tropical cyclones list input");try{let n=await (0,m.BZ)(a),l=Array.isArray(n)?n:Array.isArray(null==n?void 0:n.updated)?n.updated:[];await (0,m.eg)({type:v.M.SUB_SEASONAL_COMMON,body:{data:e.map(e=>({id:e.id,value:e.value})),region:"mimaropa",type:v.M.COMMON_SEASONAL_REGIONAL_TYPE.CYCLONES_COUNT}}),d((0,f.Mj)(l.map(e=>({...e,date_created:(0,b.NK)(e.date_created)})))),o(!0),t(!0)}catch(e){console.error("handleFileUpload error:",e),n((null==e?void 0:e.message)||String(e))}});return(0,n.jsx)(L,{state:e,file:t,isDisabled:c===j.G.PENDING||r,handleInputChange:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update",{id:l,value:i}=t.target,s=l.split("-")[1],o=[...e];!r&&o[s]&&("clear"===n?(o[s].value="",o[s].isValid=!1):(o[s].value=i,i.length>=10?o[s].isValid=!1:o[s].isValid=""!==i&&O(i)),a(()=>o))},handleClearClick:x,handleFileUpload:g,handleFileSelected:e=>{s(e),e||x()}})},N=t(91154),F=t(25675),G=t.n(F),R=t(9883),U=t(76592),z=t(19827),W=t(8863),B=t(25026),V=t(70360),H=t(46577),Y=t(93454),K=t(26073),J=t(16729),X=t(17553),Q=t(32209),q={container:{marginTop:e=>e.spacing(3)},text:{color:"gray",marginBottom:e=>e.spacing(1),marginTop:e=>e.spacing(1)},toggleEnabled:{backgroundColor:"#2e7d32",color:"#fff",borderColor:"#2e7d32","&:hover":{backgroundColor:"#256628",borderColor:"#256628"}},toggleDisabled:{backgroundColor:"#9e9e9e",color:"#fff",borderColor:"#9e9e9e","&:hover":{backgroundColor:"#8a8a8a",borderColor:"#8a8a8a"}}},$=t(56871),ee=t(86650);async function ea(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"weather-system-icons";if(!e)throw Error("No file provided");let t=(0,$.iH)($.tO,"".concat(a,"/").concat(Date.now(),"_").concat(e.name));return await (0,ee.KV)(t,e),await (0,$.Jt)(t)}var et=t(62590),en=t(84630),el=t(55925),ei=t(57104),es=t(2644),er=t(58773),eo=t(54127),ed=t(93508),ec=t(73986),ep=t(34279),eu=t(97535),eh=function(e){let{state:a,message:t,log:i,isLoading:s,handleToggleSystem:r,handleAddCustom:o,handleUpdateSystem:c,handleDeleteSystem:p,handleClearClick:u,handleReset:h,handleSaveClick:g,handleCancelSaveClick:m,handleResetMsg:f,onSaveClick:j}=e,[v,C]=(0,l.useState)(!1),[w,E]=(0,l.useState)(""),[A,_]=(0,l.useState)(""),[T,P]=(0,l.useState)(!1),[k,M]=(0,l.useState)(null),[L,I]=(0,l.useState)(""),[O,D]=(0,l.useState)({}),[N,F]=(0,l.useState)(null),[$,ee]=(0,l.useState)(null),eh=(0,l.useRef)(),ex=(0,l.useRef)(),eg=e=>{switch(e){case"Northeast Monsoon":case"Intertropical Convergence Zone":default:return(0,n.jsx)(et.Z,{fontSize:"small"});case"Shear Line":return(0,n.jsx)(ec.Z,{fontSize:"small"});case"Frontal System":return(0,n.jsx)(el.Z,{fontSize:"small"});case"Low Pressure Area":return(0,n.jsx)(en.Z,{fontSize:"small"});case"Tropical Cyclones (TCs)":return(0,n.jsx)(ei.Z,{fontSize:"small"});case"Localized Thunderstorms":return(0,n.jsx)(eo.Z,{fontSize:"small"});case"Easterlies":return(0,n.jsx)(es.Z,{fontSize:"small"});case"Ridge of High Pressure Area":return(0,n.jsx)(ed.Z,{fontSize:"small"});case"Southwest Monsoon":return(0,n.jsx)(er.Z,{fontSize:"small"})}},em=i&&i.updated_by&&""!==i.updated_by.trim()?i.updated_by:"-",ef=i&&i.date_created?(0,b.NK)(i.date_created):"-",eb=a&&a.length>0;return(0,n.jsxs)(d.Z,{sx:q.container,children:[v&&(0,n.jsx)(J.Z,{isOpen:!0,title:"Add Weather System",contentText:"Provide a label and optional icon URL (direct image link).",openButtonText:null,modalConfirmHandlerCB:async()=>{let e=A;if(N)try{e=await ea(N)}catch(e){alert("Failed to upload icon: "+e.message);return}o({label:w,iconUrl:e}),E(""),_(""),F(null),C(!1)},modalCancelHandlerCB:()=>{E(""),_(""),F(null),C(!1)},children:(0,n.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,n.jsx)(Z.Z,{label:"Weather System Label",value:w,onChange:e=>E(e.target.value),disabled:s,size:"small",fullWidth:!0}),(0,n.jsx)(Z.Z,{label:"Icon URL (optional)",value:A,onChange:e=>_(e.target.value),disabled:s,size:"small",fullWidth:!0}),(0,n.jsx)("input",{ref:eh,type:"file",accept:"image/*",style:{display:"block"},disabled:s,onChange:e=>F(e.target.files[0])}),N&&(0,n.jsxs)("span",{children:["Selected: ",N.name]})]})}),T&&(0,n.jsx)(J.Z,{isOpen:!0,title:"Edit Weather System",contentText:"Update label and optional icon URL (direct image link).",openButtonText:null,modalConfirmHandlerCB:async()=>{let e=A;if($)try{e=await ea($)}catch(e){alert("Failed to upload icon: "+e.message);return}c({id:k,label:L,iconUrl:e}),I(""),_(""),M(null),ee(null),P(!1)},modalCancelHandlerCB:()=>{I(""),_(""),M(null),ee(null),P(!1)},children:(0,n.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,n.jsx)(Z.Z,{label:"Weather System Label",value:L,onChange:e=>I(e.target.value),disabled:s,size:"small",fullWidth:!0}),(0,n.jsx)(Z.Z,{label:"Icon URL (optional)",value:A,onChange:e=>_(e.target.value),disabled:s,size:"small",fullWidth:!0}),(0,n.jsx)("input",{ref:ex,type:"file",accept:"image/*",style:{display:"block"},disabled:s,onChange:e=>ee(e.target.files[0])}),$&&(0,n.jsxs)("span",{children:["Selected: ",$.name]})]})}),t.openLoadingModal&&(0,n.jsx)(J.Z,{isOpen:!0,title:"Save changes",contentText:t.modalMsg,loading:s,openButtonText:null,modalConfirmHandlerCB:j,modalCancelHandlerCB:m}),""!==t.msg&&(0,n.jsx)(X.Z,{openSnackbar:!0,message:t.msg,severity:t.type,closeHandlerCB:f}),(0,n.jsx)(x.Z,{variant:"h6",sx:{mt:3,mb:1},children:"Weather Systems that May Affect the Region"}),(0,n.jsx)(x.Z,{variant:"body2",sx:q.text,children:"Manage weather systems available in the system. Only enabled systems will appear in dropdowns throughout the application."}),(0,n.jsx)(Q.Z,{children:s?"Loading...":"Updated by ".concat(em," on ").concat(ef,".")}),(0,n.jsx)(B.Z,{component:Y.Z,sx:{mt:2},children:(0,n.jsxs)(U.Z,{children:[(0,n.jsx)(V.Z,{children:(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(W.Z,{children:"Name"}),(0,n.jsx)(W.Z,{children:"Icon"}),(0,n.jsx)(W.Z,{children:"Status"}),(0,n.jsx)(W.Z,{align:"right",children:"Actions"})]})}),(0,n.jsx)(z.Z,{children:a.map(e=>(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(W.Z,{children:e.label}),(0,n.jsx)(W.Z,{children:e.iconUrl&&!O[e.id]?(0,n.jsx)(G(),{src:e.iconUrl,alt:"",width:18,height:18,style:{objectFit:"contain"},onError:()=>D(a=>({...a,[e.id]:!0})),unoptimized:!0}):eg(e.label)}),(0,n.jsx)(W.Z,{children:(0,n.jsx)(K.Z,{size:"small",value:"enabled",selected:e.enabled,disabled:s,onChange:()=>r(e.id),sx:e.enabled?q.toggleEnabled:q.toggleDisabled,children:e.enabled?"Enabled":"Disabled"})}),(0,n.jsxs)(W.Z,{align:"right",children:[(0,n.jsx)(y.Z,{variant:"text",size:"small",disabled:s,onClick:()=>{M(e.id),I(e.label),_(e.iconUrl||""),P(!0)},children:(0,n.jsx)(ep.Z,{fontSize:"small"})}),(0,n.jsx)(y.Z,{variant:"text",size:"small",disabled:s,onClick:()=>p(e.id),children:(0,n.jsx)(eu.Z,{fontSize:"small"})})]})]},e.id))})]})}),(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:5,children:"\xa0"}),(0,n.jsxs)(d.Z,{sx:{mt:2,display:"flex",gap:1},children:[(0,n.jsx)(R.Z,{onClick:u,disabled:s||!eb,children:"Clear All"}),(0,n.jsx)(R.Z,{onClick:h,disabled:s,children:"Reset"}),(0,n.jsx)(R.Z,{onClick:()=>C(!0),disabled:s,children:"Add"}),(0,n.jsx)(R.Z,{onClick:g,variant:"contained",children:"Save"})]})]})};let ex=[{key:"northeast_monsoon",label:"Northeast Monsoon"},{key:"shear_line",label:"Shear Line"},{key:"frontal_system",label:"Frontal System"},{key:"low_pressure_area",label:"Low Pressure Area"},{key:"tropical_cyclones",label:"Tropical Cyclones (TCs)"},{key:"localized_thunderstorms",label:"Localized Thunderstorms"},{key:"easterlies",label:"Easterlies"},{key:"ridge_of_high_pressure_area",label:"Ridge of High Pressure Area"},{key:"intertropical_convergence_zone",label:"Intertropical Convergence Zone"},{key:"southwest_monsoon",label:"Southwest Monsoon"}],eg={success:"success",error:"error"},em={msg:"",type:"",modalMsg:"Save changes to the weather systems list?",openLoadingModal:!1},ef=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=e.trim();if(!a)return"";let t=a.match(/drive\.google\.com\/file\/d\/([^/]+)/);if(t&&t[1])return"https://drive.google.com/uc?export=view&id=".concat(t[1]);let n=a.match(/drive\.google\.com\/open\?id=([^&]+)/);if(n&&n[1])return"https://drive.google.com/uc?export=view&id=".concat(n[1]);let l=a.match(/drive\.google\.com\/uc\?id=([^&]+)/);return l&&l[1]?"https://drive.google.com/uc?export=view&id=".concat(l[1]):a};var eb=function(){let[e,a]=(0,l.useState)([]),[t,s]=(0,l.useState)(em),[r,o]=(0,l.useState)(!1),d=(0,i.I0)(),c=(0,l.useRef)(!1),{ids:p,entities:u,status:h,updated_by:x,date_created:g}=(0,i.v9)(e=>e.seasonalcommon_misc);(0,l.useEffect)(()=>(c.current=!0,d((0,N.h)()).unwrap().then(()=>{c.current&&o(!0)}),()=>{c.current=!1}),[d]);let m=(0,l.useCallback)(()=>{c.current&&(s(em),a(Object.values(u).map((e,a)=>({id:a,key:e.key||"custom_".concat(a),label:e.value,enabled:!1!==e.enabled,iconUrl:ef(e.iconUrl||""),isCustom:!ex.find(a=>a.label===e.value)})).filter(e=>e.label)))},[u]);return(0,l.useEffect)(()=>{h===j.G.FULLFILLED&&p.length>0&&r&&m()},[h,p,r,m]),(0,n.jsx)(eh,{state:e,message:t,log:{updated_by:x,date_created:g},isLoading:h===j.G.PENDING,handleToggleSystem:e=>{c.current&&a(a=>a.map(a=>a.id===e?{...a,enabled:!a.enabled}:a))},handleAddCustom:e=>{let{label:t,iconUrl:n}=e;c.current&&t&&""!==t.trim()&&a(e=>e.find(e=>e.label.toLowerCase()===t.toLowerCase())?e:[...e,{id:e.length,key:"custom_".concat(e.length),label:t.trim(),enabled:!0,iconUrl:ef(n||""),isCustom:!0}])},handleUpdateSystem:e=>{let{id:t,label:n,iconUrl:l}=e;c.current&&a(e=>e.map(e=>e.id===t?{...e,label:(null==n?void 0:n.trim())||e.label,iconUrl:ef(l||"")}:e))},handleDeleteSystem:e=>{c.current&&a(a=>a.filter(a=>a.id!==e))},handleClearClick:()=>{c.current&&a(e=>e.map(e=>({...e,enabled:!1})))},handleReset:m,handleSaveClick:()=>s({...t,openLoadingModal:!0}),handleCancelSaveClick:()=>s({...t,openLoadingModal:!1}),handleResetMsg:()=>s(em),onSaveClick:()=>{if(!c.current)return;let a=e.filter(e=>e.enabled).map((e,a)=>({id:a,value:e.label,iconUrl:ef(e.iconUrl||""),isValid:!0}));s({...t,modalMsg:"Saving..."}),d((0,N.O)(a)).unwrap().then(()=>{c.current&&s({...em,msg:"Successfully saved changes.",type:eg.success})}).catch(e=>{c.current&&s({...em,msg:e,type:eg.error})})}})},ej=t(31292),ev=function(){return(0,n.jsxs)("div",{children:[(0,n.jsx)(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:e=>e.spacing(1)},children:(0,n.jsx)(x.Z,{variant:"h6",children:"Seasonal Weather Forecast Updater"})}),(0,n.jsx)("br",{}),(0,n.jsx)(x.Z,{variant:"h7",children:(0,n.jsx)("strong",{children:"Upload an Excel File"})}),(0,n.jsxs)(x.Z,{variant:"body2",sx:ej.Z.subheader,children:["Update ACAP's seasonal weather forecast rainfall, tropical cyclones, and weather systems affecting the region data by uploading the updated seasonal weather forecast raw data in the excel file provided by PAGASA by clicking the SEARCH button, followed by clicking the UPLOAD button under the ",(0,n.jsx)("strong",{children:"Upload an Excel File"})," option below.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:(0,n.jsx)("span",{style:{color:"orange"},children:"CAUTION:"})})," ","Since PAGASA's shared seasonal Excel file has no year data, the seasonal Excel file upload will take the current year as a basis for the starting 1st seasonal month.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"You can use the attached seasonal weather forecast excel file from PAGASA as a template when uploading an excel file. The excel file should follow the format and structure of the attached sample.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Write"," ",(0,n.jsx)("span",{style:{color:"orange"},children:(0,n.jsx)("b",{children:"nda"})})," ",'for Excel cell values with "no data available" for given month or parameter.',(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsxs)("label",{style:{fontSize:"12px"},children:["PAGASA's latest seasonal weather forecast is availabe on"," ",(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/climate/climate-prediction/seasonal-forecast",target:"_blank",rel:"noreferrer",children:"PAGASA' Seasonal (Rainfall) Forecast"})," ","web page for reference."]}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("a",{href:"https://firebasestorage.googleapis.com/v0/b/acap-mimaropa-dev.appspot.com/o/files%2Ftemplates%2Fpagasa_seasonal_v2.xlsx?alt=media&token=a0c3a02d-733a-47d7-9f86-42649fe4506e",target:"__blank",children:"[Seasonal Forecast Excel template]"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g.Z,{withBorder:!0}),(0,n.jsx)(D,{}),(0,n.jsx)(eb,{})]})]})},ey=t(18938),eS=t(76281),eC=t(77527),eZ=t(81873),ew=t(97182),eE=t(44723);let eA=(0,eC.ZP)(e=>(0,n.jsx)(d.Z,{...e}))(e=>{let{theme:a}=e;return{display:"flex",alignItems:"center",maxWidth:"500px",minHeight:"100px",border:"1px solid gray",borderRadius:"8px",marginTop:a.spacing(1),marginBottom:a.spacing(3),"& ul":{listStyle:"none",paddingLeft:a.spacing(3)}}});var e_=function(e){return(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(x.Z,{sx:{marginTop:e=>e.spacing(4)},variant:"h6",children:e.title}),(0,n.jsx)(eA,{children:e.children})]})},eT=t(98813),eP=t(49986),ek=t(71604),eM=function(e){let{text:a,label:t,imagePath:l}=e;return(0,n.jsx)(d.Z,{sx:{borderRadius:"4px",margin:"4px",padding:"8.5px 14px 8.5px 8.5px",fontSize:"1rem",lineHeight:"1.4375em","& span":{marginLeft:"8px"}},children:(0,n.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(G(),{unoptimized:!0,src:(0,ek.assetPrefixer)(l),height:20,width:20,loader:ek.imageLoader,alt:"moon phase"}),(0,n.jsxs)("span",{children:[t,":"]}),(0,n.jsx)("span",{children:a})]})})},eL={container:{marginTop:e=>e.spacing(3)},text:{color:"gray",marginBottom:e=>e.spacing(1),marginTop:e=>e.spacing(1)},rowItem:{display:"flex",marginTop:"16px",maxWidth:{xs:"100%",sm:"300px"}},btnGroup:{"& button":{width:"110px"},display:{sm:"flex",md:"unset"},flexDirection:{sm:"column"}}},eI=function(e){let{state:a,message:t,log:l,isDisabled:i,isViewInfo:s,handleInputChange:r,handleClearClick:o,handleSaveClick:c,handleCancelSaveClick:p,handleSwitchClick:u,onSaveClick:h}=e;return(0,n.jsxs)(S.ZP,{container:!0,sx:eL.container,children:[t.openLoadingModal&&(0,n.jsx)(J.Z,{isOpen:!0,title:"Save changes",contentText:t.modalMsg,loading:i,openButtonText:null,modalConfirmHandlerCB:h,modalCancelHandlerCB:p}),""!==t.msg&&(0,n.jsx)(X.Z,{openSnackbar:!0,message:t.msg,severity:t.type,closeHandlerCB:p}),(0,n.jsxs)(S.ZP,{item:!0,xs:12,sx:{marginTop:"32px"},children:[(0,n.jsx)(x.Z,{variant:"h6",children:"Moon Phases Input"}),(0,n.jsxs)(x.Z,{variant:"body2",sx:eL.text,children:["Listed below are the moon phases data for the 10-Day weather outlook PDF moon phases section.",(0,n.jsx)("br",{}),"Click the ",(0,n.jsx)("strong",{children:"EDIT"})," button to start editing it's content."]}),(0,n.jsxs)(Q.Z,{children:["Updated by ",l.updated_by," on ",l.date_created," from PAGASA's ",(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/astronomy/astronomical-diary",target:"_blank",rel:"noreferrer",children:"Astronomical Diary"})," web page."]})]}),(0,n.jsxs)(S.ZP,{item:!0,xs:12,lg:7,sx:{marginTop:"8px"},children:[s?a.map((e,a)=>(0,n.jsx)(eM,{text:e.value,label:e.label,imagePath:e.image},a)):a.map((e,a)=>(0,n.jsx)(Z.Z,{id:"month-".concat(a),size:"small",label:e.label,value:e.value,placeholder:"".concat(e.label," date i.e., 29-Jun-22"),sx:eL.rowItem,disabled:i,onChange:r,InputProps:{startAdornment:(0,n.jsx)(C.Z,{position:"start",children:""===e.value?(0,n.jsx)(P.Z,{fontSize:"small",color:"primary"}):e.isValid?(0,n.jsx)(k.Z,{fontSize:"small",color:"secondary"}):(0,n.jsx)(M.Z,{fontSize:"small",sx:{color:w.Z[500]}})})}},a)),(0,n.jsx)(d.Z,{sx:{marginTop:"24px",marginLeft:"8px"},children:(0,n.jsx)(eP.Z,{variant:"text",size:"small",disabled:i,disableElevation:!0,sx:eL.btnGroup,children:s?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(R.Z,{variant:"contained",onClick:u,children:"Edit"})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(R.Z,{onClick:o,children:"Clear All"}),(0,n.jsx)(R.Z,{onClick:u,children:"Cancel"}),(0,n.jsx)(R.Z,{variant:"contained",onClick:c,disabled:i,children:"Save"})]})})})]})]})};let eO={NEW_MOON:{code:"new_moon",label:"New Moon"},FIRST_QUARTER:{code:"first_quarter",label:"First Quarter"},FULL_MOON:{code:"full_moon",label:"Full Moon"},LAST_QUARTER:{code:"last_quarter",label:"Last Quarter"}},eD={msg:"",type:"",action:"view",loading:!1,modalMsg:"Save changes to the moon phases list?",openLoadingModal:!1},eN={updated_by:"",date_created:""};var eF=function(){let[e,a]=(0,l.useState)([]),[t,i]=(0,l.useState)(eD),[s,r]=(0,l.useState)(eN),[o,d]=(0,l.useState)(!0),c=(0,l.useRef)(!1),[p,u,h]=(0,ey.ky)(v.M.WEATHER_FORECASTS,"".concat("mimaropa","/").concat(v.M.SUB_TENDAY_COMMON,"/").concat(v.M.COMMON_TENDAY_TYPE.MOON_PHASES)),x=(0,l.useCallback)(e=>{e&&e.data&&a(a=>{let t=[...a];return e.data.forEach((e,a)=>{t[a]&&(t[a].value=e.value,t[a].isValid=""!==e.value)}),t})},[]);(0,l.useEffect)(()=>(c.current=!0,a(Object.values(eO).reduce((e,a,t)=>[...e,{id:t,value:"-",phase:a.code,label:a.label,image:"images/icons/moon/".concat(a.code,".svg"),isValid:!1}],[])),()=>{c.current=!1}),[]),(0,l.useEffect)(()=>{!u&&c.current&&p&&(x(p),r(e=>({...e,updated_by:p.updated_by,date_created:(0,b.Xn)(p.date_created)}))),""!==h&&c.current&&i({...eD,msg:h,type:eT.C7.ERROR})},[p,u,h,x]);let g=e=>{o||x(e||p),d(e=>!e)},f=async()=>{if(c.current)try{i({...eD,loading:!0,openLoadingModal:!0,modalMsg:"Saving changes..."});let a=await (0,m.eg)({type:v.M.SUB_TENDAY_COMMON,body:{region:"mimaropa",type:v.M.COMMON_TENDAY_TYPE.MOON_PHASES,data:e.map((e,a)=>({id:a,value:e.value,phase:e.phase}))}});c.current&&(i(e=>({...eD,msg:"Successfully saved changes",type:eT.C7.SUCCESS})),r(e=>({...e,updated_by:a.updated_by,date_created:(0,b.NK)(a.date_created)})),g(a))}catch(e){if(c.current){let a="";void 0!==e.response&&(a=void 0!==e.response.data?e.response.data:""),""===a&&(a=e.message),i({...eD,msg:a,type:eT.C7.ERROR})}}};return(0,n.jsx)(eI,{state:e,message:t,log:s,isDisabled:t.loading,isViewInfo:o,handleInputChange:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update",{id:l,value:i}=t.target,s=l.split("-")[1],r=[...e];r[s]&&("clear"===n?(r[s].value="",r[s].isValid=!1):(r[s].value=i,i.length>=10?r[s].isValid=!1:r[s].isValid=""!==i),a(e=>r))},handleClearClick:()=>{a(e=>e.map(e=>({...e,isValid:!1,value:""})))},handleSaveClick:()=>{if(void 0!==e.find(e=>""===e.value)){i(e=>({...e,msg:"Please check your input",type:eT.C7.INFO,openLoadingModal:!1}));return}i({...t,openLoadingModal:!0})},handleCancelSaveClick:()=>i(eD),handleSwitchClick:()=>g(null),onSaveClick:f})},eG=e=>({marginBottom:e.spacing(2),color:"gray",marginTop:e.spacing(1),"& a":{color:e.palette.green.dark,textDecoration:"none"},"& a:visited":{color:e.palette.green.dark},"& a:hover, span:hover":{textDecoration:"underline"}}),eR={display:"flex",alignItems:"center",maxWidth:"500px",minHeight:"90px",border:"1px solid gray",borderRadius:"8px",fontSize:"14px",color:e=>e.palette.text.secondary,padding:e=>e.spacing(2),marginTop:e=>e.spacing(1),marginBottom:e=>e.spacing(1)},eU={maxWidth:"500px",marginBottom:e=>e.spacing(2)};let ez=(0,eC.ZP)("input")({display:"none"});var eW=function(e){let{files:a=[],status:t,logs:l,handleSubmit:i,handleSelectFiles:s}=e;return(0,n.jsxs)(d.Z,{sx:{"& li":{fontSize:"14px"}},children:[(0,n.jsx)(x.Z,{sx:{marginTop:e=>e.spacing(1)},variant:"h6",children:"10-Day Weather Forecast Updater"}),(0,n.jsxs)(x.Z,{variant:"body2",sx:eG,children:["ACAP's system updates its internal 10-Day Weather Forecast data by automatically downloading, parsing, and uploading the 10-day weather forecast excel files from PAGASA's ",(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/climate/climate-prediction/10-day-climate-forecast",target:"_blank",rel:"noreferrer",children:"10-Day Climate Forecast"})," web page to ACAP's database.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"ACAP's daily automatic 10-Day Weather Forecast updating runs daily between 9:00 AM to 12:00 PM PH time.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"This panel updates the site's 10-Day Weather Forecast data by allowing admins to manually upload the excel files downloaded from PAGASA's web page. Follow the steps to update the site's 10-Day Weather Forecast data:"]}),(0,n.jsxs)("ol",{children:[(0,n.jsxs)("li",{children:["Download all (10) excel files from PAGASA's ",(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/climate/climate-prediction/10-day-climate-forecast",target:"_blank",rel:"noreferrer",children:"10 Day Climate Forecast"})," web page."]}),(0,n.jsx)("li",{children:"Press the SELECT FILES button and select all the excel files."}),(0,n.jsx)("li",{children:"Press the SUBMIT button."}),(0,n.jsx)("li",{children:"Wait for the upload process to finish."})]}),(0,n.jsx)(e_,{title:"Current Data Update Summary",children:(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Updated by:"}),"\xa0 ",l.updated_by]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Valid Until:"}),"\xa0 ",l.date_valid]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Date of Forecast:"}),"\xa0 ",l.date_forecast]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Date synced:"}),"\xa0 ",l.date_synced]})]})}),(0,n.jsx)(d.Z,{sx:eR,children:0===a.length?(0,n.jsx)("span",{children:"Select excel files."}):(0,n.jsx)(d.Z,{sx:{"& div":{margin:"2px"}},children:Array.from(a).map((e,a)=>(0,n.jsx)(eZ.Z,{label:e.name,size:"small"},"excel-".concat(a)))})}),(0,n.jsxs)(d.Z,{sx:eU,children:[!t.loading&&""!==t.error&&(0,n.jsx)(eE.Z,{severity:"error",children:t.error}),!t.loading&&""!==t.msg&&(0,n.jsx)(eE.Z,{severity:"success",children:t.msg})]}),(0,n.jsxs)("label",{htmlFor:"contained-button-file",children:[(0,n.jsx)(ez,{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",id:"contained-button-file",multiple:!0,type:"file",name:"excel-files",onChange:s,disabled:t.loading}),(0,n.jsxs)(R.Z,{variant:"text",component:"span",size:"small",disabled:t.loading,disableElevation:!0,sx:{width:"110px"},children:["Select Files",(0,n.jsx)(ew.Z,{size:20,color:"secondary",sx:{display:t.loading?"block":"none"}})]}),(0,n.jsx)(R.Z,{type:"submit",variant:"contained",size:"small",onClick:i,disabled:t.loading,disableElevation:!0,sx:{width:"110px"},children:"Submit"})]}),(0,n.jsx)(eF,{})]})};let eB={loading:!1,error:"",msg:""},eV={updated_by:"",date_forecast:"",date_synced:"",date_valid:""};var eH=function(e){let{getDateToString:a}=e,[t,i]=(0,l.useState)([]),[s,r]=(0,l.useState)(eB),[o,d]=(0,l.useState)(eV),{documents:c,loading:p,error:u}=(0,ey.tl)(v.M.WEATHER_FORECASTS,"mimaropa","ten_day","name",1),h=(0,l.useCallback)(e=>{if(!e||!e.length)return;let t=e[0]||{},n=t.municipalities||{},l=Object.keys(n)[0];if(!l)return;let i=(n[l]||[])[0];i&&d({updated_by:t.updated_by||"",date_synced:t.date_created?a(t.date_created):"",date_forecast:i.date_forecast||"",date_valid:i.date_range||""})},[a]);(0,l.useEffect)(()=>{!p&&""===u&&c.length>0&&h(c)},[p,u,c,h]);let x=async()=>{let e=new FormData;for(let a=0;a<t.length;a+=1)e.append("excel-files",t[a]);try{r({...eB,loading:!0}),await (0,m.pc)(e),r({...eB,loading:!1,msg:"Upload success."})}catch(a){let e=a.response?a.response.data:a.message;r({...eB,loading:!1,error:e});return}try{let e=await (0,eS.vx)();h(e)}catch(e){console.error(e.message)}};return(0,n.jsx)(eW,{files:t,status:s,logs:o,handleSubmit:x,handleSelectFiles:e=>{r(eB),i(e.target.files)}})},eY=t(819),eK=t(84325),eJ=t(20481),eX=t(25837),eQ=t(12166),eq=t(87406),e$=t(27151),e0={minHeight:"420px",margin:"8px","& .windsignalrow":{margin:"24px 0 24px 0"}};let e1={id:"municipalities",label:"Select All...",all:!0};var e2=function(e){let{item:a,signalNum:t="",onItemChange:s}=e,[r,o]=(0,l.useState)(!1),{ids:c,entities:p,status:u}=(0,i.v9)(e=>e.provinces),{ids:h,entities:g,status:m}=(0,i.v9)(e=>e.municipalities),f=(0,l.useMemo)(()=>[e1,...h.map(e=>g[e])],[g,h]);(0,l.useEffect)(()=>{var e,t;if(!r||!a.municipalities)return;let n=null!==(t=null===(e=f.filter(e=>e.disabled||void 0!==e.iscalendar))||void 0===e?void 0:e.length)&&void 0!==t?t:0;r&&a.municipalities.length!==h.length-n&&o(!1)},[null==a?void 0:a.municipalities,f,h,r]);let b=(0,n.jsx)(e$.Z,{fontSize:"small"}),v=(0,n.jsx)(eq.Z,{fontSize:"small"});return(0,n.jsxs)(d.Z,{sx:e0,children:[(0,n.jsxs)(d.Z,{className:"windsignalrow",children:[(0,n.jsx)(x.Z,{variant:"h5",color:"primary",children:(0,n.jsx)("strong",{children:"Wind Signal # ".concat(t)})}),(0,n.jsxs)(x.Z,{variant:"body2",sx:{marginTop:"8px"},children:["Select affected ",(0,n.jsx)("strong",{children:"provinces"})," and ",(0,n.jsx)("strong",{children:"municipalities"}),". Press the ",(0,n.jsx)("strong",{children:"OK"})," button to confirm your selection."]})]}),(0,n.jsx)(d.Z,{className:"windsignalrow",children:(0,n.jsx)(eX.Z,{disablePortal:!0,id:"province",value:a[0],disabled:0===c.length||u===j.G.PENDING||m===j.G.PENDING,options:c.map(e=>p[e]),renderInput:e=>(0,n.jsx)(Z.Z,{...e,variant:"standard",label:0===c.length?"Loading...":"Select a province"}),isOptionEqualToValue:(e,a)=>e.label===a.label,onChange:(e,a)=>{s({target:{id:"province",value:a,signal:t}})}})}),(0,n.jsx)(d.Z,{className:"windsignalrow",children:(0,n.jsx)(eX.Z,{multiple:!0,limitTags:4,disableCloseOnSelect:!0,id:"municipalities",value:a.municipalities,options:f,ListboxProps:{style:{maxHeight:"200px"}},sx:{".inputRoot":{color:"res"}},disabled:null===a.province||0===c.length||0===h.length||u===j.G.PENDING||m===j.G.PENDING,renderInput:e=>(0,n.jsx)(Z.Z,{...e,variant:"standard",label:0===c.length?"Loading...":"Select municipalities"}),renderOption:(e,a,t)=>{let{selected:l}=t;if(l&&a.label!==e1.label)return;let i=a.label===e1.label?r:l;return(0,n.jsxs)("li",{...e,children:[(0,n.jsx)(eQ.Z,{icon:b,checkedIcon:v,style:{marginRight:8},checked:i}),a.label]})},getOptionDisabled:e=>e.disabled||void 0!==e.iscalendar,isOptionEqualToValue:(e,a)=>e.label===a.label,onChange:(e,a)=>{a.find(e=>e.label===e1.label)?(o(!0),s({target:{id:"municipalities",value:r?[]:f.filter(e=>!e.disabled&&!e.iscalendar&&e.label!==e1.label),signal:t}})):s({target:{id:"municipalities",value:a,signal:t}})}})})]})},e5=t(56112),e3=t(42823),e6={rowItem:{display:"flex",marginTop:"24px",maxWidth:"parent","& .MuiOutlinedInput-root":{paddingLeft:e=>e.spacing(2)}},btnCancel:{height:e=>e.spacing(5),width:"40px",borderTopLeftRadius:0,borderBottomLeftRadius:0,"& span":{marginRight:0}},btnGroup:{marginTop:"8px","& button":{width:"110px"},display:{sm:"flex",md:"unset"},flexDirection:{sm:"column"}},listContainer:{marginTop:"8px",padding:"16px",display:"flex",justifyContent:"space-between"}},e8=t(71687),e9=t(4145),e7=function(e){let{state:a,appstate:t,message:s,windsignalitems:r,updateinfo:o,onConfirmClick:c,onCancelClick:p,onLocationItemChange:u,handleInputChange:g,handleAddClick:m,handleClearClick:f,handleDeleteClick:b,handleDeleteProvince:v,handleReset:y,handleSaveClick:Z,handleAppState:E,currentItem:A}=e,_=(0,i.v9)(e=>e.provinces.status),T=(0,i.v9)(e=>e.municipalities.status),[L,I]=(0,l.useState)(!0),[O,D]=(0,l.useState)(0),[N,F]=(0,l.useState)(!1);(0,l.useEffect)(()=>{I(_===j.G.PENDING||T===j.G.PENDING||s.saving)},[_,T,s.saving]);let G=e=>{F(e=>!e),D(e)};return(0,n.jsxs)(d.Z,{sx:{minWidth:"300px",width:"100%",marginTop:"40px"},children:[(0,n.jsx)(x.Z,{variant:"h6",children:"Wind Speed List Editor"}),""!==s.MSG&&(0,n.jsx)(X.Z,{openSnackbar:!0,message:s.MSG,severity:s.TYPE}),(0,n.jsx)(J.Z,{openButtonText:null,maxWidth:"sm",title:s.TITLE,loading:s.saving,contentText:t!==eK.yf.EDIT?s.MODAL_MSG:null,modalConfirmHandlerCB:()=>{switch(t){case eK.yf.EDIT:F(e=>!e),c(O);break;case eK.yf.SAVE:Z()}},modalCancelHandlerCB:()=>{F(e=>!e),p()},isOpen:t===eK.yf.EDIT?N&&s.openLoadingModal:s.openLoadingModal,children:t===eK.yf.EDIT&&(0,n.jsx)(e2,{item:A,signalNum:O,onItemChange:u})}),(0,n.jsx)(S.ZP,{item:!0,xs:12,md:4,children:(0,n.jsxs)(S.ZP,{container:!0,spacing:3,children:[0===a.length?(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:7,children:(0,n.jsx)(e3.Z,{message:"There are no wind signal data. Encode wind signal data now for future viewing.",style:{marginTop:"16px"}})}):(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:7,children:a.map((e,a)=>(0,n.jsxs)(e5.Z,{sx:{marginTop:"16px"},children:[(0,n.jsx)(eJ.Z,{id:"wsignal-".concat(a),size:"small",label:e.full,value:e.value,disabled:L,placeholder:"Enter a wind signal number",sx:e6.rowItem,onChange:g,InputProps:{startAdornment:(0,n.jsx)(C.Z,{position:"start",children:""===e.value?(0,n.jsx)(P.Z,{fontSize:"small",color:"primary"}):e.isValid?(0,n.jsx)(k.Z,{fontSize:"small",color:"secondary"}):(0,n.jsx)(M.Z,{fontSize:"small",sx:{color:w.Z[500]}})}),endAdornment:(0,n.jsxs)(eP.Z,{disableElevation:!0,children:[(0,n.jsx)(R.Z,{size:"small",disabled:""===e.value||!e.isValid||L,sx:{width:"80px",borderTopLeftRadius:"0px",borderBottomLeftRadius:"0px"},onClick:()=>{G(e.value),E(eK.yf.EDIT,a)},children:"Edit"}),(0,n.jsx)(R.Z,{startIcon:(0,n.jsx)(e9.Z,{fontSize:"small"}),sx:e6.btnCancel,onClick:()=>b(a,e.value),disabled:L})]})}},a),r.map((a,t)=>{if(a.signal===parseInt(e.value))return(0,n.jsxs)(h.Z,{sx:e6.listContainer,children:[(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(x.Z,{variant:"body1",children:(0,n.jsx)("strong",{children:a.province.label})}),(0,n.jsxs)(x.Z,{variant:"body2",children:["(",a.municipalities.map(e=>e.label).toString().split(",").join(", "),")"]})]}),(0,n.jsx)(d.Z,{children:(0,n.jsx)(R.Z,{sx:e6.btnCancel,startIcon:(0,n.jsx)(e8.Z,{fontSize:"small"}),disabled:L,onClick:()=>{v(parseInt(e.value),a.province.label)}})})]},"itm-".concat(t))})]},a))}),(0,n.jsxs)(S.ZP,{item:!0,xs:12,lg:5,children:[(0,n.jsx)(h.Z,{sx:{width:"parent",marginTop:"16px"},children:(0,n.jsxs)(Q.Z,{sx:{fontWeight:400,fontSize:"0.875rem",lineHeight:"1.43",letterSpacing:"0.01071em",color:"rgba(0, 0, 0, 0.6)"},children:["Encode wind speed for hand-picked ",eT.Gt,' provinces and municipalities here. This data will be display on ACAP"s Special Weather Forecast section and used as reference on the Tropical Cyclone bulletins, if a typhoon will be detected from PAGASA"s web page.']})}),(0,n.jsx)(h.Z,{sx:{width:"parent",marginTop:"16px"},children:(0,n.jsx)(Q.Z,{children:o})})]})]})}),(0,n.jsx)(S.ZP,{item:!0,xs:12,sx:{marginTop:"40px"},children:(0,n.jsxs)(eP.Z,{variant:"text",disableElevation:!0,size:"small",sx:e6.btnGroup,disabled:L,children:[(0,n.jsx)(R.Z,{onClick:f,children:"Clear All"}),(0,n.jsx)(R.Z,{onClick:y,children:"Reset"}),(0,n.jsx)(R.Z,{onClick:m,children:"Add"}),(0,n.jsx)(R.Z,{onClick:()=>{F(e=>!e),E(eK.yf.SAVE)},variant:"contained",children:"Save"})]})})]})};let e4={id:-1,signal:-1,province:null,municipalities:[]},ae={MSG:"",TITLE:"",TYPE:"",MODAL_MSG:"",openLoadingModal:!1,saving:!1},aa={[eK.yf.SAVE]:{TITLE:"Save changes",MSG:"Save changes to the wind speed list?",SUCCESS:"Changes saved."},[eK.yf.SAVING]:{TITLE:"Save changes",MSG:"Saving data...",SUCCESS:"Changes saved."},[eK.yf.EDIT]:{TITLE:"Affected Provinces and Municipalities Form",MSG:"",SUCCESS:"Changes saved."}};var at=function(){let{ids:e,entities:a,status:t,municipalities:r}=(0,i.v9)(e=>e.provinces),[o,d]=(0,l.useState)([]),[c,p]=(0,l.useState)(ae),[u,h]=(0,l.useState)([]),[x,g]=(0,l.useState)(e4),[f,y]=(0,l.useState)(eK.yf.VIEW),[S,C]=(0,l.useState)(""),[Z,w]=(0,l.useState)(-1),E=(0,i.I0)(),A=(0,l.useRef)(!1);!function(e){let[a,t]=(0,l.useState)([]),[n,r]=(0,l.useState)([]),[o,d]=(0,l.useState)(""),[c,p]=(0,l.useState)(!1),u=(0,i.I0)(),{ids:h,entities:x,municipalities:g,status:m,error:f}=(0,i.v9)(e=>e.provinces);(0,l.useEffect)(()=>{0===h.length?u((0,s.Q)()):(t(Object.values(x)),r([]))},[u,h.length,x]),(0,l.useEffect)(()=>{""!==f&&d(f)},[f]),(0,l.useEffect)(()=>{p(m===j.G.PENDING)},[m]),(0,l.useEffect)(()=>{},[u,void 0,g])}();let[_,T,P]=(0,ey.ky)(v.M.WEATHER_FORECASTS,"".concat("mimaropa","/").concat(v.M.SUB_SPECIAL_COMMON,"/").concat(v.M.COMMON_SPECIAL_TYPE.WIND_SPEED));(0,l.useEffect)(()=>(A.current=!0,()=>{A.current=!1}),[]);let k=(0,l.useCallback)(()=>{if(!_||!_.data)return;let e=_.data.map(e=>e.value).filter((e,a,t)=>t.indexOf(e)===a).map((e,a)=>({id:a,value:e.toString(),isValid:!0,full:"Wind Signal"})),t=_.data.map((e,t)=>({id:t,signal:e.value,province:Object.values(a).find(a=>a.label===e.province),municipalities:e.municipalities.map((e,a)=>({id:a,label:e}))}));A.current&&(d(t),h(e),C("Updated by ".concat(_.updated_by," on ").concat((0,b.Xn)(_.date_created))))},[_,a]);(0,l.useEffect)(()=>{T||t!==j.G.FULLFILLED||k()},[e,T,t,P,k]);let M=e=>{let a=!1;for(let e=0;e<o.length;e+=1)if(o[e].province.label===x.province.label&&o[e].signal!==x.signal){let t=o[e].municipalities.map(e=>e.label);if(x.municipalities.map(e=>e.label).some(e=>t.indexOf(e)>=0)){a=!0;break}}return a},L=(e,a)=>{if(!A.current)return;let t=[...o];for(let e=0;e<t.length;e+=1)if(t[e].signal===parseInt(a)){for(let a=0;a<t[e].municipalities.length;a+=1)t[e].municipalities[a]=null;t[e].province=null,t[e]=null}d(e=>t.filter(e=>null!==e).map((e,a)=>({...e,id:a})));let n=[...u];n[e]=null,n.splice(e,1),h(e=>n.map((e,a)=>({...e,id:a})))},I=async()=>{if(void 0!==u.find(e=>""===e.value)||void 0!==u.find(e=>!1===e.isValid)){p(e=>({...ae,MSG:"Please check your input",TYPE:eK.J3.INFO,openLoadingModal:!e.openLoadingModal}));return}if(o.filter(e=>0===e.municipalities.length).length>0||o.map(e=>e.signal).filter((e,a,t)=>t.indexOf(e)===a).length!==u.length){p(e=>({...ae,MSG:"Please check your input",TYPE:eK.J3.INFO,openLoadingModal:!e.openLoadingModal}));return}try{p(e=>({...e,MODAL_MSG:"Saving data...",saving:!0}));let e=await (0,m.eg)({type:v.M.SUB_SPECIAL_COMMON,body:{data:o.map(e=>({...e,value:e.signal,province:e.province.label,municipalities:e.municipalities.map(e=>e.label)})),region:"mimaropa",type:v.M.COMMON_SPECIAL_TYPE.WIND_SPEED}});A.current&&(p(e=>({...ae,MSG:"Data successfully saved.",TYPE:eK.J3.SUCCESS,openLoadingModal:!e.openLoadingModal,saving:!1})),C(a=>"Updated by ".concat(e.updated_by," on ").concat((0,b.NK)(e.date_created))))}catch(e){A.current&&p({...ae,MSG:e.message,TYPE:eK.J3.ERROR,openLoadingModal:!1,saving:!1})}};return(0,n.jsx)(e7,{state:u,appstate:f,message:c,windsignalitems:o,updateinfo:S,onConfirmClick:e=>{let a=[...o];if(null===x.province)return;if(M(e)){p(e=>({...ae,MSG:"One or more of your selected municipalities have duplicates.",TYPE:eK.J3.INFO,openLoadingModal:!0})),g(e4);return}let t=o.findIndex(a=>a.signal===parseInt(e)&&a.province.label===x.province.label);if(-1===t){let t={id:o.length,signal:parseInt(e),province:x.province,municipalities:[...x.municipalities]};a.push(t);let n=[{...t,municipalities:t.municipalities}];d(e=>[...e,...n])}else a[t].municipalities=[...x.municipalities],d(e=>a);g(e4)},onCancelClick:()=>{g(e4),p(e=>({...e,openLoadingModal:!1}))},onLocationItemChange:e=>{let{id:a,value:t,signal:n}=e.target;if(null==t){"province"===a&&g(e4);return}if("province"===a){let e=t.label,a=o.filter(a=>a.province.label===e&&a.signal===parseInt(n));1===a.length?g(a[0]):g({...e4,id:o.length,signal:parseInt(n),province:{...t}}),E((0,eY.X4)(r[e]))}"municipalities"===a&&g(e=>({...e,municipalities:t}))},handleInputChange:function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update",{id:t,value:n}=e.target,l=t.split("-")[1],i=[...u];if(i[l]){if("clear"===a)i[l].value="",i[l].isValid=!1;else{if(""!==n&&void 0!==u.find(e=>e.value===n)){i[l].isValid=!1;return}let e={...i[l]};i[l].value=n,n.length>2||isNaN(n)||n>10?i[l].isValid=!1:(i[l].isValid=""!==n,""===n&&L(t,e.value))}A.current&&h(e=>i)}},handleAddClick:()=>{if(5===u.length||!A.current)return;let e=[...u];e.push({id:e.length,value:"",full:"Wind Signal"}),h(e)},handleClearClick:()=>{h([]),d([])},handleDeleteClick:L,handleDeleteProvince:(e,a)=>{let t=[...o];for(let n=0;n<t.length;n+=1)if(t[n].signal===parseInt(e)&&t[n].province.label===a){for(let e=0;e<t[n].municipalities.length;e+=1)t[n].municipalities[e]=null;t[n].province=null,t[n]=null}d(e=>t.filter(e=>null!==e).map((e,a)=>({...e,id:a})))},handleReset:()=>{A.current&&k()},handleSaveClick:I,handleAppState:(e,a)=>{w(e=>null!=a?a:-1),y(a=>e),p(a=>({...a,MSG:"",MODAL_MSG:aa[e].MSG,TITLE:aa[e].TITLE,openLoadingModal:!0}))},currentItem:x})},an=function(e){let{state:a,cycloneLoading:t,onSyncPress:l}=e;return(0,n.jsxs)(d.Z,{sx:{fontSize:"14px"},children:[(0,n.jsx)(X.Z,{openSnackbar:""!==a.error||""!==a.msg,message:""!==a.error?a.error:a.msg,severity:""!==a.error?"error":"success"}),(0,n.jsx)(x.Z,{sx:{marginTop:e=>e.spacing(1)},variant:"h6",children:"Tropical Cyclone Bulletin Updater"}),(0,n.jsxs)(x.Z,{variant:"body2",sx:eG,children:["ACAP's system updates its ",(0,n.jsx)("strong",{children:"Special Weather Advisory"})," information by automatically scanning, extracting, and uploading the latest Tropical Cyclone data from PAGASA's ",(0,n.jsx)("strong",{children:(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/tropical-cyclone/severe-weather-bulletin",target:"_blank",rel:"noreferrer",children:"Tropical Cyclone Bulletin"})})," web page to ACAP's database.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"ACAP's  automatic Special Weather Advisory updates run daily every (2) two hours, starting from midnight PH time, with a lag time of 20 minutes to (1) one and a half hours.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"This panel updates ACAP's ",(0,n.jsx)("strong",{children:"Special Weather Advisory"})," content by manually initiating the  process of syncing PAGASA's latest published tropical cyclone data from their ",(0,n.jsx)("strong",{children:(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/tropical-cyclone/severe-weather-bulletin",target:"_blank",rel:"noreferrer",children:"Tropical Cyclone Bulletin"})})," web page to ACAP."]}),(0,n.jsx)(x.Z,{variant:"body2",sx:eG,children:"Press the SYNC button below to start the data syncing process."}),(0,n.jsx)(e_,{title:"Current Data Update Summary",children:!t&&(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Updated by:"}),"\xa0 ",a.updated_by]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Date synced:"}),"\xa0 ",a.date_updated]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Summary:"}),"\xa0 ",a.summary]})]})}),(0,n.jsx)(y.Z,{variant:"contained",onClick:l,disabled:t||a.loading,children:"Sync"}),(0,n.jsx)("hr",{}),(0,n.jsx)(at,{})]})},al=t(88002),ai=t(9669),as=t.n(ai),ar=t(15426);let ao={SPECIAL_WEATHER_CYCLONE:"".concat("https://acap-mimaropa-server.onrender.com/api","/cyclone")};class ad extends ar.Z{async updateSpecialWeather(e){let a=await this.createRequestObject({body:e});return(await as()({...a,url:ao.SPECIAL_WEATHER_CYCLONE,method:"POST"})).data}}let ac=new ad,ap=ac.updateSpecialWeather.bind(ac),{useEffect:au,useState:ah,useRef:ax}=t(67294),ag={loading:!1,error:"",msg:"",updated_by:"",date_updated:"",summary:""};var am=function(e){let{getDateToString:a}=e,[t,l,i]=(0,ey.ky)(al.K.GLOBAL_COLLECTIONS,al.K.CYCLONE_ADVISORY),[s,r]=ah(ag),o=ax(!1);au(()=>(o.current=!0,()=>{o.current=!1}),[]),au(()=>{!l&&o.current&&(i?r({error:i}):t&&r({loading:!1,error:"",msg:"",updated_by:"system"===t.updated_by?"system":t.email,date_updated:a(t.date_updated),summary:t.summary}))},[l,t,i,a]);let d=async()=>{try{r({...s,loading:!0,error:"",msg:""});let e=await ap({}),a=new Date(1e3*e.date_updated._seconds);e.date_updated="".concat(a.toDateString()," ").concat(a.toLocaleTimeString("it-IT",b.W6)),o.current&&r(a=>({...a,loading:!1,msg:"Successfully synced data.",updated_by:"system"===e.updated_by?"system":e.email,date_updated:e.date_updated,summary:e.summary}))}catch(e){o.current&&r(a=>({...a,loading:!1,error:e.message}))}};return(0,n.jsx)(an,{state:s,cycloneLoading:l,onSyncPress:d})},af=t(47407),ab=t(19304),aj=t(52311),av=t(7638),ay=t(32200),aS=t(76786),aC=t(77745),aZ=t(95639),aw=t(38660),aE=t(98037),aA=function(){let e={message:"",severity:"success"},[a,t]=(0,l.useState)(""),[i,s]=(0,l.useState)(!1),[r,o]=(0,l.useState)(null),[c,p]=(0,l.useState)(""),[u,h]=(0,l.useState)(e),{services:g,loading:m,error:f}=(0,aw.Z)(a,i);(0,l.useEffect)(()=>{s(m||i)},[m,i]);let b=async()=>{if(a)try{s(!0),await (0,aE.Wn)({supportService:a}),h({message:"Successfully added a new support service.",severity:"success"}),t(""),s(!1),setTimeout(()=>h(e),1500)}catch(a){throw h({message:"Something went wrong.",severity:"error"}),s(!1),setTimeout(()=>h(e),1500),Error(a)}},j=(e,a)=>{o(e),p(a.data)},v=async a=>{if(a)try{s(!0),await (0,aE.vo)(a),h({message:"Successfully deleted a support service.",severity:"success"}),t(""),s(!1),setTimeout(()=>h(e),1500)}catch(a){throw h({message:"Something went wrong.",severity:"error"}),s(!1),setTimeout(()=>h(e),1500),Error(a)}},C=async a=>{try{s(!0),await (0,aE.Ef)({data:c,docId:a.docId,date:new Date}),h({message:"Successfully updated a support service.",severity:"success"}),o(null),p(""),s(!1),setTimeout(()=>h(e),1500)}catch(a){throw h({message:"Something went wrong.",severity:"error"}),s(!1),setTimeout(()=>h(e),1500),Error(a)}},w=()=>{o(null),p("")};return(0,n.jsxs)(d.Z,{sx:{"& li":{fontSize:"14px"}},children:[(0,n.jsxs)(x.Z,{sx:{marginTop:e=>e.spacing(1)},variant:"h6",children:["DA RFO ",eT.Tf," Support Services"]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px"},children:[(0,n.jsx)(Z.Z,{style:{width:"75%"},id:"outlined-basic",label:"Add Support Service",variant:"outlined",size:"small",value:a,onChange:e=>{t(e.target.value)},disabled:i}),i?(0,n.jsx)(ew.Z,{size:24,color:"primary"}):(0,n.jsx)(y.Z,{disableElevation:!0,variant:"contained",disabled:!a,onClick:b,children:"ADD"})]}),(0,n.jsx)(S.ZP,{children:m?(0,n.jsx)("p",{children:"Loading data..."}):(0,n.jsx)(n.Fragment,{children:f?(0,n.jsx)("p",{children:"Something went wrong."}):(0,n.jsx)(n.Fragment,{children:g.length?(0,n.jsx)(af.Z,{children:g.map((e,a)=>(0,n.jsx)(ab.ZP,{disablePadding:!0,children:(0,n.jsxs)(aj.Z,{disabled:i,children:[(0,n.jsx)(ay.Z,{primary:r===a?(0,n.jsx)(Z.Z,{value:c,onChange:e=>p(e.target.value),label:"Edit Support Service",variant:"outlined",size:"small",multiline:!0,style:{width:"75%"}}):e.data}),(0,n.jsx)("div",{style:{display:"flex",justifyItems:"center"},children:r===a?(0,n.jsxs)("span",{children:[(0,n.jsx)(av.Z,{children:(0,n.jsx)(aC.Z,{color:"primary",onClick:()=>C(e)})}),(0,n.jsx)(av.Z,{children:(0,n.jsx)(aZ.Z,{color:"primary",onClick:w})})]}):(0,n.jsx)(aS.Z,{color:"primary",onClick:()=>j(a,e)})}),r!==a&&(0,n.jsx)(av.Z,{children:(0,n.jsx)(eu.Z,{color:"primary",disabled:i,onClick:()=>v(e.docId)})})]})},a))}):(0,n.jsx)("p",{children:"No data available."})})})}),(0,n.jsx)(X.Z,{openSnackbar:""!==u.message,message:u.message,severity:u.severity})]})},a_={marginTop:e=>e.spacing(6),border:e=>"1px solid ".concat(e.palette.bacap.border),minHeight:"800px",borderRadius:"8px",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px"},aT=function(){let[e,a]=(0,l.useState)(0);return(0,n.jsxs)("div",{children:[(0,n.jsxs)(h.Z,{sx:{border:"none"},children:[(0,n.jsx)(x.Z,{variant:"h5",children:"Weather Services Updater"}),(0,n.jsxs)("p",{children:["Update the site-wide ",(0,n.jsx)("strong",{children:"ACAP Services"})," weather forecast information for the ",(0,n.jsx)("strong",{children:"Seasonal"}),", ",(0,n.jsx)("strong",{children:"10-Day"})," ","and ",(0,n.jsx)("strong",{children:"Special Weather"})," Forecast sections by providing updated data."]}),(0,n.jsxs)("p",{children:["Please take caution in updating this information because they will be automatically referenced by all site admins when creating crop recommendations bulletins on the"," ",(0,n.jsx)("strong",{children:"Create Crop Bulletins"})," (10-Day and Seasonal) Admin pages. Global data updates made by admins are also viewable on the site's public ",(0,n.jsx)("strong",{children:"ACAP Services"})," page and used as references on the ",(0,n.jsx)("strong",{children:"Crop Recommendations"})," page."]})]}),(0,n.jsxs)(d.Z,{sx:a_,children:[(0,n.jsxs)(p.Z,{value:e,onChange:(e,t)=>{a(t)},"aria-label":"weather services updater",children:[(0,n.jsx)(c.Z,{label:"Seasonal",...(0,u.P)(0)}),(0,n.jsx)(c.Z,{label:"10-Day",...(0,u.P)(1)}),(0,n.jsx)(c.Z,{label:"Tropical Cyclone",...(0,u.P)(2)}),(0,n.jsx)(c.Z,{label:"Support Services",...(0,u.P)(3)})]}),(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(u.x,{value:e,index:0,children:(0,n.jsx)(ev,{})}),(0,n.jsx)(u.x,{value:e,index:1,children:(0,n.jsx)(eH,{getDateToString:b.Xn})}),(0,n.jsx)(u.x,{value:e,index:2,children:(0,n.jsx)(am,{getDateToString:b.Xn})}),(0,n.jsx)(u.x,{value:e,index:3,children:(0,n.jsx)(aA,{})})]})]})]})};class aP extends l.Component{static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,a){console.error("Weather Page Error:",e,a),this.setState({error:e,errorInfo:a})}render(){return this.state.hasError?(0,n.jsxs)(d.Z,{sx:{padding:4},children:[(0,n.jsx)(x.Z,{variant:"h5",color:"error",gutterBottom:!0,children:"Something went wrong loading the Weather Services page"}),(0,n.jsx)(x.Z,{variant:"body1",paragraph:!0,children:this.state.error&&this.state.error.toString()}),(0,n.jsx)(y.Z,{variant:"contained",onClick:()=>window.location.reload(),children:"Reload Page"}),!1]}):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}}var ak=(0,r.Z)(function(e){let a=(0,i.I0)(),t=(0,i.v9)(e=>e.provinces.ids);return(0,l.useEffect)(()=>{0===t.length&&a((0,s.Q)()).catch(e=>{console.error("Error fetching provinces:",e)})},[a,t]),(0,n.jsx)(o.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,accLevel:eT.DW.ADMIN,children:(0,n.jsx)(aP,{children:(0,n.jsx)(aT,{})})})})}},function(e){e.O(0,[3153,6856,190,8583,1664,6541,955,4073,6455,5837,6080,4723,760,3338,3353,9227,6980,752,8591,2233,9503,2888,9774,179],function(){return e(e.s=29926)}),_N_E=e.O()}]);