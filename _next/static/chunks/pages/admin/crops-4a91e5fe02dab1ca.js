(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7794,7595],{67142:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/crops",function(){return t(83935)}])},60762:function(e,a,t){"use strict";t.d(a,{Z:function(){return Z}});var n=t(87462),r=t(63366),l=t(67294),o=t(90512),i=t(94780),s=t(77527),d=t(44001),c=t(93454),u=t(1588),h=t(34867);function p(e){return(0,h.ZP)("MuiCard",e)}(0,u.Z)("MuiCard",["root"]);var b=t(85893);let C=["className","raised"],f=e=>{let{classes:a}=e;return(0,i.Z)({root:["root"]},p,a)},m=(0,s.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,a)=>a.root})(()=>({overflow:"hidden"}));var Z=l.forwardRef(function(e,a){let t=(0,d.i)({props:e,name:"MuiCard"}),{className:l,raised:i=!1}=t,s=(0,r.Z)(t,C),c=(0,n.Z)({},t,{raised:i}),u=f(c);return(0,b.jsx)(m,(0,n.Z)({className:(0,o.Z)(u.root,l),elevation:i?8:void 0,ref:a,ownerState:c},s))})},71919:function(e,a,t){"use strict";t.d(a,{Z:function(){return m}});var n=t(87462),r=t(63366),l=t(67294),o=t(90512),i=t(94780),s=t(77527),d=t(44001),c=t(1588),u=t(34867);function h(e){return(0,u.ZP)("MuiCardContent",e)}(0,c.Z)("MuiCardContent",["root"]);var p=t(85893);let b=["className","component"],C=e=>{let{classes:a}=e;return(0,i.Z)({root:["root"]},h,a)},f=(0,s.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,a)=>a.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}}));var m=l.forwardRef(function(e,a){let t=(0,d.i)({props:e,name:"MuiCardContent"}),{className:l,component:i="div"}=t,s=(0,r.Z)(t,b),c=(0,n.Z)({},t,{component:i}),u=C(c);return(0,p.jsx)(f,(0,n.Z)({as:i,className:(0,o.Z)(u.root,l),ownerState:c,ref:a},s))})},87486:function(e,a,t){"use strict";t.d(a,{Z:function(){return w}});var n=t(63366),r=t(87462),l=t(67294),o=t(90512),i=t(94780),s=t(66643),d=t(77527),c=t(83008),u=t(85206),h=t(57280),p=t(3153),b=t(1588),C=t(34867);function f(e){return(0,C.ZP)("PrivateSwitchBase",e)}(0,b.Z)("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);var m=t(85893);let Z=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],x=e=>{let{classes:a,checked:t,disabled:n,edge:r}=e,l={root:["root",t&&"checked",n&&"disabled",r&&"edge".concat((0,s.Z)(r))],input:["input"]};return(0,i.Z)(l,f,a)},g=(0,d.ZP)(p.Z,{name:"MuiSwitchBase"})(e=>{let{ownerState:a}=e;return(0,r.Z)({padding:9,borderRadius:"50%"},"start"===a.edge&&{marginLeft:"small"===a.size?-3:-12},"end"===a.edge&&{marginRight:"small"===a.size?-3:-12})}),v=(0,d.ZP)("input",{name:"MuiSwitchBase",shouldForwardProp:c.Z})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1});var w=l.forwardRef(function(e,a){let{autoFocus:t,checked:l,checkedIcon:i,className:s,defaultChecked:d,disabled:c,disableFocusRipple:p=!1,edge:b=!1,icon:C,id:f,inputProps:w,inputRef:y,name:j,onBlur:k,onChange:S,onFocus:P,readOnly:N,required:A=!1,tabIndex:R,type:M,value:D}=e,E=(0,n.Z)(e,Z),[F,O]=(0,u.Z)({controlled:l,default:!!d,name:"SwitchBase",state:"checked"}),T=(0,h.Z)(),_=c;T&&void 0===_&&(_=T.disabled);let z="checkbox"===M||"radio"===M,B=(0,r.Z)({},e,{checked:F,disabled:_,disableFocusRipple:p,edge:b}),L=x(B);return(0,m.jsxs)(g,(0,r.Z)({component:"span",className:(0,o.Z)(L.root,s),centerRipple:!0,focusRipple:!p,disabled:_,tabIndex:null,role:void 0,onFocus:e=>{P&&P(e),T&&T.onFocus&&T.onFocus(e)},onBlur:e=>{k&&k(e),T&&T.onBlur&&T.onBlur(e)},ownerState:B,ref:a},E,{children:[(0,m.jsx)(v,(0,r.Z)({autoFocus:t,checked:l,defaultChecked:d,className:L.input,disabled:_,id:z?f:void 0,name:j,onChange:e=>{if(e.nativeEvent.defaultPrevented)return;let a=e.target.checked;O(a),S&&S(e,a)},readOnly:N,ref:y,required:A,ownerState:B,tabIndex:R,type:M},"checkbox"===M&&void 0===D?{}:{value:D},w)),F?i:C]}))})},12193:function(e,a,t){"use strict";t(67294);var n=t(13077),r=t(85893);a.Z=(0,n.Z)((0,r.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},83935:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return O}});var n=t(85893),r=t(65328),l=t(45773),o=t(67294),i=t(60990),s=t(96788),d=t(51015),c=t(44723),u=t(60762),h=t(71919),p=t(97182),b=t(25026),C=t(93454),f=t(76592),m=t(70360),Z=t(46577),x=t(8863),g=t(19827),v=t(13539),w=t(52857),y=t(33453),j=t(92365),k=t(40110),S=t(26541),P=t(96727),N=t(13077),A=(0,N.Z)((0,n.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),R=(0,N.Z)((0,n.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit"),M=(0,N.Z)((0,n.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),D=t(77595),E=function(){let[e,a]=(0,o.useState)([]),[t,r]=(0,o.useState)(!0),[l,N]=(0,o.useState)(""),[E,F]=(0,o.useState)(""),[O,T]=(0,o.useState)(!1),[_,z]=(0,o.useState)(null),[B,L]=(0,o.useState)({name:"",label:"",enabled:!0});(0,o.useEffect)(()=>{I()},[]);let I=async()=>{try{r(!0);let e=await (0,D.Rd)();a(e),N("")}catch(e){N("Failed to load crops: "+e.message)}finally{r(!1)}},q=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(z(e),L({name:e.name,label:e.label,enabled:e.enabled})):(z(null),L({name:"",label:"",enabled:!0})),T(!0)},H=()=>{T(!1),z(null),L({name:"",label:"",enabled:!0})},V=async()=>{try{if(N(""),F(""),!B.name||!B.label){N("Name and Label are required");return}_?(await (0,D.Ak)(_.id,B),F("Crop updated successfully")):(await (0,D.e)(B),F("Crop added successfully")),await I(),H()}catch(e){N("Failed to save crop: "+e.message)}},W=async e=>{try{N(""),await (0,D.Ak)(e.id,{enabled:!e.enabled}),await I(),F("Crop ".concat(e.enabled?"disabled":"enabled"," successfully"))}catch(e){N("Failed to update crop: "+e.message)}},U=async e=>{if(confirm('Are you sure you want to disable "'.concat(e.label,'"?')))try{N(""),await (0,D.aD)(e.id),await I(),F("Crop disabled successfully")}catch(e){N("Failed to delete crop: "+e.message)}};return(0,n.jsxs)(i.Z,{sx:{p:3},children:[(0,n.jsxs)(i.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,n.jsx)(s.Z,{variant:"h4",children:"Crops Management"}),(0,n.jsx)(d.Z,{variant:"contained",color:"primary",startIcon:(0,n.jsx)(A,{}),onClick:()=>q(),children:"Add New Crop"})]}),l&&(0,n.jsx)(c.Z,{severity:"error",sx:{mb:2},onClose:()=>N(""),children:l}),E&&(0,n.jsx)(c.Z,{severity:"success",sx:{mb:2},onClose:()=>F(""),children:E}),(0,n.jsx)(u.Z,{children:(0,n.jsxs)(h.Z,{children:[(0,n.jsx)(s.Z,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Manage crops available in the system. Only enabled crops will appear in dropdowns throughout the application."}),t?(0,n.jsx)(i.Z,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,n.jsx)(p.Z,{})}):(0,n.jsx)(b.Z,{component:C.Z,children:(0,n.jsxs)(f.Z,{children:[(0,n.jsx)(m.Z,{children:(0,n.jsxs)(Z.Z,{children:[(0,n.jsx)(x.Z,{children:"Name"}),(0,n.jsx)(x.Z,{children:"Label"}),(0,n.jsx)(x.Z,{children:"Status"}),(0,n.jsx)(x.Z,{align:"right",children:"Actions"})]})}),(0,n.jsx)(g.Z,{children:e.map(e=>(0,n.jsxs)(Z.Z,{children:[(0,n.jsx)(x.Z,{children:e.name}),(0,n.jsx)(x.Z,{children:e.label}),(0,n.jsxs)(x.Z,{children:[(0,n.jsx)(v.Z,{checked:e.enabled,onChange:()=>W(e),color:"primary"}),e.enabled?"Enabled":"Disabled"]}),(0,n.jsxs)(x.Z,{align:"right",children:[(0,n.jsx)(w.Z,{color:"primary",onClick:()=>q(e),size:"small",children:(0,n.jsx)(R,{})}),(0,n.jsx)(w.Z,{color:"error",onClick:()=>U(e),size:"small",children:(0,n.jsx)(M,{})})]})]},e.id))})]})})]})}),(0,n.jsxs)(y.Z,{open:O,onClose:H,maxWidth:"sm",fullWidth:!0,children:[(0,n.jsx)(j.Z,{children:_?"Edit Crop":"Add New Crop"}),(0,n.jsx)(k.Z,{children:(0,n.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,n.jsx)(S.Z,{label:"Crop Name",value:B.name,onChange:e=>L({...B,name:e.target.value}),disabled:!!_,required:!0,helperText:"Unique identifier (e.g., Rice, Corn)"}),(0,n.jsx)(S.Z,{label:"Display Label",value:B.label,onChange:e=>L({...B,label:e.target.value}),required:!0,helperText:"Human-readable label shown in dropdowns"}),(0,n.jsxs)(i.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(v.Z,{checked:B.enabled,onChange:e=>L({...B,enabled:e.target.checked}),color:"primary"}),(0,n.jsx)(s.Z,{children:"Enabled"})]})]})}),(0,n.jsxs)(P.Z,{children:[(0,n.jsx)(d.Z,{onClick:H,children:"Cancel"}),(0,n.jsx)(d.Z,{onClick:V,variant:"contained",color:"primary",children:_?"Update":"Add"})]})]})]})},F=t(98813),O=(0,r.Z)(function(e){let{loading:a,user:t,onBtnLogoutClick:r}=e;return(0,n.jsx)(l.Z,{loading:a,user:t,onBtnLogoutClick:r,accLevel:F.DW.ADMIN,children:(0,n.jsx)(E,{})})})},77595:function(e,a,t){"use strict";t.d(a,{e:function(){return d},aD:function(){return u},Rd:function(){return s},getCrops:function(){return i},Ak:function(){return c}});var n=t(96171);let r={CONSTANTS:"constants",CROPS:"crops"};class l extends n.Z{async getCrops(){try{let e=await this.getDocumentData(r.CONSTANTS,r.CROPS);if(null==e?void 0:e.crops)return e.crops.filter(e=>!1!==e.enabled);return this.getDefaultCrops()}catch(e){return console.error("Error fetching crops:",e),this.getDefaultCrops()}}async getAllCrops(){try{let e=await this.getDocumentData(r.CONSTANTS,r.CROPS);if(null==e?void 0:e.crops)return e.crops;return this.getDefaultCrops()}catch(e){return console.error("Error fetching all crops:",e),this.getDefaultCrops()}}async updateCrops(e){try{let a=this.doc(this.db,r.CONSTANTS,r.CROPS);await this.updateDoc(a,{crops:e})}catch(e){throw console.error("Error updating crops:",e),e}}async addCrop(e){try{let a=await this.getAllCrops(),t={id:e.name,name:e.name,label:e.label||e.name,enabled:!1!==e.enabled};a.push(t),await this.updateCrops(a)}catch(e){throw console.error("Error adding crop:",e),e}}async updateCrop(e,a){try{let t=await this.getAllCrops(),n=t.findIndex(a=>a.id===e);-1!==n&&(t[n]={...t[n],...a},await this.updateCrops(t))}catch(e){throw console.error("Error updating crop:",e),e}}async deleteCrop(e){try{let a=(await this.getAllCrops()).filter(a=>a.id!==e);await this.updateCrops(a)}catch(e){throw console.error("Error deleting crop:",e),e}}getDefaultCrops(){return[{id:"Rice",name:"Rice",label:"Rice",enabled:!0},{id:"Corn",name:"Corn",label:"Corn",enabled:!0},{id:"Pili",name:"Pili",label:"Pili",enabled:!1},{id:"Ampalaya",name:"Ampalaya",label:"Ampalaya",enabled:!1},{id:"PoleSitao",name:"PoleSitao",label:"Pole Sitao",enabled:!1},{id:"Cassava",name:"Cassava",label:"Cassava",enabled:!1},{id:"Coconut",name:"Coconut",label:"Coconut",enabled:!1},{id:"Pineapple",name:"Pineapple",label:"Pineapple",enabled:!1},{id:"Abaca",name:"Abaca",label:"Abaca",enabled:!1},{id:"Cut-flowers",name:"Cut-flowers",label:"Cut Flowers",enabled:!1},{id:"Livestock",name:"Livestock",label:"Livestock",enabled:!1},{id:"Poultry",name:"Poultry",label:"Poultry",enabled:!1},{id:"Fisheries",name:"Fisheries (brackish and freshwater)",label:"Fisheries (brackish and freshwater)",enabled:!1}]}}let o=new l,i=()=>o.getCrops(),s=()=>o.getAllCrops(),d=e=>o.addCrop(e),c=(e,a)=>o.updateCrop(e,a),u=e=>o.deleteCrop(e)}},function(e){e.O(0,[3153,6856,190,8583,1664,6541,955,4073,6455,6080,4723,20,9227,8591,2888,9774,179],function(){return e(e.s=67142)}),_N_E=e.O()}]);