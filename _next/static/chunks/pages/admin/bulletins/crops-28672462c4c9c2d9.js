(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{45039:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops",function(){return n(46424)}])},16729:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var i=n(85893),s=n(67294),r=n(45697),l=n.n(r),o=n(51015),a=n(2782),c=n(97182),d=n(33453),u=n(96727),p=n(92365),h=n(40110),x=n(52857),f={button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",height:{xs:"40px",sm:"48px"},"& .text":{display:{xs:"block",sm:"none"}},"& .shortText":{display:{xs:"inline-block",sm:"none"},fontSize:"24px"}},icon:{display:{xs:"block",sm:"none"}},dialogContent:{"& .error":{fontSize:"12px",color:"red"}},dialogActions:{"& button":{minWidth:"100px"}},closeButton:{position:"absolute",right:"8px",top:"8px",color:e=>e.palette.grey[500]}};function m(e){let[t,n]=s.useState({open:null}),{loading:r=!1,isOpen:l=!1,showButtons:m=!0,maxWidth:v="sm",IconSVG:b=null,modalButtonStyles:g={},modalExtraHandlerCB:y=null,modalCancelHandlerCB:j=null,modalConfirmHandlerCB:Z=null,modalOpenHandlerCB:C=null,isDisabled:S=!1}=e,{openButtonText:w="Click",title:H="Window Title",extraBtnText:T="",cancelBtnText:z="Cancel",confirmBtnText:B="Ok",contentText:k="",error:D="",colorTheme:E="primary"}=e;(0,s.useEffect)(()=>{n(e=>({...e,open:l}))},[l]);let _=()=>{n({...t,open:!1}),j&&j()};return(0,i.jsxs)("div",{children:[w&&(0,i.jsxs)(o.Z,{disabled:S,disableElevation:!0,variant:"contained",color:E,onClick:()=>{n({...t,open:!0}),C&&C()},sx:{...f.button,...g},children:[b&&(0,i.jsx)(b,{sx:f.icon}),w]}),(0,i.jsxs)(d.Z,{maxWidth:v,fullWidth:!0,open:t.open||!1,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,i.jsxs)(p.Z,{children:[(0,i.jsx)("span",{children:H}),(0,i.jsx)(x.Z,{"aria-label":"close",sx:f.closeButton,onClick:_,disabled:r,children:(0,i.jsx)(a.Z,{})})]}),(0,i.jsxs)(h.Z,{sx:f.dialogContent,children:[""!==k&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:k}),(0,i.jsx)("div",{className:"error",children:D})]}),e.children]}),m&&(0,i.jsxs)(u.Z,{sx:f.dialogActions,children:[""!==T&&(0,i.jsx)(o.Z,{onClick:y||_,disabled:r,children:T}),(0,i.jsx)(o.Z,{onClick:j||_,disabled:r,children:z}),(0,i.jsxs)(o.Z,{variant:"contained",disabled:r,onClick:Z||_,children:[(0,i.jsx)("span",{style:{display:r?"none":"block"},children:B}),(0,i.jsx)(c.Z,{size:24,color:"secondary",sx:{display:r?"block":"none"}})]})]})]})]})}m.propTypes={loading:l().bool,isOpen:l().bool,showButtons:l().bool,maxWidth:l().string,IconSVG:l().elementType,modalButtonStyles:l().object,modalCancelHandlerCB:l().func,modalConfirmHandlerCB:l().func,modalOpenHandlerCB:l().func,modalExtraHandlerCB:l().func,openButtonText:l().string,cancelBtnText:l().string,confirmBtnText:l().string,extraBtnText:l().string,title:l().string,contentText:l().string,children:l().node,error:l().string,isDisabled:l().bool,colorTheme:l().string};var v=m},7520:function(e,t,n){"use strict";var i=n(85893),s=n(93454);let r=(0,n(77527).ZP)(e=>(0,i.jsx)(s.Z,{...e}))(e=>{let{theme:t}=e;return{padding:t.spacing(3),borderRadius:t.spacing(1),backgroundColor:"#fff",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",border:"1px solid ".concat(t.palette.bacap.border)}});t.Z=r},17553:function(e,t,n){"use strict";var i=n(85893),s=n(67294),r=n(45697),l=n.n(r),o=n(70760),a=n(44723);let c=s.forwardRef(function(e,t){return(0,i.jsx)(a.Z,{elevation:6,ref:t,variant:"filled",...e})});function d(e){let{openSnackbar:t,message:n,severity:r="info",closeHandlerCB:l=()=>{}}=e,[a,d]=(0,s.useState)(t);(0,s.useEffect)(()=>{d(t)},[t]);let u=()=>{d(!1),l()},p=function(e){if(null==e)return"";if("string"==typeof e)return e;if(e instanceof Error)return e.message||e.toString();if("object"==typeof e&&"string"==typeof e.message)return e.message;try{return JSON.stringify(e)}catch(t){return String(e)}}(n);return(0,i.jsx)(o.Z,{open:a,autoHideDuration:3e3,onClose:u,children:(0,i.jsx)(c,{onClose:u,severity:r,sx:{width:"100%"},children:p})})}d.propTypes={openSnackbar:l().bool,message:l().any,severity:l().string,closeHandlerCB:l().func},t.Z=d},93428:function(e,t,n){"use strict";var i=n(64836);t.Z=void 0;var s=i(n(33651)),r=n(85893);t.Z=(0,s.default)([(0,r.jsx)("path",{d:"M5 5v14h14V5zm9 12H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z",opacity:".3"},"0"),(0,r.jsx)("path",{d:"M7 15h7v2H7zm0-4h10v2H7zm0-4h10v2H7zm12-4h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-.14 0-.27.01-.4.04-.39.08-.74.28-1.01.55-.18.18-.33.4-.43.64S3 4.72 3 5v14c0 .27.06.54.16.78s.25.45.43.64c.27.27.62.47 1.01.55.13.02.26.03.4.03h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7-.25c.41 0 .75.34.75.75s-.34.75-.75.75-.75-.34-.75-.75.34-.75.75-.75M19 19H5V5h14z"},"1")],"AssignmentTwoTone")},22209:function(e,t,n){"use strict";var i=n(64836);t.Z=void 0;var s=i(n(33651)),r=n(85893);t.Z=(0,s.default)((0,r.jsx)("path",{d:"M14.5 2.5c0 1.5-1.5 6-1.5 6h-2S9.5 4 9.5 2.5C9.5 1.12 10.62 0 12 0s2.5 1.12 2.5 2.5M12 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m4.08-4.89c.18-.75.33-1.47.39-2.06C19.75 4.69 22 8.08 22 12c0 5.52-4.48 10-10 10S2 17.52 2 12c0-3.92 2.25-7.31 5.53-8.95.07.59.21 1.32.39 2.06C5.58 6.51 4 9.07 4 12c0 4.42 3.58 8 8 8s8-3.58 8-8c0-2.93-1.58-5.49-3.92-6.89M18 12c0 3.31-2.69 6-6 6s-6-2.69-6-6c0-2 .98-3.77 2.48-4.86.23.81.65 2.07.65 2.07C8.43 9.93 8 10.92 8 12c0 2.21 1.79 4 4 4s4-1.79 4-4c0-1.08-.43-2.07-1.13-2.79 0 0 .41-1.22.65-2.07C17.02 8.23 18 10 18 12"}),"CrisisAlert")},71687:function(e,t,n){"use strict";var i=n(64836);t.Z=void 0;var s=i(n(33651)),r=n(85893);t.Z=(0,s.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever")},28817:function(e,t,n){"use strict";var i=n(64836);t.Z=void 0;var s=i(n(33651)),r=n(85893);t.Z=(0,s.default)([(0,r.jsx)("path",{d:"M13 4H6v16h12V9h-5zm3 14H8v-2h8zm0-6v2H8v-2z",opacity:".3"},"0"),(0,r.jsx)("path",{d:"M8 16h8v2H8zm0-4h8v2H8zm6-10H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5z"},"1")],"DescriptionTwoTone")},46424:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return G}});var i=n(85893),s=n(67294),r=n(9473),l=n(65328),o=n(11163),a=n(60990),c=n(51015),d=n(41664),u=n.n(d),p=n(68573),h=n(96788),x=n(77527),f=n(41796);let m=(0,x.ZP)(e=>(0,i.jsx)(p.ZP,{...e}))(e=>{let{theme:t}=e;return{textAlign:"center",cursor:"pointer",borderRadius:t.spacing(1),padding:t.spacing(2),"& a":{color:"rgba(0, 0, 0, 0.87)",textDecoration:"none"},"& a:visited":{color:"rgba(0, 0, 0, 0.87)"},"& h6":{lineHeight:t.spacing(3)},"& svg":{color:t.palette.secondary.main},"&:hover, &:focus":{backgroundColor:(0,f.Fq)(t.palette.secondary.light,.3)}}});var v=n(16729),b=n(93428),g=n(28817),y=n(22209),j=function(){return(0,i.jsx)("div",{children:(0,i.jsx)(v.Z,{maxWidth:"sm",openButtonText:"Generate Bulletin",title:"Select a Crop Bulletin Type",showButtons:!1,colorTheme:"secondary",children:(0,i.jsxs)(p.ZP,{container:!0,children:[(0,i.jsx)(m,{item:!0,xs:12,sm:4,children:(0,i.jsx)(u(),{href:"/admin/bulletins/crops/seasonal/create",passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)("a",{children:[(0,i.jsx)(b.Z,{sx:{fontSize:"90px"}}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"Seasonal Climate"}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"Outlook and Advisory"})]})})}),(0,i.jsx)(m,{item:!0,xs:12,sm:4,children:(0,i.jsx)(u(),{href:"/admin/bulletins/crops/tenday/create",passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)("a",{children:[(0,i.jsx)(g.Z,{sx:{fontSize:"90px"}}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"10-Day Farm Weather Outlook"}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"and Advisory"})]})})}),(0,i.jsx)(m,{item:!0,xs:12,sm:4,children:(0,i.jsx)(u(),{href:"/admin/bulletins/crops/tenday/batch",passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)("a",{children:[(0,i.jsx)(g.Z,{sx:{fontSize:"90px"}}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"10-Day Batch Generate"}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"All Municipalities"})]})})}),(0,i.jsx)(m,{item:!0,xs:12,sm:4,children:(0,i.jsx)(u(),{href:"/admin/bulletins/crops/special/create",passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)("a",{children:[(0,i.jsx)(y.Z,{sx:{fontSize:"90px"}}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"Special Weather Advisory"})]})})})]})})})},Z=n(6897),C=n(94143),S=n(15972),w=n(7520),H=n(29346),T=n(17553),z=n(84325),B=n(71687),k=n(42176),D=n(6132),E=n(50853),_=n(64740),N=n(25517);function M(e){let{onDeleteSelected:t,selectedCount:n,disableDelete:s}=e;return(0,i.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,i.jsxs)(k.D,{...e,children:[(0,i.jsx)(D.S,{}),(0,i.jsx)(E.M,{})]}),(0,i.jsxs)(c.Z,{variant:"contained",color:"error",size:"small",startIcon:(0,i.jsx)(B.Z,{}),disabled:s,onClick:t,children:["Delete Selected (",n,")"]})]})}var I=function(e){let{rows:t,columns:n,message:l,resetMessage:c,handleTypeChange:d,onSelectionChange:u,selectedCount:p,onDeleteSelected:x,selectionModel:f}=e,[m,v]=(0,s.useState)(z.Ry.SEASONAL),b=(0,r.v9)(e=>e.reports.status),g=(0,r.v9)(e=>e.dashboard.reportType),y=(0,o.useRouter)();return(0,s.useEffect)(()=>{v(g)},[g]),(0,i.jsxs)("div",{children:[(0,i.jsx)(T.Z,{openSnackbar:""!==l,message:l,severity:"info",closeHandlerCB:c}),(0,i.jsx)(h.Z,{variant:"h5",children:"Generate Bulletin"}),(0,i.jsxs)("p",{children:["Create and preview ",(0,i.jsx)("strong",{children:"10-Day"})," and ",(0,i.jsx)("strong",{children:"Seasonal"})," crop bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]}),(0,i.jsxs)(w.Z,{sx:{display:"flex",flexDirection:{sm:"column",md:"row"},justifyContent:"space-between",alignItems:"center",padding:"8px 16px 8px 24px"},children:[(0,i.jsx)(j,{}),(0,i.jsxs)(Z.Z,{sx:{m:1,width:{xs:"100%",sm:"100%",md:300}},size:"small",children:[(0,i.jsx)(C.Z,{id:"report-type",children:"Bulletin Type"}),(0,i.jsxs)(H.Z,{labelId:"report-type",id:"report-type",value:m,label:"Bulletin Type",onChange:d,children:[(0,i.jsx)(S.Z,{value:z.Ry.SEASONAL,children:"Seasonal Crop Recommendations"}),(0,i.jsx)(S.Z,{value:z.Ry.TEN_DAY,children:"10-Day Crop Recommendations"}),(0,i.jsx)(S.Z,{value:z.Ry.SPECIAL_WEATHER,children:"Special Weather Recommendations"})]})]})]}),(0,i.jsx)(a.Z,{style:{height:678,width:"100%",textAlign:"left"},children:(0,i.jsx)(w.Z,{sx:{height:"inherit",marginTop:"16px"},children:(0,i.jsx)(_._,{rows:t,columns:n,disableDensitySelector:!0,checkboxSelection:!0,disableSelectionOnClick:!0,pageSize:10,rowsPerPageOptions:[10],components:{Toolbar:M},componentsProps:{toolbar:{onDeleteSelected:x,selectedCount:p,disableDelete:0===p||b===N.G.PENDING}},loading:b===N.G.PENDING,rowHeight:48,selectionModel:f,onSelectionModelChange:e=>u(e),initialState:{columns:{columnVisibilityModel:{rowId:!1}}},onRowClick:e=>{b!==N.G.PENDING&&y.push({pathname:"/admin/bulletins/crops/report/view",query:{docId:e.row.docId}})}})})})]})},R=n(45773),A=n(75941),L=n(46560),P=n(98813),G=(0,l.Z)(function(e){let[t,n]=(0,s.useState)([]),[l,o]=(0,s.useState)([]),[a,c]=(0,s.useState)(""),[d,u]=(0,s.useState)([]),p=(0,r.v9)(e=>e.dashboard.reportType),h=(0,s.useRef)(!1),x=(0,s.useRef)(!1),f=(0,r.I0)(),{ids:m,entities:v,status:b}=(0,r.v9)(e=>e.reports);(0,s.useEffect)(()=>(h.current=!0,()=>{h.current=!1}),[]),(0,s.useEffect)(()=>{null===e.user||e.loading||0!==m.length||x.current||(x.current=!0,f((0,A.RC)({uid:e.user.uid,type:p})))},[e.user,e.loading,m,p,f]),(0,s.useEffect)(()=>{if([N.G.FULLFILLED,N.G.IDLE].includes(b)&&m.length>0){let e={crop:"Crop",province:"Province",municipality:"Municipality",type:"Bulletin Type",updated_by:"Updated by",date_created:"Date Created"},t={province:180,municipality:180,type:110,date_created:200},i=[];["crop","province","municipality","type","updated_by","date_created"].forEach(n=>{i.push({field:n,headerName:e[n],minWidth:t[n],flex:void 0===t[n]?1:0,editable:!1,sortable:!1,disableColumnMenu:!0})});let s=m.map((e,t)=>({id:t,docId:v[e].id,crop:v[e].crop,province:v[e].province,municipality:v[e].municipality,type:v[e].type,updated_by:v[e].updated_by,date_created:v[e].date_created}));h.current&&(n(s),o(i))}},[b,m,v]);let g=async()=>{if(0===d.length)return;let n=t.filter(e=>d.includes(e.id)).map(e=>e.docId);0!==n.length&&window.confirm("Delete ".concat(n.length," report(s) and related bulletins? This cannot be undone."))&&f((0,A.bb)(n)).unwrap().then(t=>{var n;c("Deleted ".concat((null===(n=t.deleted)||void 0===n?void 0:n.length)||0," report(s).")),u([]),f((0,A.RC)({uid:e.user.uid,type:p}))}).catch(e=>{c((null==e?void 0:e.message)||"Failed to delete reports.")})};return(0,i.jsx)(R.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,accLevel:P.DW.ADMIN,children:(0,i.jsx)(I,{rows:t,columns:l,loadingReports:b===N.G.PENDING,message:a,resetMessage:()=>c(""),handleTypeChange:t=>{let{value:n}=t.target;f((0,A.RC)({uid:e.user.uid,type:n})).unwrap().then(e=>{e.length>0&&f((0,L.uq)(n))}).catch(()=>{c("No ".concat(n," reports are available."))})},onSelectionChange:e=>{u(e)},selectedCount:d.length,onDeleteSelected:g,selectionModel:d})})})}},function(e){e.O(0,[3153,7023,3745,1664,6541,8848,6294,1626,9998,5837,4723,837,3539,4740,2163,8591,2888,9774,179],function(){return e(e.s=45039)}),_N_E=e.O()}]);