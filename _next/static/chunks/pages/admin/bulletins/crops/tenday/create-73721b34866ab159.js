(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5507],{51816:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/tenday/create",function(){return l(33085)}])},33085:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return eo}});var i=l(85893),n=l(67294),a=l(9473),s=l(11163),o=l(45697),r=l.n(o),c=l(41664),d=l.n(c),u=l(55292),p=l(25837),m=l(51015),g=l(49986),h=l(60990),f=l(68573),v=l(52857),y=l(26541),b=l(96788),x=l(2052),_=l(16729),j=l(57951),Z=l(97182),S=l(81873),w=l(56912),E=l(28907),k=l(88607),O=l(46560),C=l(25517),D=l(29455),T=l(6506),P=l(70165);function I(e){let{options:t,smstext:l,sel_options:s,optsactivities:o,recommendationsData:r,loading:c}=e,{handleSave:u,handlePreview:p,show:v=!0,isCreateDisabled:y=!1}=e,x=(0,a.I0)(),{filtered_recommendations:_,recommendations:j}=(0,a.v9)(e=>e.recommendations),{group:I}=(0,T.Z)(null!=r?r:j,o),{error:R,status:B}=(0,a.v9)(e=>e.reports),F=(0,a.v9)(e=>e.dashboard.isEnglish),[N,L]=(0,n.useState)(0),[M,z]=(0,n.useState)(!1);function W(e){let{children:t,value:l,index:n,...a}=e;return(0,i.jsx)("div",{role:"tabpanel",hidden:l!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n),...a,children:l===n&&(0,i.jsx)(h.Z,{sx:{p:3,whiteSpace:e.smsstyle},children:t})})}function A(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}return(0,n.useEffect)(()=>{z(t.loading||B===C.G.PENDING)},[t.loading,B]),(0,i.jsxs)(f.ZP,{container:!0,sx:P.Z.container,gap:3,style:{marginTop:"24px",padding:c?"16px":"24px"},children:[null!==_&&v&&(0,i.jsx)(h.Z,{children:(0,i.jsxs)(h.Z,{sx:{width:"100%",marginTop:{xs:"85px",lg:"0px"}},children:[(0,i.jsx)(h.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,i.jsxs)(k.Z,{value:N,onChange:(e,t)=>{L(t)},"aria-label":"basic tabs example",children:[(0,i.jsx)(E.Z,{label:"PDF FORM",...A(0)}),(0,i.jsx)(E.Z,{label:"SMS FORM",...A(1)})]})}),(0,i.jsxs)(W,{value:N,index:0,smsstyle:"normal",children:[(0,i.jsxs)(h.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,i.jsx)(b.Z,{variant:"h4",children:"Impact Outlooks"}),(0,i.jsx)(S.Z,{size:"medium",variant:"outlined",label:F?"Tagalog":"English",onClick:()=>x((0,O.cX)()),sx:{width:"90px"}})]}),(0,i.jsx)(h.Z,{sx:P.Z.recSeasonal,children:(0,i.jsx)(D.Z,{impactOutlookOnly:!0,isShowImpactOutlookSubtitle:!1,recommendations:I,impactOutlookEng:"impact",impactOutlookTag:"impact_tagalog",title:s.sel_crop,isTagalog:!F,isShowTitle:!1})}),(0,i.jsx)("hr",{}),(0,i.jsx)(b.Z,{variant:"h4",sx:{marginTop:"32px"},children:"Recommendations"}),Object.keys(_).map(e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.Z,{variant:"h5",sx:P.Z.recSeasonalStage,children:e}),Object.keys(_[e]).map((t,l)=>(0,i.jsxs)(h.Z,{sx:{...P.Z.recSeasonal,marginBottom:"24px","& h6":{color:"rgba(0, 0, 0, 0.67)"}},children:[(0,i.jsx)(b.Z,{variant:"h6",children:t}),(0,i.jsx)(D.Z,{recommendations:_[e][t],isTagalog:!F,isShowTitle:!1})]},"rec-".concat(l)))]}))]}),(0,i.jsx)(W,{value:N,index:1,smsstyle:"pre-wrap",children:l})]})}),(0,i.jsx)(f.ZP,{item:!0,sx:P.Z.item,xs:12,lg:12,children:(0,i.jsx)(h.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,i.jsx)(Z.Z,{size:16,color:"primary",sx:{display:c?"block":"none"}})})}),(0,i.jsxs)(h.Z,{sx:{marginBottom:"16px",width:"100%",display:null!==_&&v?"block":"none"},children:[(0,i.jsx)("br",{}),(0,i.jsx)(w.Z,{}),(0,i.jsx)("br",{}),""!==R&&(0,i.jsxs)(b.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",R]}),(0,i.jsxs)(g.Z,{size:"large","aria-label":"large button group",sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,i.jsx)(d(),{href:"/admin/bulletins/crops",passHref:!0,legacyBehavior:!0,children:(0,i.jsx)(m.Z,{disabled:M,children:"Cancel"})}),(0,i.jsxs)(m.Z,{onClick:p,disabled:M,children:[(0,i.jsx)("span",{style:{display:M?"none":"block"},children:"Preview"})," ","\xa0",(0,i.jsx)(Z.Z,{size:20,color:"secondary",sx:{display:M?"block":"none"}})]}),(0,i.jsx)(m.Z,{variant:"contained",onClick:u,disableElevation:!0,disabled:M||y,children:"Save"})]})]})]})}I.propTypes={options:r().object,smstext:r().string,keyEng:r().string,keyTag:r().string,formTitle:r().string,isCreateDisabled:r().bool,show:r().bool,loading:r().bool,handleSave:r().func,handlePreview:r().func};var R=l(24006),B=l(17553),F=l(88925),N=l(71663);function L(e){let[t,l]=(0,n.useState)(!1),o=(0,s.useRouter)(),r=(0,a.I0)(),{open:c,loading:Z,isloadingreport:S,isdisabled:w}=e,{climateRisk:E,optsprovinces:k,optsmunicipalities:O,optscrops:C,optscropstages:D,optsactivities:T,recommendationsData:P,sel_options:L}=e,{message:M,smstext:z,pageTitle:W="",pageDescription:A="",pdfPreview:G}=e,{handlePreview:V,handleSave:H,resetSelections:Y,togglePrompt:q,toggleViewerOpen:U,onSelectItemChange:X}=e,{report:K}=(0,a.v9)(e=>e.reports),J="Invalid year";(0,n.useEffect)(()=>{null===L.sel_municipality&&!0===t&&l(!1)},[L.sel_municipality,t]);let $=()=>{K&&(r((0,F.s_)()),o.push("/admin/bulletins/crops/report/view/?docId=".concat(K.id)))},Q=()=>{let e="Loading...";return k.length>0&&(e=null===L.sel_province?"Select a province":"Province"),e};return(0,i.jsxs)("div",{children:[(0,i.jsx)(_.Z,{isOpen:M.isOpen,maxWidth:"xs",openButtonText:null,title:M.title,contentText:M.msg,loading:M.loading,modalCancelHandlerCB:()=>{M.savesuccess?$():q()},modalConfirmHandlerCB:()=>{M.savesuccess?$():H()}}),(0,i.jsx)(j.Z,{open:c,pdfPreview:G,error:L.error,loading:L.loading,toggleViewerOpen:U}),(0,i.jsx)(B.Z,{openSnackbar:""!==L.error,message:L.error,severity:"warning"}),(0,i.jsxs)(f.ZP,{container:!0,sx:N.Z.container,children:[(0,i.jsxs)(h.Z,{sx:N.Z.headerText,children:[(0,i.jsxs)(h.Z,{children:[(0,i.jsx)(b.Z,{variant:"h5",children:W}),(0,i.jsx)("p",{dangerouslySetInnerHTML:{__html:A}})]}),(0,i.jsx)(h.Z,{children:(0,i.jsx)(d(),{href:"/admin/bulletins/crops",passHref:!0,legacyBehavior:!0,children:(0,i.jsx)(v.Z,{"aria-label":"exit",size:"medium",children:(0,i.jsx)(u.Z,{fontSize:"inherit"})})})})]}),(0,i.jsxs)(f.ZP,{item:!0,sx:N.Z.item,xs:12,lg:4,children:[(0,i.jsx)(b.Z,{variant:"h6",children:"Selection Options"}),(0,i.jsx)(p.Z,{disablePortal:!0,id:"province",size:"small",value:L.sel_province,disabled:0===k.length||L.error.includes(J)||Z,options:k,sx:N.Z.autocomplete,PaperComponent:x.Z,renderInput:e=>(0,i.jsx)(y.Z,{...e,label:Q()}),getOptionDisabled:e=>e.disabled,isOptionEqualToValue:(e,t)=>e.label===t,onChange:(e,t)=>X(e,{...t,from:"province"})}),(0,i.jsx)(p.Z,{disablePortal:!0,id:"municipality",size:"small",value:L.sel_municipality,disabled:0===O.length||L.error.includes(J)||Z,options:O,sx:N.Z.autocomplete,PaperComponent:x.Z,renderInput:e=>(0,i.jsx)(y.Z,{...e,label:null===L.sel_municipality?"Select a municipality":"Municipality"}),getOptionDisabled:e=>e.disabled||void 0!==e.iscalendar,isOptionEqualToValue:(e,t)=>e.label===t,onChange:(e,t)=>{X(e,{...t,from:"municipality"}),l(!1)}}),(0,i.jsx)(p.Z,{disablePortal:!0,id:"crop",size:"small",value:L.sel_crop,disabled:0===C.length||Z||!L.sel_municipality,options:C,sx:N.Z.autocomplete,PaperComponent:x.Z,renderInput:e=>(0,i.jsx)(y.Z,{...e,label:null===L.sel_crop?"Select a crop type":"Crop"}),isOptionEqualToValue:(e,t)=>e.label===t,getOptionDisabled:e=>e.disabled,onChange:(e,t)=>{X(e,{...t,from:"crop"}),l(!1)}}),null!==L.sel_municipality&&(0,i.jsxs)("div",{style:{marginTop:"16px",float:"left",textAlign:"center",border:"1px solid #DCEDC8",padding:"5px 10px",borderRadius:"5px"},children:[(0,i.jsx)(b.Z,{variant:"subtitle1",children:(0,i.jsx)("strong",{children:"Climate Risk:"})}),E]}),(0,i.jsxs)(g.Z,{disableElevation:!0,size:"small","aria-label":"outlined button controls group",disabled:S||null===L.sel_municipality||"-"===L.sel_crop,sx:{marginTop:"16px",float:"right"},children:[(0,i.jsx)(m.Z,{variant:"outlined",disabled:Z||S,onClick:Y,children:"Reset"}),(0,i.jsx)(m.Z,{variant:"contained",onClick:()=>l(e=>!e),disabled:Z||null===L.sel_month||0===D.length||""!==L.error||t,children:"Generate"})]})]}),(0,i.jsx)(f.ZP,{item:!0,sx:N.Z.item,xs:12,lg:8,children:(0,i.jsx)(R.Z,{climateRisk:E,selecteditems:L,cropstages:null==D?void 0:D.map(e=>e.label).toString().split(",").join(", "),farmoperations:T.map(e=>e.label).toString().split(",").join(", "),loading:Z,reportType:"Special Weather Bulletin"===W?"special":"tenday"})})]}),(0,i.jsx)(I,{show:t,loading:Z,keyEng:"practice",keyTag:"practice_tagalog",sel_options:L,recommendationsData:P,optsactivities:T,options:L,smstext:z,isCreateDisabled:w,handlePreview:V,toggleViewerOpen:U,pdfPreview:G,handleSave:q})]})}L.propTypes={climateRisk:r().string,optsprovinces:r().array,optsmunicipalities:r().array,optscrops:r().array,optscropstages:r().array,optsactivities:r().array,sel_options:r().object,loading:r().bool,isloadingreport:r().bool,isdisabled:r().bool,open:r().bool,message:r().object,smstext:r().string,pageTitle:r().string,pageDescription:r().string,pdfPreview:r().object,onSelectItemChange:r().func,handlePreview:r().func,handleSave:r().func,toggleViewerOpen:r().func,resetSelections:r().func,togglePrompt:r().func};var M=l(45773),z=l(65328),W=l(97416),A=l(75941),G=l(31695),V=l(32343),H=l(18752),Y=l(9704),q=l(44858),U=l(38508),X=l(63867),K=l(6903),J=l(83074),$=l(38660),Q=l(84325),ee=l(96281),et=l(92246),el=l(98813),ei=l(77457),en=l(63431);let ea={sel_province:null,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:[],sel_month:null,processed:!1,loading:!1,error:"",success:"",sel_condition:{id:0,from:"weather_condition",label:el.MW.WAY_BELOW_NORMAL.label}},es={url:"",filename:""};var eo=(0,z.Z)(function(e){let{user:t,onBtnLogoutClick:l,loading:s}=e,[o,r]=(0,n.useState)(ea),[c,d]=(0,n.useState)({}),[u,p]=(0,n.useState)({}),[m,g]=(0,n.useState)([]),[h,f]=(0,n.useState)([]),[v,y]=(0,n.useState)([]),[b,x]=(0,n.useState)([]),_=(0,X.Z)(o.sel_province,v),{days:j,loading:Z,summary:S}=(0,J.Z)(o.sel_province,o.sel_municipality);(0,n.useEffect)(()=>{if(j.length>0){let e=(0,en.Z)(j,"tenday"),t={...e};["Flooding/Submergence 3M","Flooding/Submergence 2H"].includes(t.label)&&(e.label="Flooding/Submergence",e.code="flood_submergence"),d(e),p(t)}},[j]);let{cropcalendar:w,cropStages:E,loading:k}=(0,H.Z)("10-day",o.sel_province,o.sel_crop),{cropList:D}=(0,Y.Z)(),T=D.map((e,t)=>({disabled:!1,label:e,id:t})),{recommendations:P,farmoperations:I,loading:R}=(0,q.Z)(c.code,b,o.sel_crop,"tenday",!0),{recommendationsSMS:B,loading:N}=(0,U.Z)(o.sel_crop,u.code,"tenday_sms"),{group:z,error:eo}=(0,K.Z)(P,E,b),{services:er,loading:ec}=(0,$.Z)(void 0,void 0);(0,n.useEffect)(()=>{if(j.length>0&&!k&&!R){let e=new Date(j[0].label_full),t=(0,et.Mn)(e);if(0!==w.length){let e=w.data1.find(e=>e.municipality===o.sel_municipality&&e.crop===o.sel_crop),l=w.data2.find(e=>e.municipality===o.sel_municipality&&e.crop===o.sel_crop),i=[];e&&l&&Object.keys(E).length>0&&(Object.keys(t).forEach(n=>{let a=e[n].split(",");t[n].forEach(e=>{"1st_half"===e&&"none"!==a[0]?i.includes(a[0])||i.push(a[0]):"2nd_half"!==e||"none"===a[1]||i.includes(a[1])||i.push(a[1])});let s=l[n].split(",");t[n].forEach(e=>{"1st_half"===e&&"none"!==s[0]?i.includes(s[0])||i.push(s[0]):"2nd_half"!==e||"none"===s[1]||i.includes(s[1])||i.push(s[1])})}),x(i.map((e,t)=>({id:t,label:E[e].label,code:e}))))}}},[E,w.length,w.data1,w.data2,j,o.sel_municipality,o.sel_crop,k,R]);let{status:ed,report:eu}=(0,a.v9)(e=>e.reports),ep=(0,a.v9)(e=>e.dashboard.reportType),em=(0,a.v9)(e=>e.dashboard.isEnglish),[eg,eh]=(0,n.useState)(!0),[ef,ev]=(0,n.useState)(!1),ey=(0,n.useRef)(!1),[eb,ex]=(0,n.useState)(""),[e_,ej]=(0,n.useState)(es),[eZ,eS]=(0,n.useState)(Q.BF),ew=(0,a.I0)();(0,n.useEffect)(()=>(ey.current=!0,(async()=>{try{let e=await (0,W.$m)();ey&&y(e.data)}catch(e){}})(),()=>{ey.current=!1}),[]),(0,n.useEffect)(()=>{ew((0,V.Km)([])),ew((0,F.s_)())},[ew]),(0,n.useEffect)(()=>{v.length>0&&f((0,ee.m)(v))},[v]),(0,n.useEffect)(()=>{null!==S&&r(e=>({...e,sel_month:{label:S.date_range}}))},[S]),(0,n.useEffect)(()=>{eh(s||R||k||Z||N||ec)},[s,R,k,Z,N,ec]),(0,n.useEffect)(()=>{ej(es)},[em]),(0,n.useEffect)(()=>{0!==B.length&&ex(B[0].sms.replace("{{10_day_range_identifier}}",o.sel_month.label))},[B,o.sel_month]),(0,n.useEffect)(()=>{ed===C.G.FULLFILLED&&null!==eu&&ey.current&&eS(e=>({...e,msg:"Success! Bulletin report created.",loading:!1,savesuccess:!0,docId:eu.id}))},[ed,eu]),(0,n.useEffect)(()=>{eo||null===z||ew((0,V.Km)(z))},[z,eo,ew]);let eE=async()=>{if(""!==e_.url){ev(!0);return}r(e=>({...e,loading:!0,error:"",success:""}));try{let e={region:"mimaropa",province:o.sel_province,municipality:o.sel_municipality,operation:"preview",language:em?"en":"tag",crop:null==o?void 0:o.sel_crop,services:er.map(e=>e.data)};ev(!0),r(e=>({...e,loading:!0,error:""}));let t=await (0,G.bM)(e),l=new Blob([t],{type:"application/pdf"}),i={};i.href=URL.createObjectURL(l),i.download="".concat(o.sel_province,"_").concat(o.sel_municipality,".pdf"),ej(e=>({...e,url:i.href,filename:i.download})),r(e=>({...e,loading:!1,success:"Bulletin preview created."}))}catch(t){let e=await (0,ei.fu)(t);r(t=>({...t,loading:!1,error:e}))}},ek=async()=>{eS({...eZ,loading:!0,msg:"Saving report..."});try{let e={region:"mimaropa",province:o.sel_province,municipality:o.sel_municipality,operation:"create",language:em?"en":"tag",crop:o.sel_crop,services:er.map(e=>e.data)};ew((0,A.a0)(e)).unwrap().then(()=>{ep!==Q.Ry.TEN_DAY&&(ew((0,O.uq)(Q.Ry.TEN_DAY)),ew((0,A.RC)({uid:t.uid,type:Q.Ry.TEN_DAY})))}).catch(e=>{ey.current&&eS(t=>({...t,msg:e,loading:!1,savesuccess:!1,docId:null}))})}catch(t){let e="";void 0!==t.response&&(e=void 0!==t.response.data&&"[object Blob]"==typeof t.response.data?t.response.data:""),""===e&&(e=t.message),r(t=>({...t,loading:!1,error:e}))}};return(0,i.jsx)(M.Z,{loading:s,user:t,onBtnLogoutClick:l,accLevel:el.DW.ADMIN,children:(0,i.jsx)(L,{climateRisk:c.label,optsprovinces:h,optsmunicipalities:_,optscrops:T,optscropstages:b,optsactivities:I,sel_options:o,loading:eg,recommendationsData:P,isloadingreport:ed===C.G.PENDING,isdisabled:!1,open:ef,message:eZ,smstext:eb,pageTitle:"10-Day Farm Weather Outlook and Advisory Bulletin",pageDescription:"Create <strong>10-Day Farm Weather Outlook and Advisory</strong> crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download.",pdfPreview:e_,onSelectItemChange:(e,t)=>{let{from:l,label:i}=t;if(ej(es),m.length>0&&g([]),""!==o.error&&r(e=>({...e,error:""})),Object.keys(t).includes("id"))switch(l){case"province":x([]),r(e=>({...e,sel_province:i,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:null}));break;case"municipality":x([]),r(e=>({...e,sel_municipality:i,sel_crop:null,sel_stage:null,sel_activity:null}));break;case"crop":r(e=>({...e,sel_crop:i,sel_stage:null,sel_activity:null})),x([])}else if("province"===l){let e=o.sel_month;r({...ea,sel_month:e}),x([])}else"municipality"===l&&(r({...o,sel_municipality:null,sel_crop:null,sel_day:null,sel_stage:null,sel_activity:null}),x([]))},handlePreview:eE,handleSave:ek,toggleViewerOpen:()=>{ev(e=>!e)},resetSelections:()=>{let e=o.sel_month;r({...ea,sel_month:e}),x([]),ew((0,V.Km)([]))},togglePrompt:()=>{eS(e=>({...Q.BF,isOpen:!e.isOpen}))}})})})},6506:function(e,t,l){"use strict";l.d(t,{Z:function(){return n}});var i=l(67294);function n(e){let[t,l]=(0,i.useState)([]),[n,a]=(0,i.useState)("");(0,i.useEffect)(()=>{if(a(""),(null==e?void 0:e.length)>0)try{let t=e.map(e=>({impact:e.impact_outlook_english,impact_tagalog:e.impact_outlook_tagalog})).filter(e=>""!==e.impact_outlook_english&&""!==e.impact_outlook_tagalog);t=o(t),l([{impact:s(t.impact),impact_tagalog:s(t.impact_tagalog)}]);return}catch(e){var t,i,n;a(null!==(n=null!==(i=null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)&&void 0!==i?i:e.message)&&void 0!==n?n:String(e))}else l([])},[e]);let s=e=>{let t="-",l=e.reduce((e,l)=>(l.includes("<p>")?("list"===t&&(e+="</ul>"),e+=l,t="p"):(["-","p"].includes(t)&&(e+="<ul>"),e+=l,t="list"),e),"");return"list"===t&&(l+="</ul>"),l},o=e=>{let t={impact:[],impact_tagalog:[]};return e.reduce((e,l)=>(Object.keys(e).forEach(i=>{let n=l[i].replace(/<ul>/g,"");(n=(n=n.replace(/<\/ul>/g,"")).replace(/<li>/g,"")).split("</li>").forEach(l=>{l.includes("<p>")?l.replace(/<p>/g,"").split("</p>").forEach(l=>{t[i].includes(l)||""===l||(t[i].push(l),e[i].push("<p>".concat(l,"</p>")))}):t[i].includes(l)||""===l||(t[i].push(l),e[i].push("<li>".concat(l,"</li>")))})}),{...e}),{impact:[],impact_tagalog:[]})};return{group:t,error:n}}},6903:function(e,t,l){"use strict";l.d(t,{Z:function(){return n}});var i=l(67294);function n(e,t,l){let[n,a]=(0,i.useState)(null),[s,o]=(0,i.useState)(""),r=e=>e.map(e=>e.farming_activity).filter((e,t,l)=>l.indexOf(e)===t);return(0,i.useEffect)(()=>{if(o(""),(null==e?void 0:e.length)>0&&(null==l?void 0:l.length)>0&&t){let c=r(e),d=null==l?void 0:l.map(e=>e.code);try{a(d.reduce((l,i)=>(null==c||c.forEach(n=>{let a=t[i].label,s=e.filter(e=>e.crop_stage===i&&e.farming_activity===n);s.length>0&&a&&(void 0===l[a]&&(l[a]={}),void 0===l[a][n]&&(l[a][n]=[]),l[a][n]=[...l[a][n],...s])}),l),{}))}catch(e){var i,n,s;a(null),o(null!==(s=null!==(n=null==e?void 0:null===(i=e.response)||void 0===i?void 0:i.data)&&void 0!==n?n:e.message)&&void 0!==s?s:String(e))}}else(null==e?void 0:e.length)>0?a(e):a(null)},[e,t,l]),{group:n,error:s}}},38508:function(e,t,l){"use strict";l.d(t,{Z:function(){return a}});var i=l(67294),n=l(22088);function a(e,t,l){let[a,s]=(0,i.useState)([]),[o,r]=(0,i.useState)(!1),[c,d]=(0,i.useState)("");return(0,i.useEffect)(()=>{let i=async()=>{try{let i=[];r(!1),d(""),i=await (0,n.iR)({crop:e,climateRisk:t,type:l}),r(!1),s(i||[])}catch(e){var i,a;d(null!==(a=null==e?void 0:null===(i=e.response)||void 0===i?void 0:i.data)&&void 0!==a?a:e.message),r(!1)}};e&&l?i():s([])},[e,t,l]),{recommendationsSMS:a,loading:o,error:c}}},38660:function(e,t,l){"use strict";l.d(t,{Z:function(){return a}});var i=l(67294),n=l(98037);function a(e,t){let[l,a]=(0,i.useState)([]),[s,o]=(0,i.useState)(!1),[r,c]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{(async()=>{try{let e=await (0,n.yZ)();a(null!=e?e:[])}catch(l){var e,t;c(null!==(t=null==l?void 0:null===(e=l.response)||void 0===e?void 0:e.data)&&void 0!==t?t:l.message),o(!1)}})()},[e,t]),{services:l,loading:s,error:r}}},83074:function(e,t,l){"use strict";l.d(t,{Z:function(){return c}});var i=l(67294),n=l(9473),a=l(98813),s=l(61984),o=l(92246),r=l(25517);function c(e,t){let[l,c]=(0,i.useState)([]),[d,u]=(0,i.useState)(null),[p,m]=(0,i.useState)(""),[g,h]=(0,i.useState)(""),[f,v]=(0,i.useState)(!1),y=(0,n.I0)(),{ids:b,status:x,entities:_,error:j}=(0,n.v9)(e=>e.tendayweather);return(0,i.useEffect)(()=>{null!==e&&(m(""),h(""),y((0,s.R)(e)))},[e,y]),(0,i.useEffect)(()=>{m(j)},[j]),(0,i.useEffect)(()=>{v(x===r.G.PENDING)},[x]),(0,i.useEffect)(()=>{if(m(""),h(""),x===r.G.FULLFILLED&&b.length>0&&""===j&&null!==t){let e=Object.values(_).find(e=>e.municipality===t);if(void 0!==e){let t=JSON.parse(e.data),l=Object.values(a.MW);c(t.reduce((e,i,n)=>{var a,s,r,c,d;return[...e,{id:n,label:i.day_format,label_full:null===(a=(0,o.Ay)(i.day_format,t[9].day_format))||void 0===a?void 0:a.toDateString(),rainfall:i.rainfall,forecast:null!==(c=null===(s=l.find(e=>e.tenday===i.rainfall))||void 0===s?void 0:s.sync)&&void 0!==c?c:"-",code:null!==(d=null===(r=l.find(e=>e.tenday===i.rainfall))||void 0===r?void 0:r.label)&&void 0!==d?d:"-"}]},[]));let i=new Date(1e3*t[0].date_start.seconds),n=(0,o.Mn)(i);i.getFullYear()!==new Date().getFullYear()&&m("Invalid year detected in the 10-day validity date range: ".concat(t[0].date_range)),u({months:n,date_start:i,date_range:t[0].date_range})}else{let e=j||"Weather data for the municipality is not available at the moment, however, you can continue viewing recommendations. Please verify that the municipality name is present in the 10-Day weather forecast.";j?(c([]),u(null),m(e)):h(e)}}},[t,_,b,x,j]),{days:l,summary:d,loading:f,error:p,warning:g}}},98037:function(e,t,l){"use strict";l.d(t,{Wn:function(){return r},vo:function(){return d},yZ:function(){return o},Ef:function(){return c}});var i=l(96171),n=l(36100);class a extends i.Z{constructor(...e){super(...e),this.getSupportServices=async()=>{let e=this.collection(this.db,"support_services"),t=this.query(e,(0,n.Xo)("date","asc"));return(await this.getDocs(t)).docs.map(e=>({...e.data(),docId:e.id}))},this.addSupportService=async e=>{let{supportService:t}=e,l=this.collection(this.db,"support_services");await this.addDoc(l,{data:t,date:new Date})},this.updateSupportService=async e=>{let t=this.collection(this.db,"support_services"),l=this.doc(t,e.docId);delete e.docId,await this.updateDoc(l,e)},this.deleteSupportService=async e=>{let t=this.doc(this.db,"support_services",e);await this.deleteDoc(t)}}}let s=new a,o=s.getSupportServices.bind(s),r=s.addSupportService.bind(s),c=s.updateSupportService.bind(s),d=s.deleteSupportService.bind(s)},96281:function(e,t,l){"use strict";l.d(t,{m:function(){return i}});let i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"label";return e.map((e,l)=>({id:l,label:e[t]}))}}},function(e){e.O(0,[3153,7023,3745,1664,6541,8848,6294,1626,9998,5837,4723,3338,837,8591,9146,6902,7266,2888,9774,179],function(){return e(e.s=51816)}),_N_E=e.O()}]);