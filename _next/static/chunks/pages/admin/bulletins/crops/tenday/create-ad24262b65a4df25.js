(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5507],{51816:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/tenday/create",function(){return i(33085)}])},17553:function(e,t,i){"use strict";var l=i(85893),n=i(67294),a=i(45697),s=i.n(a),o=i(70760),r=i(44723);let c=n.forwardRef(function(e,t){return(0,l.jsx)(r.Z,{elevation:6,ref:t,variant:"filled",...e})});function d(e){let{openSnackbar:t,message:i,severity:a="info",closeHandlerCB:s=()=>{}}=e,[r,d]=(0,n.useState)(t);(0,n.useEffect)(()=>{d(t)},[t]);let u=()=>{d(!1),s()},p=function(e){if(null==e)return"";if("string"==typeof e)return e;if(e instanceof Error)return e.message||e.toString();if("object"==typeof e&&"string"==typeof e.message)return e.message;try{return JSON.stringify(e)}catch(t){return String(e)}}(i);return(0,l.jsx)(o.Z,{open:r,autoHideDuration:3e3,onClose:u,children:(0,l.jsx)(c,{onClose:u,severity:a,sx:{width:"100%"},children:p})})}d.propTypes={openSnackbar:s().bool,message:s().any,severity:s().string,closeHandlerCB:s().func},t.Z=d},70165:function(e,t){"use strict";t.Z={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",borderColor:"#E2E8F0"},welcome:{border:"1px solid #DCEDC8",borderRadius:e=>e.spacing(1),width:"100%",display:"grid",placeContent:"center",padding:"20px",marginTop:e=>e.spacing(1),textAlign:"center","& h6":{lineHeight:"20px"}},summary:{border:"1px solid #DCEDC8",borderRadius:e=>e.spacing(1),marginTop:e=>e.spacing(1),padding:e=>e.spacing(3)},selectionSummary:{minWidth:"100%",paddingLeft:{xs:0,lg:"16px"}},conditionLegend:{borderRadius:e=>e.spacing(1),width:"100%",padding:e=>e.spacing(1),border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",float:"left"},autocomplete:{marginTop:e=>e.spacing(1)},recSeasonal:{marginTop:e=>e.spacing(1),"& p, ul, ol":{fontSize:"14px"}},button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"50px"}},pdfcontent:{ul:{paddingLeft:3}},recSeasonalStage:{marginTop:e=>e.spacing(5),marginBottom:e=>e.spacing(2),textDecoration:"underline"}}},33085:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return eo}});var l=i(85893),n=i(67294),a=i(9473),s=i(11163),o=i(45697),r=i.n(o),c=i(41664),d=i.n(c),u=i(55292),p=i(25837),g=i(51015),m=i(49986),f=i(60990),h=i(68573),v=i(52857),x=i(26541),b=i(96788),y=i(2052),_=i(16729),S=i(57951),j=i(97182),Z=i(81873),w=i(56912),E=i(28907),k=i(88607),C=i(46560),O=i(25517),D=i(29455),T=i(6506),F=i(70165);function P(e){let{options:t,smstext:i,sel_options:s,optsactivities:o,recommendationsData:r,loading:c}=e,{handleSave:u,handlePreview:p,show:v=!0,isCreateDisabled:x=!1}=e,y=(0,a.I0)(),{filtered_recommendations:_,recommendations:S}=(0,a.v9)(e=>e.recommendations),{group:P}=(0,T.Z)(null!=r?r:S,o),{error:I,status:R}=(0,a.v9)(e=>e.reports),B=(0,a.v9)(e=>e.dashboard.isEnglish),[L,N]=(0,n.useState)(0),[W,z]=(0,n.useState)(!1);function M(e){let{children:t,value:i,index:n,...a}=e;return(0,l.jsx)("div",{role:"tabpanel",hidden:i!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n),...a,children:i===n&&(0,l.jsx)(f.Z,{sx:{p:3,whiteSpace:e.smsstyle},children:t})})}function A(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}return(0,n.useEffect)(()=>{z(t.loading||R===O.G.PENDING)},[t.loading,R]),(0,l.jsxs)(h.ZP,{container:!0,sx:F.Z.container,gap:3,style:{marginTop:"24px",padding:c?"16px":"24px"},children:[null!==_&&v&&(0,l.jsx)(f.Z,{children:(0,l.jsxs)(f.Z,{sx:{width:"100%",marginTop:{xs:"85px",lg:"0px"}},children:[(0,l.jsx)(f.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,l.jsxs)(k.Z,{value:L,onChange:(e,t)=>{N(t)},"aria-label":"basic tabs example",children:[(0,l.jsx)(E.Z,{label:"PDF FORM",...A(0)}),(0,l.jsx)(E.Z,{label:"SMS FORM",...A(1)})]})}),(0,l.jsxs)(M,{value:L,index:0,smsstyle:"normal",children:[(0,l.jsxs)(f.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,l.jsx)(b.Z,{variant:"h4",children:"Impact Outlooks"}),(0,l.jsx)(Z.Z,{size:"medium",variant:"outlined",label:B?"Tagalog":"English",onClick:()=>y((0,C.cX)()),sx:{width:"90px"}})]}),(0,l.jsx)(f.Z,{sx:F.Z.recSeasonal,children:(0,l.jsx)(D.Z,{impactOutlookOnly:!0,isShowImpactOutlookSubtitle:!1,recommendations:P,impactOutlookEng:"impact",impactOutlookTag:"impact_tagalog",title:s.sel_crop,isTagalog:!B,isShowTitle:!1})}),(0,l.jsx)("hr",{}),(0,l.jsx)(b.Z,{variant:"h4",sx:{marginTop:"32px"},children:"Recommendations"}),Object.keys(_).map(e=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.Z,{variant:"h5",sx:F.Z.recSeasonalStage,children:e}),Object.keys(_[e]).map((t,i)=>(0,l.jsxs)(f.Z,{sx:{...F.Z.recSeasonal,marginBottom:"24px","& h6":{color:"rgba(0, 0, 0, 0.67)"}},children:[(0,l.jsx)(b.Z,{variant:"h6",children:t}),(0,l.jsx)(D.Z,{recommendations:_[e][t],isTagalog:!B,isShowTitle:!1})]},"rec-".concat(i)))]}))]}),(0,l.jsx)(M,{value:L,index:1,smsstyle:"pre-wrap",children:i})]})}),(0,l.jsx)(h.ZP,{item:!0,sx:F.Z.item,xs:12,lg:12,children:(0,l.jsx)(f.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,l.jsx)(j.Z,{size:16,color:"primary",sx:{display:c?"block":"none"}})})}),(0,l.jsxs)(f.Z,{sx:{marginBottom:"16px",width:"100%",display:null!==_&&v?"block":"none"},children:[(0,l.jsx)("br",{}),(0,l.jsx)(w.Z,{}),(0,l.jsx)("br",{}),""!==I&&(0,l.jsxs)(b.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",I]}),(0,l.jsxs)(m.Z,{size:"large","aria-label":"large button group",sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,l.jsx)(d(),{href:"/admin/bulletins/crops",passHref:!0,legacyBehavior:!0,children:(0,l.jsx)(g.Z,{disabled:W,children:"Cancel"})}),(0,l.jsxs)(g.Z,{onClick:p,disabled:W,children:[(0,l.jsx)("span",{style:{display:W?"none":"block"},children:"Preview"})," ","\xa0",(0,l.jsx)(j.Z,{size:20,color:"secondary",sx:{display:W?"block":"none"}})]}),(0,l.jsx)(g.Z,{variant:"contained",onClick:u,disableElevation:!0,disabled:W||x,children:"Save"})]})]})]})}P.propTypes={options:r().object,smstext:r().string,keyEng:r().string,keyTag:r().string,formTitle:r().string,isCreateDisabled:r().bool,show:r().bool,loading:r().bool,handleSave:r().func,handlePreview:r().func};var I=i(24006),R=i(17553),B=i(88925),L=i(71663);function N(e){let[t,i]=(0,n.useState)(!1),o=(0,s.useRouter)(),r=(0,a.I0)(),{open:c,loading:j,isloadingreport:Z,isdisabled:w}=e,{climateRisk:E,optsprovinces:k,optsmunicipalities:C,optscrops:O,optscropstages:D,optsactivities:T,recommendationsData:F,sel_options:N}=e,{message:W,smstext:z,pageTitle:M="",pageDescription:A="",pdfPreview:G}=e,{handlePreview:H,handleSave:V,resetSelections:Y,togglePrompt:q,toggleViewerOpen:U,onSelectItemChange:X}=e,{report:K}=(0,a.v9)(e=>e.reports),J="Invalid year";(0,n.useEffect)(()=>{null===N.sel_municipality&&!0===t&&i(!1)},[N.sel_municipality,t]);let $=()=>{K&&(r((0,B.s_)()),o.push("/admin/bulletins/crops/report/view/?docId=".concat(K.id)))},Q=()=>{let e="Loading...";return k.length>0&&(e=null===N.sel_province?"Select a province":"Province"),e};return(0,l.jsxs)("div",{children:[(0,l.jsx)(_.Z,{isOpen:W.isOpen,maxWidth:"xs",openButtonText:null,title:W.title,contentText:W.msg,loading:W.loading,modalCancelHandlerCB:()=>{W.savesuccess?$():q()},modalConfirmHandlerCB:()=>{W.savesuccess?$():V()}}),(0,l.jsx)(S.Z,{open:c,pdfPreview:G,error:N.error,loading:N.loading,toggleViewerOpen:U}),(0,l.jsx)(R.Z,{openSnackbar:""!==N.error,message:N.error,severity:"warning"}),(0,l.jsxs)(h.ZP,{container:!0,sx:L.Z.container,children:[(0,l.jsxs)(f.Z,{sx:L.Z.headerText,children:[(0,l.jsxs)(f.Z,{children:[(0,l.jsx)(b.Z,{variant:"h5",children:M}),(0,l.jsx)("p",{dangerouslySetInnerHTML:{__html:A}})]}),(0,l.jsx)(f.Z,{children:(0,l.jsx)(d(),{href:"/admin/bulletins/crops",passHref:!0,legacyBehavior:!0,children:(0,l.jsx)(v.Z,{"aria-label":"exit",size:"medium",children:(0,l.jsx)(u.Z,{fontSize:"inherit"})})})})]}),(0,l.jsxs)(h.ZP,{item:!0,sx:L.Z.item,xs:12,lg:4,children:[(0,l.jsx)(b.Z,{variant:"h6",children:"Selection Options"}),(0,l.jsx)(p.Z,{disablePortal:!0,id:"province",size:"small",value:N.sel_province,disabled:0===k.length||N.error.includes(J)||j,options:k,sx:L.Z.autocomplete,PaperComponent:y.Z,renderInput:e=>(0,l.jsx)(x.Z,{...e,label:Q()}),getOptionDisabled:e=>e.disabled,isOptionEqualToValue:(e,t)=>e.label===t,onChange:(e,t)=>X(e,{...t,from:"province"})}),(0,l.jsx)(p.Z,{disablePortal:!0,id:"municipality",size:"small",value:N.sel_municipality,disabled:0===C.length||N.error.includes(J)||j,options:C,sx:L.Z.autocomplete,PaperComponent:y.Z,renderInput:e=>(0,l.jsx)(x.Z,{...e,label:null===N.sel_municipality?"Select a municipality":"Municipality"}),getOptionDisabled:e=>e.disabled||void 0!==e.iscalendar,isOptionEqualToValue:(e,t)=>e.label===t,onChange:(e,t)=>{X(e,{...t,from:"municipality"}),i(!1)}}),(0,l.jsx)(p.Z,{disablePortal:!0,id:"crop",size:"small",value:N.sel_crop,disabled:0===O.length||j||!N.sel_municipality,options:O,sx:L.Z.autocomplete,PaperComponent:y.Z,renderInput:e=>(0,l.jsx)(x.Z,{...e,label:null===N.sel_crop?"Select a crop type":"Crop"}),isOptionEqualToValue:(e,t)=>e.label===t,getOptionDisabled:e=>e.disabled,onChange:(e,t)=>{X(e,{...t,from:"crop"}),i(!1)}}),null!==N.sel_municipality&&(0,l.jsxs)("div",{style:{marginTop:"16px",float:"left",textAlign:"center",border:"1px solid #DCEDC8",padding:"5px 10px",borderRadius:"5px"},children:[(0,l.jsx)(b.Z,{variant:"subtitle1",children:(0,l.jsx)("strong",{children:"Climate Risk:"})}),E]}),(0,l.jsxs)(m.Z,{disableElevation:!0,size:"small","aria-label":"outlined button controls group",disabled:Z||null===N.sel_municipality||"-"===N.sel_crop,sx:{marginTop:"16px",float:"right"},children:[(0,l.jsx)(g.Z,{variant:"outlined",disabled:j||Z,onClick:Y,children:"Reset"}),(0,l.jsx)(g.Z,{variant:"contained",onClick:()=>i(e=>!e),disabled:j||null===N.sel_month||0===D.length||""!==N.error||t,children:"Generate"})]})]}),(0,l.jsx)(h.ZP,{item:!0,sx:L.Z.item,xs:12,lg:8,children:(0,l.jsx)(I.Z,{climateRisk:E,selecteditems:N,cropstages:null==D?void 0:D.map(e=>e.label).toString().split(",").join(", "),farmoperations:T.map(e=>e.label).toString().split(",").join(", "),loading:j,reportType:"Special Weather Bulletin"===M?"special":"tenday"})})]}),(0,l.jsx)(P,{show:t,loading:j,keyEng:"practice",keyTag:"practice_tagalog",sel_options:N,recommendationsData:F,optsactivities:T,options:N,smstext:z,isCreateDisabled:w,handlePreview:H,toggleViewerOpen:U,pdfPreview:G,handleSave:q})]})}N.propTypes={climateRisk:r().string,optsprovinces:r().array,optsmunicipalities:r().array,optscrops:r().array,optscropstages:r().array,optsactivities:r().array,sel_options:r().object,loading:r().bool,isloadingreport:r().bool,isdisabled:r().bool,open:r().bool,message:r().object,smstext:r().string,pageTitle:r().string,pageDescription:r().string,pdfPreview:r().object,onSelectItemChange:r().func,handlePreview:r().func,handleSave:r().func,toggleViewerOpen:r().func,resetSelections:r().func,togglePrompt:r().func};var W=i(45773),z=i(65328),M=i(97416),A=i(75941),G=i(31695),H=i(32343),V=i(18752),Y=i(9704),q=i(44858),U=i(38508),X=i(63867),K=i(6903),J=i(83074),$=i(38660),Q=i(84325),ee=i(96281),et=i(92246),ei=i(98813),el=i(77457),en=i(63431);let ea={sel_province:null,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:[],sel_month:null,processed:!1,loading:!1,error:"",success:"",sel_condition:{id:0,from:"weather_condition",label:ei.MW.WAY_BELOW_NORMAL.label}},es={url:"",filename:""};var eo=(0,z.Z)(function(e){let{user:t,onBtnLogoutClick:i,loading:s}=e,[o,r]=(0,n.useState)(ea),[c,d]=(0,n.useState)({}),[u,p]=(0,n.useState)({}),[g,m]=(0,n.useState)([]),[f,h]=(0,n.useState)([]),[v,x]=(0,n.useState)([]),[b,y]=(0,n.useState)([]),_=(0,X.Z)(o.sel_province,v),{days:S,loading:j,summary:Z}=(0,J.Z)(o.sel_province,o.sel_municipality);(0,n.useEffect)(()=>{if(S.length>0){let e=(0,en.Z)(S,"tenday"),t={...e};["Flooding/Submergence 3M","Flooding/Submergence 2H"].includes(t.label)&&(e.label="Flooding/Submergence",e.code="flood_submergence"),d(e),p(t)}},[S]);let{cropcalendar:w,cropStages:E,loading:k}=(0,V.Z)("10-day",o.sel_province,o.sel_crop),{cropList:D}=(0,Y.Z)(),T=D.map((e,t)=>({disabled:!1,label:e,id:t})),{recommendations:F,farmoperations:P,loading:I}=(0,q.Z)(c.code,b,o.sel_crop,"tenday",!0),{recommendationsSMS:R,loading:L}=(0,U.Z)(o.sel_crop,u.code,"tenday_sms"),{group:z,error:eo}=(0,K.Z)(F,E,b),{services:er,loading:ec}=(0,$.Z)(void 0,void 0);(0,n.useEffect)(()=>{if(S.length>0&&!k&&!I){let e=new Date(S[0].label_full),t=(0,et.Mn)(e);if(0!==w.length){let e=w.data1.find(e=>e.municipality===o.sel_municipality&&e.crop===o.sel_crop),i=w.data2.find(e=>e.municipality===o.sel_municipality&&e.crop===o.sel_crop),l=[];e&&i&&Object.keys(E).length>0&&(Object.keys(t).forEach(n=>{let a=e[n].split(",");t[n].forEach(e=>{"1st_half"===e&&"none"!==a[0]?l.includes(a[0])||l.push(a[0]):"2nd_half"!==e||"none"===a[1]||l.includes(a[1])||l.push(a[1])});let s=i[n].split(",");t[n].forEach(e=>{"1st_half"===e&&"none"!==s[0]?l.includes(s[0])||l.push(s[0]):"2nd_half"!==e||"none"===s[1]||l.includes(s[1])||l.push(s[1])})}),y(l.map((e,t)=>({id:t,label:E[e].label,code:e}))))}}},[E,w.length,w.data1,w.data2,S,o.sel_municipality,o.sel_crop,k,I]);let{status:ed,report:eu}=(0,a.v9)(e=>e.reports),ep=(0,a.v9)(e=>e.dashboard.reportType),eg=(0,a.v9)(e=>e.dashboard.isEnglish),[em,ef]=(0,n.useState)(!0),[eh,ev]=(0,n.useState)(!1),ex=(0,n.useRef)(!1),[eb,ey]=(0,n.useState)(""),[e_,eS]=(0,n.useState)(es),[ej,eZ]=(0,n.useState)(Q.BF),ew=(0,a.I0)();(0,n.useEffect)(()=>(ex.current=!0,(async()=>{try{let e=await (0,M.$m)();ex&&x(e.data)}catch(e){}})(),()=>{ex.current=!1}),[]),(0,n.useEffect)(()=>{ew((0,H.Km)([])),ew((0,B.s_)())},[ew]),(0,n.useEffect)(()=>{v.length>0&&h((0,ee.m)(v))},[v]),(0,n.useEffect)(()=>{null!==Z&&r(e=>({...e,sel_month:{label:Z.date_range}}))},[Z]),(0,n.useEffect)(()=>{ef(s||I||k||j||L||ec)},[s,I,k,j,L,ec]),(0,n.useEffect)(()=>{eS(es)},[eg]),(0,n.useEffect)(()=>{0!==R.length&&ey(R[0].sms.replace("{{10_day_range_identifier}}",o.sel_month.label))},[R,o.sel_month]),(0,n.useEffect)(()=>{ed===O.G.FULLFILLED&&null!==eu&&ex.current&&eZ(e=>({...e,msg:"Success! Bulletin report created.",loading:!1,savesuccess:!0,docId:eu.id}))},[ed,eu]),(0,n.useEffect)(()=>{eo||null===z||ew((0,H.Km)(z))},[z,eo,ew]);let eE=async()=>{if(""!==e_.url){ev(!0);return}r(e=>({...e,loading:!0,error:"",success:""}));try{let e={region:"mimaropa",province:o.sel_province,municipality:o.sel_municipality,operation:"preview",language:eg?"en":"tag",crop:null==o?void 0:o.sel_crop,services:er.map(e=>e.data)};ev(!0),r(e=>({...e,loading:!0,error:""}));let t=await (0,G.bM)(e),i=new Blob([t],{type:"application/pdf"}),l={};l.href=URL.createObjectURL(i),l.download="".concat(o.sel_province,"_").concat(o.sel_municipality,".pdf"),eS(e=>({...e,url:l.href,filename:l.download})),r(e=>({...e,loading:!1,success:"Bulletin preview created."}))}catch(t){let e=await (0,el.fu)(t);r(t=>({...t,loading:!1,error:e}))}},ek=async()=>{eZ({...ej,loading:!0,msg:"Saving report..."});try{let e={region:"mimaropa",province:o.sel_province,municipality:o.sel_municipality,operation:"create",language:eg?"en":"tag",crop:o.sel_crop,services:er.map(e=>e.data)};ew((0,A.a0)(e)).unwrap().then(()=>{ep!==Q.Ry.TEN_DAY&&(ew((0,C.uq)(Q.Ry.TEN_DAY)),ew((0,A.RC)({uid:t.uid,type:Q.Ry.TEN_DAY})))}).catch(e=>{ex.current&&eZ(t=>({...t,msg:e,loading:!1,savesuccess:!1,docId:null}))})}catch(t){let e="";void 0!==t.response&&(e=void 0!==t.response.data&&"[object Blob]"==typeof t.response.data?t.response.data:""),""===e&&(e=t.message),r(t=>({...t,loading:!1,error:e}))}};return(0,l.jsx)(W.Z,{loading:s,user:t,onBtnLogoutClick:i,accLevel:ei.DW.ADMIN,children:(0,l.jsx)(N,{climateRisk:c.label,optsprovinces:f,optsmunicipalities:_,optscrops:T,optscropstages:b,optsactivities:P,sel_options:o,loading:em,recommendationsData:F,isloadingreport:ed===O.G.PENDING,isdisabled:!1,open:eh,message:ej,smstext:eb,pageTitle:"10-Day Farm Weather Outlook and Advisory Bulletin",pageDescription:"Create <strong>10-Day Farm Weather Outlook and Advisory</strong> crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download.",pdfPreview:e_,onSelectItemChange:(e,t)=>{let{from:i,label:l}=t;if(eS(es),g.length>0&&m([]),""!==o.error&&r(e=>({...e,error:""})),Object.keys(t).includes("id"))switch(i){case"province":y([]),r(e=>({...e,sel_province:l,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:null}));break;case"municipality":y([]),r(e=>({...e,sel_municipality:l,sel_crop:null,sel_stage:null,sel_activity:null}));break;case"crop":r(e=>({...e,sel_crop:l,sel_stage:null,sel_activity:null})),y([])}else if("province"===i){let e=o.sel_month;r({...ea,sel_month:e}),y([])}else"municipality"===i&&(r({...o,sel_municipality:null,sel_crop:null,sel_day:null,sel_stage:null,sel_activity:null}),y([]))},handlePreview:eE,handleSave:ek,toggleViewerOpen:()=>{ev(e=>!e)},resetSelections:()=>{let e=o.sel_month;r({...ea,sel_month:e}),y([]),ew((0,H.Km)([]))},togglePrompt:()=>{eZ(e=>({...Q.BF,isOpen:!e.isOpen}))}})})})},63867:function(e,t,i){"use strict";i.d(t,{Z:function(){return n}});var l=i(67294);function n(e,t){let[i,n]=(0,l.useState)([]);return(0,l.useEffect)(()=>{var i,l;n(e&&t&&null!==(l=null===(i=t.find(t=>t.label===e))||void 0===i?void 0:i.municipalities)&&void 0!==l?l:[])},[e,t]),i}},6506:function(e,t,i){"use strict";i.d(t,{Z:function(){return n}});var l=i(67294);function n(e){let[t,i]=(0,l.useState)([]),[n,a]=(0,l.useState)("");(0,l.useEffect)(()=>{if(a(""),(null==e?void 0:e.length)>0)try{let t=e.map(e=>({impact:e.impact_outlook_english,impact_tagalog:e.impact_outlook_tagalog})).filter(e=>""!==e.impact_outlook_english&&""!==e.impact_outlook_tagalog);t=o(t),i([{impact:s(t.impact),impact_tagalog:s(t.impact_tagalog)}]);return}catch(e){var t,l,n;a(null!==(n=null!==(l=null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data)&&void 0!==l?l:e.message)&&void 0!==n?n:String(e))}else i([])},[e]);let s=e=>{let t="-",i=e.reduce((e,i)=>(i.includes("<p>")?("list"===t&&(e+="</ul>"),e+=i,t="p"):(["-","p"].includes(t)&&(e+="<ul>"),e+=i,t="list"),e),"");return"list"===t&&(i+="</ul>"),i},o=e=>{let t={impact:[],impact_tagalog:[]};return e.reduce((e,i)=>(Object.keys(e).forEach(l=>{let n=i[l].replace(/<ul>/g,"");(n=(n=n.replace(/<\/ul>/g,"")).replace(/<li>/g,"")).split("</li>").forEach(i=>{i.includes("<p>")?i.replace(/<p>/g,"").split("</p>").forEach(i=>{t[l].includes(i)||""===i||(t[l].push(i),e[l].push("<p>".concat(i,"</p>")))}):t[l].includes(i)||""===i||(t[l].push(i),e[l].push("<li>".concat(i,"</li>")))})}),{...e}),{impact:[],impact_tagalog:[]})};return{group:t,error:n}}},6903:function(e,t,i){"use strict";i.d(t,{Z:function(){return n}});var l=i(67294);function n(e,t,i){let[n,a]=(0,l.useState)(null),[s,o]=(0,l.useState)(""),r=e=>e.map(e=>e.farming_activity).filter((e,t,i)=>i.indexOf(e)===t);return(0,l.useEffect)(()=>{if(o(""),(null==e?void 0:e.length)>0&&(null==i?void 0:i.length)>0&&t){let c=r(e),d=null==i?void 0:i.map(e=>e.code);try{a(d.reduce((i,l)=>(null==c||c.forEach(n=>{let a=t[l].label,s=e.filter(e=>e.crop_stage===l&&e.farming_activity===n);s.length>0&&a&&(void 0===i[a]&&(i[a]={}),void 0===i[a][n]&&(i[a][n]=[]),i[a][n]=[...i[a][n],...s])}),i),{}))}catch(e){var l,n,s;a(null),o(null!==(s=null!==(n=null==e?void 0:null===(l=e.response)||void 0===l?void 0:l.data)&&void 0!==n?n:e.message)&&void 0!==s?s:String(e))}}else(null==e?void 0:e.length)>0?a(e):a(null)},[e,t,i]),{group:n,error:s}}},38508:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var l=i(67294),n=i(22088);function a(e,t,i){let[a,s]=(0,l.useState)([]),[o,r]=(0,l.useState)(!1),[c,d]=(0,l.useState)("");return(0,l.useEffect)(()=>{let l=async()=>{try{let l=[];r(!1),d(""),l=await (0,n.iR)({crop:e,climateRisk:t,type:i}),r(!1),s(l||[])}catch(e){var l,a;d(null!==(a=null==e?void 0:null===(l=e.response)||void 0===l?void 0:l.data)&&void 0!==a?a:e.message),r(!1)}};e&&i?l():s([])},[e,t,i]),{recommendationsSMS:a,loading:o,error:c}}},38660:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var l=i(67294),n=i(98037);function a(e,t){let[i,a]=(0,l.useState)([]),[s,o]=(0,l.useState)(!1),[r,c]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{(async()=>{try{let e=await (0,n.yZ)();a(null!=e?e:[])}catch(i){var e,t;c(null!==(t=null==i?void 0:null===(e=i.response)||void 0===e?void 0:e.data)&&void 0!==t?t:i.message),o(!1)}})()},[e,t]),{services:i,loading:s,error:r}}},83074:function(e,t,i){"use strict";i.d(t,{Z:function(){return c}});var l=i(67294),n=i(9473),a=i(98813),s=i(61984),o=i(92246),r=i(25517);function c(e,t){let[i,c]=(0,l.useState)([]),[d,u]=(0,l.useState)(null),[p,g]=(0,l.useState)(""),[m,f]=(0,l.useState)(""),[h,v]=(0,l.useState)(!1),x=(0,n.I0)(),{ids:b,status:y,entities:_,error:S}=(0,n.v9)(e=>e.tendayweather);return(0,l.useEffect)(()=>{null!==e&&(g(""),f(""),x((0,s.R)(e)))},[e,x]),(0,l.useEffect)(()=>{g(S)},[S]),(0,l.useEffect)(()=>{v(y===r.G.PENDING)},[y]),(0,l.useEffect)(()=>{if(g(""),f(""),y===r.G.FULLFILLED&&b.length>0&&""===S&&null!==t){let e=Object.values(_).find(e=>e.municipality===t);if(void 0!==e){let t=JSON.parse(e.data),i=Object.values(a.MW);c(t.reduce((e,l,n)=>{var a,s,r,c,d;return[...e,{id:n,label:l.day_format,label_full:null===(a=(0,o.Ay)(l.day_format,t[9].day_format))||void 0===a?void 0:a.toDateString(),rainfall:l.rainfall,forecast:null!==(c=null===(s=i.find(e=>e.tenday===l.rainfall))||void 0===s?void 0:s.sync)&&void 0!==c?c:"-",code:null!==(d=null===(r=i.find(e=>e.tenday===l.rainfall))||void 0===r?void 0:r.label)&&void 0!==d?d:"-"}]},[]));let l=new Date(1e3*t[0].date_start.seconds),n=(0,o.Mn)(l);l.getFullYear()!==new Date().getFullYear()&&g("Invalid year detected in the 10-day validity date range: ".concat(t[0].date_range)),u({months:n,date_start:l,date_range:t[0].date_range})}else{let e=S||"Weather data for the municipality is not available at the moment, however, you can continue viewing recommendations. Please verify that the municipality name is present in the 10-Day weather forecast.";S?(c([]),u(null),g(e)):f(e)}}},[t,_,b,y,S]),{days:i,summary:d,loading:h,error:p,warning:m}}},98037:function(e,t,i){"use strict";i.d(t,{Wn:function(){return r},vo:function(){return d},yZ:function(){return o},Ef:function(){return c}});var l=i(96171),n=i(36100);class a extends l.Z{constructor(...e){super(...e),this.getSupportServices=async()=>{let e=this.collection(this.db,"support_services"),t=this.query(e,(0,n.Xo)("date","asc"));return(await this.getDocs(t)).docs.map(e=>({...e.data(),docId:e.id}))},this.addSupportService=async e=>{let{supportService:t}=e,i=this.collection(this.db,"support_services");await this.addDoc(i,{data:t,date:new Date})},this.updateSupportService=async e=>{let t=this.collection(this.db,"support_services"),i=this.doc(t,e.docId);delete e.docId,await this.updateDoc(i,e)},this.deleteSupportService=async e=>{let t=this.doc(this.db,"support_services",e);await this.deleteDoc(t)}}}let s=new a,o=s.getSupportServices.bind(s),r=s.addSupportService.bind(s),c=s.updateSupportService.bind(s),d=s.deleteSupportService.bind(s)}},function(e){e.O(0,[3153,6856,190,8583,1664,6541,955,4073,6455,6080,5837,4723,760,3338,8591,4381,9031,2888,9774,179],function(){return e(e.s=51816)}),_N_E=e.O()}]);