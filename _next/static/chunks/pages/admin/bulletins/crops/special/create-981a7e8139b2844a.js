(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4169],{45379:function(e,l,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/special/create",function(){return i(17762)}])},17553:function(e,l,i){"use strict";var n=i(85893),a=i(67294),t=i(45697),s=i.n(t),o=i(70760),r=i(44723);let d=a.forwardRef(function(e,l){return(0,n.jsx)(r.Z,{elevation:6,ref:l,variant:"filled",...e})});function c(e){let{openSnackbar:l,message:i,severity:t,closeHandlerCB:s=()=>{}}=e,[r,c]=(0,a.useState)(l);(0,a.useEffect)(()=>{c(l)},[l]);let u=()=>{c(!1),s()};return(0,n.jsx)(o.Z,{open:r,autoHideDuration:3e3,onClose:u,children:(0,n.jsx)(d,{onClose:u,severity:t,sx:{width:"100%"},children:i})})}c.propTypes={openSnackbar:s().bool,message:s().string,severity:s().string},l.Z=c},70165:function(e,l){"use strict";l.Z={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",borderColor:"#E2E8F0"},welcome:{border:"1px solid #DCEDC8",borderRadius:e=>e.spacing(1),width:"100%",display:"grid",placeContent:"center",padding:"20px",marginTop:e=>e.spacing(1),textAlign:"center","& h6":{lineHeight:"20px"}},summary:{border:"1px solid #DCEDC8",borderRadius:e=>e.spacing(1),marginTop:e=>e.spacing(1),padding:e=>e.spacing(3)},selectionSummary:{minWidth:"100%",paddingLeft:{xs:0,lg:"16px"}},conditionLegend:{borderRadius:e=>e.spacing(1),width:"100%",padding:e=>e.spacing(1),border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",float:"left"},autocomplete:{marginTop:e=>e.spacing(1)},recSeasonal:{marginTop:e=>e.spacing(1),"& p, ul, ol":{fontSize:"14px"}},button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"50px"}},pdfcontent:{ul:{paddingLeft:3}},recSeasonalStage:{marginTop:e=>e.spacing(5),marginBottom:e=>e.spacing(2),textDecoration:"underline"}}},17762:function(e,l,i){"use strict";i.r(l),i.d(l,{default:function(){return ei}});var n=i(85893),a=i(67294),t=i(9473),s=i(11163),o=i(45697),r=i.n(o),d=i(41664),c=i.n(d),u=i(55292),p=i(25837),g=i(51015),v=i(49986),m=i(60990),h=i(68573),x=i(52857),b=i(26541),_=i(96788),f=i(2052),S=i(16729),y=i(57951),E=i(97182),j=i(81873),Z=i(56912),w=i(28907),C=i(88607),O=i(46560),T=i(25517),I=i(70165);function A(e){var l,i,s,o;let{options:r,smstext:d,loading:u}=e,{handleSave:p,handlePreview:x,show:b=!0,isCreateDisabled:f=!1}=e,S=(0,t.I0)(),{recommendations:y}=(0,t.v9)(e=>e.recommendations),{error:A,status:P}=(0,t.v9)(e=>e.reports),L=(0,t.v9)(e=>e.dashboard.isEnglish),[N,D]=(0,a.useState)(0),[R,k]=(0,a.useState)(!1);function F(e){let{children:l,value:i,index:a,...t}=e;return(0,n.jsx)("div",{role:"tabpanel",hidden:i!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a),...t,children:i===a&&(0,n.jsx)(m.Z,{sx:{p:3,whiteSpace:e.smsstyle},children:l})})}function G(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}return(0,a.useEffect)(()=>{k(r.loading||P===T.G.PENDING)},[r.loading,P]),(0,n.jsxs)(h.ZP,{container:!0,sx:I.Z.container,gap:3,style:{marginTop:"24px",padding:u?"16px":"24px"},children:[(0,n.jsxs)(h.ZP,{item:!0,sx:I.Z.item,xs:12,lg:12,children:[(0,n.jsx)(m.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,n.jsx)(E.Z,{size:16,color:"primary",sx:{display:u?"block":"none"}})}),(null==y?void 0:y.length)===1&&b&&(0,n.jsx)(m.Z,{children:(0,n.jsxs)(m.Z,{sx:{width:"100%",marginTop:{xs:"85px",lg:"0px"}},children:[(0,n.jsx)(m.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,n.jsxs)(C.Z,{value:N,onChange:(e,l)=>{D(l)},"aria-label":"basic tabs example",children:[(0,n.jsx)(w.Z,{label:"PDF FORM",...G(0)}),(0,n.jsx)(w.Z,{label:"SMS FORM",...G(1)})]})}),(0,n.jsxs)(F,{value:N,index:0,smsstyle:"normal",children:[(0,n.jsxs)(m.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"40px"},children:[(0,n.jsx)(_.Z,{variant:"h4",children:"Impact Outlooks"}),(0,n.jsx)(j.Z,{size:"medium",variant:"outlined",label:L?"Tagalog":"English",onClick:()=>S((0,O.cX)()),sx:{width:"90px"}})]}),(null==y?void 0:y.length)===1&&(0,n.jsx)(m.Z,{sx:I.Z.recSeasonal,children:(0,n.jsx)("div",{style:{marginBottom:"80px"},dangerouslySetInnerHTML:{__html:L?null===(l=y[0])||void 0===l?void 0:l.impact_outlook_english:null===(i=y[0])||void 0===i?void 0:i.impact_outlook_tagalog}})}),(0,n.jsx)("hr",{}),(0,n.jsx)(_.Z,{variant:"h4",sx:{marginTop:"32px"},children:"Recommendations"}),(0,n.jsx)(m.Z,{sx:I.Z.recSeasonal,children:(0,n.jsx)("div",{style:{marginBottom:"48px"},dangerouslySetInnerHTML:{__html:L?null===(s=y[0])||void 0===s?void 0:s.management_recommendations_english:null===(o=y[0])||void 0===o?void 0:o.management_recommendations_tagalog}})})]}),(0,n.jsx)(F,{value:N,index:1,smsstyle:"pre-wrap",children:d})]})})]}),(0,n.jsxs)(m.Z,{sx:{marginBottom:"16px",width:"100%",display:(null==y?void 0:y.length)===1&&b?"block":"none"},children:[(0,n.jsx)("br",{}),(0,n.jsx)(Z.Z,{}),(0,n.jsx)("br",{}),""!==A&&(0,n.jsxs)(_.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",A]}),(0,n.jsxs)(v.Z,{size:"large","aria-label":"large button group",sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,n.jsx)(c(),{href:"/admin/bulletins/crops",passHref:!0,legacyBehavior:!0,children:(0,n.jsx)(g.Z,{disabled:R,children:"Cancel"})}),(0,n.jsxs)(g.Z,{onClick:x,disabled:R,children:[(0,n.jsx)("span",{style:{display:R?"none":"block"},children:"Preview"})," ","\xa0",(0,n.jsx)(E.Z,{size:20,color:"secondary",sx:{display:R?"block":"none"}})]}),(0,n.jsx)(g.Z,{variant:"contained",onClick:p,disableElevation:!0,disabled:R||f,children:"Save"})]})]})]})}A.propTypes={options:r().object,smstext:r().string,isCreateDisabled:r().bool,show:r().bool,loading:r().bool,handleSave:r().func,handlePreview:r().func};var P=i(24006),L=i(17553),N=i(88925),D=i(98813),R=i(71663);function k(e){var l;let[i,o]=(0,a.useState)(!1),r=(0,s.useRouter)(),d=(0,t.I0)(),{open:E,loading:j,isloadingreport:Z,isdisabled:w}=e,{optsprovinces:C,optsmunicipalities:O,optscrops:T,optswindsignals:I,sel_options:k}=e,{message:F,smstext:G,pageTitle:B="",pageDescription:H="",pdfPreview:M}=e,{handlePreview:W,handleSave:z,resetSelections:V,togglePrompt:Y,toggleViewerOpen:U,onSelectItemChange:q}=e,{report:X}=(0,t.v9)(e=>e.reports);(0,a.useEffect)(()=>{var e;!i||((null==k?void 0:null===(e=k.sel_signal)||void 0===e?void 0:e.code)===D.hi.SIGNAL_0?(null==k?void 0:k.sel_crop)||o(!1):k.sel_municipality||o(!1))},[null==k?void 0:k.sel_municipality,null==k?void 0:k.sel_crop,null==k?void 0:k.sel_signal,i]);let J=()=>{X&&(d((0,N.s_)()),r.push("/admin/bulletins/crops/report/view/?docId=".concat(X.id)))},K=e=>{let{options:l,valueNotNull:i,labelFetch:n,labelSelect:a="Select a province",labelValue:t="Province"}=e,s=null!=n?n:"Loading...";return l.length>0&&(s=null===i?a:t),s};return(0,n.jsxs)("div",{children:[(0,n.jsx)(S.Z,{isOpen:F.isOpen,maxWidth:"xs",openButtonText:null,title:F.title,contentText:F.msg,loading:F.loading,modalCancelHandlerCB:()=>{F.savesuccess?J():Y()},modalConfirmHandlerCB:()=>{F.savesuccess?J():z()}}),(0,n.jsx)(y.Z,{open:E,pdfPreview:M,error:k.error,loading:k.loading,toggleViewerOpen:U}),(0,n.jsx)(L.Z,{openSnackbar:""!==k.error,message:k.error,severity:"warning"}),(0,n.jsxs)(h.ZP,{container:!0,sx:R.Z.container,children:[(0,n.jsxs)(m.Z,{sx:R.Z.headerText,children:[(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(_.Z,{variant:"h5",children:B}),(0,n.jsx)("p",{dangerouslySetInnerHTML:{__html:H}})]}),(0,n.jsx)(m.Z,{children:(0,n.jsx)(c(),{href:"/admin/bulletins/crops",passHref:!0,legacyBehavior:!0,children:(0,n.jsx)(x.Z,{"aria-label":"exit",size:"medium",children:(0,n.jsx)(u.Z,{fontSize:"inherit"})})})})]}),(0,n.jsxs)(h.ZP,{item:!0,sx:R.Z.item,xs:12,lg:4,children:[(0,n.jsx)(_.Z,{variant:"h6",children:"Selection Options"}),(0,n.jsx)(p.Z,{disablePortal:!0,id:"signal",size:"small",value:k.sel_signal,disabled:0===I.length||""!==k.error||j,options:I,sx:R.Z.autocomplete,PaperComponent:f.Z,renderInput:e=>(0,n.jsx)(b.Z,{...e,label:K({options:I,valueNotNull:null==k?void 0:k.sel_signal,labelSelect:"Select a wind signal",labelValue:"Wind Signal"})}),getOptionDisabled:e=>e.disabled,isOptionEqualToValue:(e,l)=>e.label===l,onChange:(e,l)=>{q(e,{...l,from:"signal"}),o(!1)}}),(0,n.jsx)(p.Z,{disablePortal:!0,id:"crop",size:"small",value:k.sel_crop,disabled:!(null==k?void 0:k.sel_signal)||0===T.length||""!==k.error||j,options:T,sx:R.Z.autocomplete,PaperComponent:f.Z,renderInput:e=>(0,n.jsx)(b.Z,{...e,label:K({options:T,valueNotNull:null==k?void 0:k.sel_crop,labelSelect:"Select crop",labelValue:"Crop"})}),getOptionDisabled:e=>e.disabled,isOptionEqualToValue:(e,l)=>e.label===l,onChange:(e,l)=>{q(e,{...l,from:"crop"}),o(!1)}}),(0,n.jsx)(p.Z,{disablePortal:!0,id:"province",size:"small",value:k.sel_province,disabled:0===C.length||!(null==k?void 0:k.sel_crop)||!(null==k?void 0:k.sel_signal)||(null==k?void 0:null===(l=k.sel_signal)||void 0===l?void 0:l.value)===0||""!==k.error||j,options:C,sx:R.Z.autocomplete,PaperComponent:f.Z,renderInput:e=>(0,n.jsx)(b.Z,{...e,label:K({options:C,valueNotNull:null==k?void 0:k.sel_province,labelFetch:"Select a province",labelSelect:"Select a province",labelValue:"Province"})}),getOptionDisabled:e=>e.disabled,isOptionEqualToValue:(e,l)=>e.label===l,onChange:(e,l)=>{q(e,{...l,from:"province"})}}),(0,n.jsx)(p.Z,{disablePortal:!0,id:"municipality",size:"small",value:k.sel_municipality,disabled:0===O.length||!(null==k?void 0:k.sel_crop)||""!==k.error||j,options:O,sx:R.Z.autocomplete,PaperComponent:f.Z,renderInput:e=>(0,n.jsx)(b.Z,{...e,label:null===k.sel_municipality?"Select a municipality":"Municipality"}),getOptionDisabled:e=>e.disabled||void 0!==e.iscalendar,isOptionEqualToValue:(e,l)=>e.label===l,onChange:(e,l)=>{q(e,{...l,from:"municipality"}),o(!1)}}),(0,n.jsxs)(v.Z,{disableElevation:!0,size:"small","aria-label":"outlined button controls group",disabled:Z||w,sx:{marginTop:"16px",float:"right"},children:[(0,n.jsx)(g.Z,{variant:"outlined",disabled:j||Z,onClick:V,children:"Reset"}),(0,n.jsx)(g.Z,{variant:"contained",onClick:()=>o(e=>!e),disabled:j||w||""!==k.error||i,children:"Generate"})]})]}),(0,n.jsx)(h.ZP,{item:!0,sx:R.Z.item,xs:12,lg:8,children:(0,n.jsx)(P.Z,{selecteditems:k,loading:j,reportType:"special"})})]}),(0,n.jsx)(A,{show:i,loading:j,options:k,smstext:G,isCreateDisabled:w,handlePreview:W,handleSave:Y})]})}k.propTypes={optsprovinces:r().array,optsmunicipalities:r().array,sel_options:r().object,loading:r().bool,isloadingreport:r().bool,isdisabled:r().bool,open:r().bool,message:r().object,smstext:r().string,pageTitle:r().string,pageDescription:r().string,pdfPreview:r().object,onSelectItemChange:r().func,handlePreview:r().func,handleSave:r().func,toggleViewerOpen:r().func,resetSelections:r().func,togglePrompt:r().func};var F=i(45773),G=i(65328),B=i(26525),H=i(88002),M=i(97416),W=i(75941),z=i(31695),V=i(32343),Y=i(9704),U=i(63867);let q=[{id:0,label:D.hl.general_no_signal,value:0,code:D.hi.SIGNAL_0,disabled:!1},{id:1,label:D.hl.signal_number_1,value:1,code:D.hi.SIGNAL_1,disabled:!0},{id:2,label:D.hl.signal_number_2,value:2,code:D.hi.SIGNAL_2,disabled:!0},{id:3,label:D.hl.signal_number_3,value:3,code:D.hi.SIGNAL_3,disabled:!0},{id:4,label:D.hl.signal_number_4,value:4,code:D.hi.SIGNAL_4,disabled:!0},{id:5,label:D.hl.signal_number_5,value:5,code:D.hi.SIGNAL_5,disabled:!0}];var X=i(22088);function J(e){let{crop:l,signal:i,type:n="special",isDispatch:s=!1}=e,[o,r]=(0,a.useState)([]),[d,c]=(0,a.useState)(!1),[u,p]=(0,a.useState)(""),g=(0,t.I0)();return(0,a.useEffect)(()=>{let e=async()=>{try{c(!0),g((0,V.nS)());let e=await (0,X.O_)({type:n,queryFields:[{field:"crop",op:"==",value:l},{field:"wind_signal",op:"==",value:i}]});if(c(!1),r(e),s&&g((0,V.lO)(e||[])),0===(e||[]).length)throw Error("No available recommendations")}catch(l){var e,a;p(null!==(a=null==l?void 0:null===(e=l.response)||void 0===e?void 0:e.data)&&void 0!==a?a:l.message),c(!1)}};l&&i&&e()},[l,i,n,s,g]),{recommendations:o,loading:d,error:u}}var K=i(18938),$=i(84325),Q=i(77457);let ee={url:"",filename:""},el={sel_province:null,sel_municipality:null,sel_crop:null,sel_signal:null,sel_typhoon:null,processed:!1,loading:!1,error:"",success:""};var ei=(0,G.Z)(function(e){var l,i;let{user:s,onBtnLogoutClick:o,loading:r}=e,[d,c]=(0,a.useState)(el),[u,p]=(0,a.useState)([]),{status:g,report:v}=(0,t.v9)(e=>e.reports),m=(0,t.v9)(e=>e.dashboard.reportType),h=(0,t.v9)(e=>e.dashboard.isEnglish),[x,b]=(0,a.useState)(!0),[_,f]=(0,a.useState)(!1),S=(0,a.useRef)(!1),[y,E]=(0,a.useState)(ee),[j,Z]=(0,a.useState)($.BF),w=(0,t.I0)(),[C,I]=(0,K.ky)(H.K.GLOBAL_COLLECTIONS,H.K.CYCLONE_ADVISORY),[A,P]=(0,K.ky)(B.M.WEATHER_FORECASTS,"".concat("mimaropa","/").concat(B.M.SUB_SPECIAL_COMMON,"/").concat(B.M.COMMON_SPECIAL_TYPE.WIND_SPEED)),{windSignals:L}=function(e){let l=!(arguments.length>1)||void 0===arguments[1]||arguments[1],[i,n]=(0,a.useState)([]),[t,s]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!l){if(0===(null!=e?e:[]).length)n(q);else{var i,a,t,o;let l=null==e?void 0:null===(a=e.data)||void 0===a?void 0:null===(i=a.signal)||void 0===i?void 0:i.map(e=>e.number);s(null==e?void 0:null===(o=e.data)||void 0===o?void 0:null===(t=o.meta)||void 0===t?void 0:t.typhoon_name),n(q.map(e=>({...e,disabled:0!==e.value&&!l.includes(e.value)})))}}},[e,l]),{windSignals:i,typhoon:t}}(C,I),{affectedprovinces:R}=function(e,l,i,n){let[t,s]=(0,a.useState)([]);return(0,a.useEffect)(()=>{if((null==e?void 0:e.data)&&(null==l?void 0:l.data)&&i.length>0&&null!==n){let l=e.data.filter(e=>e.signal===(null==n?void 0:n.value)).map(e=>e.province).filter((e,l,i)=>i.indexOf(e)===l),a=e.data.reduce((e,l)=>(void 0===e[l.province]&&(e[l.province]=[]),e[l.province]=[...e[l.province],...l.municipalities],{...e}),{}),t=[...i];t.forEach(i=>{i.disabled=!l.includes(i.label),i.municipalities.forEach(l=>{let n=e.data.findIndex(e=>e.province===l.province&&e.municipalities.includes(l.label));i.disabled?l.disabled=!0:(l.disabled=!a[i.label].includes(l.label),l.signal=n>-1?e.data[n].signal:0)})}),s(t)}},[e,l,i,n]),{affectedprovinces:t}}(A,C,u,null==d?void 0:d.sel_signal),G=(0,U.Z)(d.sel_province,R),{cropList:X,loading:ei}=(0,Y.Z)(),en=X.map((e,l)=>({disabled:!1,label:e,id:l})),ea=(0,a.useMemo)(()=>{var e,l;return((null===(e=d.sel_signal)||void 0===e?void 0:e.value)!==0||(null==d?void 0:d.sel_crop)===null)&&(!((null===(l=d.sel_signal)||void 0===l?void 0:l.value)>0)||!d.sel_province||!d.sel_municipality)},[d]),{loading:et,error:es}=J({type:"special",crop:null==d?void 0:d.sel_crop,signal:null==d?void 0:null===(l=d.sel_signal)||void 0===l?void 0:l.code,isDispatch:!0}),{recommendations:eo,loading:er,error:ed}=J({type:"special_sms",crop:null==d?void 0:d.sel_crop,signal:null==d?void 0:null===(i=d.sel_signal)||void 0===i?void 0:i.code}),ec=(0,a.useMemo)(()=>{if((null==eo?void 0:eo.length)>0&&C){var e,l,i;let n=eo[0].sms.replace("{{special_weather_name_identifier}}",null!==(i=null==C?void 0:null===(l=C.data)||void 0===l?void 0:null===(e=l.meta)||void 0===e?void 0:e.typhoon_name)&&void 0!==i?i:"-");return(null==d?void 0:d.sel_province)&&(null==d?void 0:d.sel_municipality)&&(n=n.replace("{{municipality_identifier}}","".concat(null==d?void 0:d.sel_province,", ").concat(null==d?void 0:d.sel_municipality))),n}return null},[eo,C,null==d?void 0:d.sel_province,null==d?void 0:d.sel_municipality]);(0,a.useEffect)(()=>(S.current=!0,(async()=>{try{let e=await (0,M.$m)();S&&p(e.data)}catch(e){}})(),()=>{S.current=!1}),[]),(0,a.useEffect)(()=>{w((0,V.nS)()),w((0,N.s_)())},[w]),(0,a.useEffect)(()=>{b(r||et||ei||er||I===T.G.PENDING||P===T.G.PENDING)},[r,et,ei,er,I,P]),(0,a.useEffect)(()=>{E(ee)},[h]),(0,a.useEffect)(()=>{if(""!==es){let e=es||ed;c(l=>({...l,error:e}))}else c(e=>({...e,error:""}))},[es,ed]),(0,a.useEffect)(()=>{g===T.G.FULLFILLED&&null!==v&&S.current&&Z(e=>({...e,msg:"Success! Bulletin report created.",loading:!1,savesuccess:!0,docId:v.id}))},[g,v]);let eu=async()=>{if(""!==y.url){f(!0);return}c(e=>({...e,loading:!0,error:"",success:""}));try{let e={region:"mimaropa",province:d.sel_province,municipality:d.sel_municipality,crop:d.sel_crop,language:h?"en":"tag",signal:null==d?void 0:d.sel_signal.code,operation:"preview"};f(!0),c(e=>({...e,loading:!0,error:""}));let l=await (0,z.U1)(e),i=new Blob([l],{type:"application/pdf"}),n={};n.href=URL.createObjectURL(i),n.download="".concat(d.sel_province,"_").concat(d.sel_municipality,".pdf"),E(e=>({...e,url:n.href,filename:n.download})),c(e=>({...e,loading:!1,success:"Bulletin preview created."}))}catch(l){let e=await (0,Q.fu)(l);c(l=>({...l,loading:!1,error:e}))}},ep=async()=>{Z({...j,loading:!0,msg:"Saving report..."});try{let e={region:"mimaropa",province:d.sel_province,municipality:d.sel_municipality,crop:d.sel_crop,language:h?"en":"tag",signal:null==d?void 0:d.sel_signal.code,operation:"create"};w((0,W.tR)(e)).unwrap().then(()=>{m!==$.Ry.SPECIAL_WEATHER&&(w((0,O.uq)($.Ry.SPECIAL_WEATHER)),w((0,W.RC)({uid:s.uid,type:$.Ry.SPECIAL_WEATHER})))}).catch(e=>{S.current&&Z(l=>({...l,msg:e,loading:!1,savesuccess:!1,docId:null}))})}catch(l){let e="";void 0!==l.response&&(e=void 0!==l.response.data&&"[object Blob]"==typeof l.response.data?l.response.data:""),""===e&&(e=l.message),c(l=>({...l,loading:!1,error:e}))}};return(0,n.jsx)(F.Z,{loading:r,user:s,onBtnLogoutClick:o,accLevel:D.DW.ADMIN,children:(0,n.jsx)(k,{optsprovinces:R,optsmunicipalities:G,optswindsignals:L,optscrops:en,sel_options:d,loading:x,isloadingreport:g===T.G.PENDING,isdisabled:ea,open:_,message:j,smstext:ec,pageTitle:"Special Weather Bulletin",pageDescription:"Create <strong>Special Weather</strong> crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download.",pdfPreview:y,onSelectItemChange:(e,l)=>{let{from:i,label:n}=l;if(E(ee),["signal","crop"].includes(i)&&w((0,V.nS)()),""!==d.error&&c(e=>({...e,error:""})),Object.keys(l).includes("id"))switch(i){case"signal":var a,t,s;c({...el,sel_signal:l,sel_typhoon:(null==l?void 0:l.code)===D.hi.SIGNAL_0?"(General - No Signal)":null!==(s=null==C?void 0:null===(t=C.data)||void 0===t?void 0:null===(a=t.meta)||void 0===a?void 0:a.typhoon_name)&&void 0!==s?s:"-"});break;case"crop":c(e=>({...e,sel_crop:n}));break;case"province":c(e=>({...e,sel_province:n,sel_municipality:null}));break;case"municipality":c(e=>({...e,sel_municipality:n}))}else"signal"===i?c(el):"crop"===i?c(e=>({...e,sel_crop:null})):"province"===i?c(e=>({...e,sel_province:null,sel_municipality:null})):"municipality"===i&&c(e=>({...e,sel_municipality:null}))},handlePreview:eu,handleSave:ep,toggleViewerOpen:()=>{f(e=>!e)},resetSelections:()=>{c(el),w((0,V.nS)())},togglePrompt:()=>{Z(e=>({...$.BF,isOpen:!e.isOpen}))}})})})},63867:function(e,l,i){"use strict";i.d(l,{Z:function(){return a}});var n=i(67294);function a(e,l){let[i,a]=(0,n.useState)([]);return(0,n.useEffect)(()=>{var i,n;a(e&&l&&null!==(n=null===(i=l.find(l=>l.label===e))||void 0===i?void 0:i.municipalities)&&void 0!==n?n:[])},[e,l]),i}},18938:function(e,l,i){"use strict";i.d(l,{Kx:function(){return o},ky:function(){return s},m$:function(){return r},tl:function(){return d}});var n=i(67294),a=i(36100),t=i(20988);function s(e,l){let[i,s]=(0,n.useState)(null),[o,r]=(0,n.useState)(!0),[d,c]=(0,n.useState)(""),u=(0,n.useRef)(!0);return(0,n.useEffect)(()=>((async()=>{try{let i=(0,a.JU)(t.db,e,l),n=await (0,a.QT)(i);u.current&&(n.exists()&&s(n.data()),r(!1))}catch(e){c(e.message),r(!1)}})(),()=>u.current=!1),[e,l]),[i,o,d]}function o(e,l){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,[o,r]=(0,n.useState)([]),[d,c]=(0,n.useState)(!0),[u,p]=(0,n.useState)(""),g=(0,n.useRef)(!0);return(0,n.useEffect)(()=>((async()=>{try{let n=[(0,a.Xo)(l,"asc")];s>0&&n.push((0,a.b9)(s));let o=(0,a.hJ)(t.db,e),d=i||(0,a.IO)(o,...n),u=await (0,a.PL)(d);g.current&&(r(u.docs.map(e=>({...e.data()}))),c(!1))}catch(e){p(e.message),c(!1)}})(),()=>g.current=!1),[e,l,i,s]),{documents:o,loading:d,error:u}}function r(e,l,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",[o,r]=(0,n.useState)([]),[d,c]=(0,n.useState)(!0),[u,p]=(0,n.useState)(""),g=(0,n.useRef)(!0);return(0,n.useEffect)(()=>((async()=>{try{let n=(0,a.IO)((0,a.hJ)(t.db,e,l,i),(0,a.Xo)(s)),o=await (0,a.PL)(n);g.current&&(r(o.docs.map(e=>({...e.data()}))),c(!1))}catch(e){p(e.message),c(!1)}})(),()=>g.current=!1),[e,l,i,s]),{documents:o,loading:d,error:u}}function d(e,l,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4?arguments[4]:void 0,[r,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(!0),[p,g]=(0,n.useState)(""),v=(0,n.useRef)(!0);return(0,n.useEffect)(()=>((async()=>{try{let n=(0,a.hJ)(t.db,e,l,i);""!==s&&(n=(0,a.IO)(n,(0,a.Xo)(s))),o&&(n=(0,a.IO)(n,(0,a.b9)(o)));let r=await (0,a.PL)(n);v.current&&(d(r.docs.map(e=>({...e.data()}))),u(!1))}catch(e){g(e.message),u(!1)}})(),()=>v.current=!1),[e,l,i,s,o]),{documents:r,loading:c,error:p}}},88002:function(e,l,i){"use strict";i.d(l,{K:function(){return o},d:function(){return r}});var n=i(96171),a=i(20988),t=i(98813),s=i(84325);let o={MEDIA_ASSETS:"n_page_media",ASSETS:"n_page_assets",PAGE_SEARCH:"n_page_search",GLOBAL_COLLECTIONS:"w_services",TYPHOON_ADVISORY:"typhoon_advisory",CYCLONE_ADVISORY:"cyclone_advisory"};class r extends n.Z{constructor(...e){var l;super(...e),l=this,this.getPageAssetsDoc=async function(e,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[];try{if(!(a=await l.getDocumentData(o.ASSETS,e)))return[];if(!i)return a;if(n)return a.data.filter(e=>e.page===i);return a.data.filter(e=>e.page===i).map(e=>e.url)}catch(e){throw console.error(e.message),Error(e.message)}},this.getTyphoonAdvisory=async()=>{let e=this.doc(this.db,o.GLOBAL_COLLECTIONS,o.TYPHOON_ADVISORY),l=await this.getDoc(e);return l.exists()?l.data():null},this.getWeatherForecast=async(e,l)=>await this.getNestedCollectionData(o.WEATHER_FORECASTS,e,l,"name"),this.getPdfDownloadURL=async function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.Ry.SEASONAL,i="";switch(l){case s.Ry.SEASONAL:i=t.Do.PDF_STORAGE_SEASONAL;break;case s.Ry.TEN_DAY:i=t.Do.PDF_STORAGE_TENDAY;break;case s.Ry.SPECIAL_WEATHER:i=t.Do.PDF_STORAGE_SPECIAL}try{let l=(0,a.iH)(a.tO,"".concat(i,"/").concat(e));return await (0,a.Jt)(l)}catch(e){throw Error(e.message)}}}}}},function(e){e.O(0,[3153,6856,190,8583,1664,6541,955,4073,2380,5837,6080,3481,3338,8591,4381,2888,9774,179],function(){return e(e.s=45379)}),_N_E=e.O()}]);