(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{45039:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops",function(){return n(46424)}])},7520:function(e,t,n){"use strict";var i=n(85893),s=n(93454);let r=(0,n(77527).ZP)(e=>(0,i.jsx)(s.Z,{...e}))(e=>{let{theme:t}=e;return{padding:t.spacing(3),borderRadius:t.spacing(1),backgroundColor:"#fff",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",border:"1px solid ".concat(t.palette.bacap.border)}});t.Z=r},93428:function(e,t,n){"use strict";var i=n(64836);t.Z=void 0;var s=i(n(33651)),r=n(85893);t.Z=(0,s.default)([(0,r.jsx)("path",{d:"M5 5v14h14V5zm9 12H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z",opacity:".3"},"0"),(0,r.jsx)("path",{d:"M7 15h7v2H7zm0-4h10v2H7zm0-4h10v2H7zm12-4h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-.14 0-.27.01-.4.04-.39.08-.74.28-1.01.55-.18.18-.33.4-.43.64S3 4.72 3 5v14c0 .27.06.54.16.78s.25.45.43.64c.27.27.62.47 1.01.55.13.02.26.03.4.03h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7-.25c.41 0 .75.34.75.75s-.34.75-.75.75-.75-.34-.75-.75.34-.75.75-.75M19 19H5V5h14z"},"1")],"AssignmentTwoTone")},22209:function(e,t,n){"use strict";var i=n(64836);t.Z=void 0;var s=i(n(33651)),r=n(85893);t.Z=(0,s.default)((0,r.jsx)("path",{d:"M14.5 2.5c0 1.5-1.5 6-1.5 6h-2S9.5 4 9.5 2.5C9.5 1.12 10.62 0 12 0s2.5 1.12 2.5 2.5M12 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m4.08-4.89c.18-.75.33-1.47.39-2.06C19.75 4.69 22 8.08 22 12c0 5.52-4.48 10-10 10S2 17.52 2 12c0-3.92 2.25-7.31 5.53-8.95.07.59.21 1.32.39 2.06C5.58 6.51 4 9.07 4 12c0 4.42 3.58 8 8 8s8-3.58 8-8c0-2.93-1.58-5.49-3.92-6.89M18 12c0 3.31-2.69 6-6 6s-6-2.69-6-6c0-2 .98-3.77 2.48-4.86.23.81.65 2.07.65 2.07C8.43 9.93 8 10.92 8 12c0 2.21 1.79 4 4 4s4-1.79 4-4c0-1.08-.43-2.07-1.13-2.79 0 0 .41-1.22.65-2.07C17.02 8.23 18 10 18 12"}),"CrisisAlert")},71687:function(e,t,n){"use strict";var i=n(64836);t.Z=void 0;var s=i(n(33651)),r=n(85893);t.Z=(0,s.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever")},28817:function(e,t,n){"use strict";var i=n(64836);t.Z=void 0;var s=i(n(33651)),r=n(85893);t.Z=(0,s.default)([(0,r.jsx)("path",{d:"M13 4H6v16h12V9h-5zm3 14H8v-2h8zm0-6v2H8v-2z",opacity:".3"},"0"),(0,r.jsx)("path",{d:"M8 16h8v2H8zm0-4h8v2H8zm6-10H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5z"},"1")],"DescriptionTwoTone")},46424:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return G}});var i=n(85893),s=n(67294),r=n(9473),a=n(65328),l=n(11163),c=n(60990),o=n(51015),d=n(41664),u=n.n(d),p=n(68573),h=n(96788),x=n(77527),v=n(41796);let m=(0,x.ZP)(e=>(0,i.jsx)(p.ZP,{...e}))(e=>{let{theme:t}=e;return{textAlign:"center",cursor:"pointer",borderRadius:t.spacing(1),padding:t.spacing(2),"& a":{color:"rgba(0, 0, 0, 0.87)",textDecoration:"none"},"& a:visited":{color:"rgba(0, 0, 0, 0.87)"},"& h6":{lineHeight:t.spacing(3)},"& svg":{color:t.palette.secondary.main},"&:hover, &:focus":{backgroundColor:(0,v.Fq)(t.palette.secondary.light,.3)}}});var f=n(16729),y=n(93428),j=n(28817),b=n(22209),g=function(){return(0,i.jsx)("div",{children:(0,i.jsx)(f.Z,{maxWidth:"sm",openButtonText:"Generate Bulletin",title:"Select a Crop Bulletin Type",showButtons:!1,colorTheme:"secondary",children:(0,i.jsxs)(p.ZP,{container:!0,children:[(0,i.jsx)(m,{item:!0,xs:12,sm:4,children:(0,i.jsx)(u(),{href:"/admin/bulletins/crops/seasonal/create",passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)("a",{children:[(0,i.jsx)(y.Z,{sx:{fontSize:"90px"}}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"Seasonal Climate"}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"Outlook and Advisory"})]})})}),(0,i.jsx)(m,{item:!0,xs:12,sm:4,children:(0,i.jsx)(u(),{href:"/admin/bulletins/crops/tenday/create",passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)("a",{children:[(0,i.jsx)(j.Z,{sx:{fontSize:"90px"}}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"10-Day Farm Weather Outlook"}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"and Advisory"})]})})}),(0,i.jsx)(m,{item:!0,xs:12,sm:4,children:(0,i.jsx)(u(),{href:"/admin/bulletins/crops/tenday/batch",passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)("a",{children:[(0,i.jsx)(j.Z,{sx:{fontSize:"90px"}}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"10-Day Batch Generate"}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"All Municipalities"})]})})}),(0,i.jsx)(m,{item:!0,xs:12,sm:4,children:(0,i.jsx)(u(),{href:"/admin/bulletins/crops/special/create",passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)("a",{children:[(0,i.jsx)(b.Z,{sx:{fontSize:"90px"}}),(0,i.jsx)(h.Z,{variant:"subtitle1",children:"Special Weather Advisory"})]})})})]})})})},Z=n(6897),C=n(94143),S=n(15972),w=n(7520),z=n(29346),H=n(17553),D=n(84325),_=n(71687),E=n(42176),M=n(6132),T=n(50853),N=n(64740),I=n(25517);function R(e){let{onDeleteSelected:t,selectedCount:n,disableDelete:s}=e;return(0,i.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,i.jsxs)(E.D,{...e,children:[(0,i.jsx)(M.S,{}),(0,i.jsx)(T.M,{})]}),(0,i.jsxs)(o.Z,{variant:"contained",color:"error",size:"small",startIcon:(0,i.jsx)(_.Z,{}),disabled:s,onClick:t,children:["Delete Selected (",n,")"]})]})}var A=function(e){let{rows:t,columns:n,message:a,resetMessage:o,handleTypeChange:d,onSelectionChange:u,selectedCount:p,onDeleteSelected:x,selectionModel:v}=e,[m,f]=(0,s.useState)(D.Ry.SEASONAL),y=(0,r.v9)(e=>e.reports.status),j=(0,r.v9)(e=>e.dashboard.reportType),b=(0,l.useRouter)();return(0,s.useEffect)(()=>{f(j)},[j]),(0,i.jsxs)("div",{children:[(0,i.jsx)(H.Z,{openSnackbar:""!==a,message:a,severity:"info",closeHandlerCB:o}),(0,i.jsx)(h.Z,{variant:"h5",children:"Generate Bulletin"}),(0,i.jsxs)("p",{children:["Create and preview ",(0,i.jsx)("strong",{children:"10-Day"})," and ",(0,i.jsx)("strong",{children:"Seasonal"})," crop bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]}),(0,i.jsxs)(w.Z,{sx:{display:"flex",flexDirection:{sm:"column",md:"row"},justifyContent:"space-between",alignItems:"center",padding:"8px 16px 8px 24px"},children:[(0,i.jsx)(g,{}),(0,i.jsxs)(Z.Z,{sx:{m:1,width:{xs:"100%",sm:"100%",md:300}},size:"small",children:[(0,i.jsx)(C.Z,{id:"report-type",children:"Bulletin Type"}),(0,i.jsxs)(z.Z,{labelId:"report-type",id:"report-type",value:m,label:"Bulletin Type",onChange:d,children:[(0,i.jsx)(S.Z,{value:D.Ry.SEASONAL,children:"Seasonal Crop Recommendations"}),(0,i.jsx)(S.Z,{value:D.Ry.TEN_DAY,children:"10-Day Crop Recommendations"}),(0,i.jsx)(S.Z,{value:D.Ry.SPECIAL_WEATHER,children:"Special Weather Recommendations"})]})]})]}),(0,i.jsx)(c.Z,{style:{height:678,width:"100%",textAlign:"left"},children:(0,i.jsx)(w.Z,{sx:{height:"inherit",marginTop:"16px"},children:(0,i.jsx)(N._,{rows:t,columns:n,disableDensitySelector:!0,checkboxSelection:!0,disableSelectionOnClick:!0,pageSize:10,rowsPerPageOptions:[10],components:{Toolbar:R},componentsProps:{toolbar:{onDeleteSelected:x,selectedCount:p,disableDelete:0===p||y===I.G.PENDING}},loading:y===I.G.PENDING,rowHeight:48,selectionModel:v,onSelectionModelChange:e=>u(e),initialState:{columns:{columnVisibilityModel:{rowId:!1}}},onRowClick:e=>{y!==I.G.PENDING&&b.push({pathname:"/admin/bulletins/crops/report/view",query:{docId:e.row.docId}})}})})})]})},B=n(45773),k=n(75941),L=n(46560),P=n(98813),G=(0,a.Z)(function(e){let[t,n]=(0,s.useState)([]),[a,l]=(0,s.useState)([]),[c,o]=(0,s.useState)(""),[d,u]=(0,s.useState)([]),p=(0,r.v9)(e=>e.dashboard.reportType),h=(0,s.useRef)(!1),x=(0,s.useRef)(!1),v=(0,r.I0)(),{ids:m,entities:f,status:y}=(0,r.v9)(e=>e.reports);(0,s.useEffect)(()=>(h.current=!0,()=>{h.current=!1}),[]),(0,s.useEffect)(()=>{null===e.user||e.loading||0!==m.length||x.current||(x.current=!0,v((0,k.RC)({uid:e.user.uid,type:p})))},[e.user,e.loading,m,p,v]),(0,s.useEffect)(()=>{if([I.G.FULLFILLED,I.G.IDLE].includes(y)&&m.length>0){let e={crop:"Crop",province:"Province",municipality:"Municipality",type:"Bulletin Type",updated_by:"Updated by",date_created:"Date Created"},t={province:180,municipality:180,type:110,date_created:200},i=[];["crop","province","municipality","type","updated_by","date_created"].forEach(n=>{i.push({field:n,headerName:e[n],minWidth:t[n],flex:void 0===t[n]?1:0,editable:!1,sortable:!1,disableColumnMenu:!0})});let s=m.map((e,t)=>({id:t,docId:f[e].id,crop:f[e].crop,province:f[e].province,municipality:f[e].municipality,type:f[e].type,updated_by:f[e].updated_by,date_created:f[e].date_created}));h.current&&(n(s),l(i))}},[y,m,f]);let j=async()=>{if(0===d.length)return;let n=t.filter(e=>d.includes(e.id)).map(e=>e.docId);0!==n.length&&window.confirm("Delete ".concat(n.length," report(s) and related bulletins? This cannot be undone."))&&v((0,k.bb)(n)).unwrap().then(t=>{var n;o("Deleted ".concat((null===(n=t.deleted)||void 0===n?void 0:n.length)||0," report(s).")),u([]),v((0,k.RC)({uid:e.user.uid,type:p}))}).catch(e=>{o((null==e?void 0:e.message)||"Failed to delete reports.")})};return(0,i.jsx)(B.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,accLevel:P.DW.ADMIN,children:(0,i.jsx)(A,{rows:t,columns:a,loadingReports:y===I.G.PENDING,message:c,resetMessage:()=>o(""),handleTypeChange:t=>{let{value:n}=t.target;v((0,k.RC)({uid:e.user.uid,type:n})).unwrap().then(e=>{e.length>0&&v((0,L.uq)(n))}).catch(()=>{o("No ".concat(n," reports are available."))})},onSelectionChange:e=>{u(e)},selectedCount:d.length,onDeleteSelected:j,selectionModel:d})})})}},function(e){e.O(0,[3153,7023,3745,1664,6541,8848,6294,6905,5837,9998,4723,837,3539,4740,8591,4313,2888,9774,179],function(){return e(e.s=45039)}),_N_E=e.O()}]);