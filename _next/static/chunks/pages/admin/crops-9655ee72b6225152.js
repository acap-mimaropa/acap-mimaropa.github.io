(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7794,7595],{67142:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/crops",function(){return l(72330)}])},72330:function(e,a,l){"use strict";l.r(a);var n=l(85893),r=l(67294),t=l(60990),s=l(96788),i=l(51015),o=l(44723),d=l(60762),c=l(71919),u=l(97182),p=l(25026),h=l(93454),b=l(76592),C=l(70360),x=l(46577),m=l(8863),y=l(19827),f=l(13539),g=l(52857),Z=l(33453),j=l(92365),w=l(40110),v=l(26541),S=l(96727),A=l(53839),k=l(17071),N=l(89090),P=l(45773),D=l(65328),E=l(77595);a.default=(0,D.Z)(function(e){let{user:a,onBtnLogoutClick:l,loading:D}=e,[T,_]=(0,r.useState)([]),[O,R]=(0,r.useState)(!0),[F,L]=(0,r.useState)(""),[q,I]=(0,r.useState)(""),[z,M]=(0,r.useState)(!1),[U,W]=(0,r.useState)(null),[X,B]=(0,r.useState)({name:"",label:"",enabled:!0});(0,r.useEffect)(()=>{H()},[]);let H=async()=>{try{R(!0);let e=await (0,E.Rd)();_(e),L("")}catch(e){L("Failed to load crops: "+e.message)}finally{R(!1)}},G=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(W(e),B({name:e.name,label:e.label,enabled:e.enabled})):(W(null),B({name:"",label:"",enabled:!0})),M(!0)},J=()=>{M(!1),W(null),B({name:"",label:"",enabled:!0})},K=async()=>{try{if(L(""),I(""),!X.name||!X.label){L("Name and Label are required");return}U?(await (0,E.Ak)(U.id,X),I("Crop updated successfully")):(await (0,E.e)(X),I("Crop added successfully")),await H(),J()}catch(e){L("Failed to save crop: "+e.message)}},Q=async e=>{try{L(""),await (0,E.Ak)(e.id,{enabled:!e.enabled}),await H(),I("Crop ".concat(e.enabled?"disabled":"enabled"," successfully"))}catch(e){L("Failed to update crop: "+e.message)}},V=async e=>{if(confirm('Are you sure you want to disable "'.concat(e.label,'"?')))try{L(""),await (0,E.aD)(e.id),await H(),I("Crop disabled successfully")}catch(e){L("Failed to delete crop: "+e.message)}};return(0,n.jsx)(P.Z,{user:a,onBtnLogoutClick:l,loading:D,children:(0,n.jsxs)(t.Z,{sx:{p:3},children:[(0,n.jsxs)(t.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,n.jsx)(s.Z,{variant:"h4",children:"Crops Management"}),(0,n.jsx)(i.Z,{variant:"contained",color:"primary",startIcon:(0,n.jsx)(A.Z,{}),onClick:()=>G(),children:"Add New Crop"})]}),F&&(0,n.jsx)(o.Z,{severity:"error",sx:{mb:2},onClose:()=>L(""),children:F}),q&&(0,n.jsx)(o.Z,{severity:"success",sx:{mb:2},onClose:()=>I(""),children:q}),(0,n.jsx)(d.Z,{children:(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(s.Z,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Manage crops available in the system. Only enabled crops will appear in dropdowns throughout the application."}),O?(0,n.jsx)(t.Z,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,n.jsx)(u.Z,{})}):(0,n.jsx)(p.Z,{component:h.Z,children:(0,n.jsxs)(b.Z,{children:[(0,n.jsx)(C.Z,{children:(0,n.jsxs)(x.Z,{children:[(0,n.jsx)(m.Z,{children:"Name"}),(0,n.jsx)(m.Z,{children:"Label"}),(0,n.jsx)(m.Z,{children:"Status"}),(0,n.jsx)(m.Z,{align:"right",children:"Actions"})]})}),(0,n.jsx)(y.Z,{children:T.map(e=>(0,n.jsxs)(x.Z,{children:[(0,n.jsx)(m.Z,{children:e.name}),(0,n.jsx)(m.Z,{children:e.label}),(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(f.Z,{checked:e.enabled,onChange:()=>Q(e),color:"primary"}),e.enabled?"Enabled":"Disabled"]}),(0,n.jsxs)(m.Z,{align:"right",children:[(0,n.jsx)(g.Z,{color:"primary",onClick:()=>G(e),size:"small",children:(0,n.jsx)(k.Z,{})}),(0,n.jsx)(g.Z,{color:"error",onClick:()=>V(e),size:"small",children:(0,n.jsx)(N.Z,{})})]})]},e.id))})]})})]})}),(0,n.jsxs)(Z.Z,{open:z,onClose:J,maxWidth:"sm",fullWidth:!0,children:[(0,n.jsx)(j.Z,{children:U?"Edit Crop":"Add New Crop"}),(0,n.jsx)(w.Z,{children:(0,n.jsxs)(t.Z,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,n.jsx)(v.Z,{label:"Crop Name",value:X.name,onChange:e=>B({...X,name:e.target.value}),disabled:!!U,required:!0,helperText:"Unique identifier (e.g., Rice, Corn)"}),(0,n.jsx)(v.Z,{label:"Display Label",value:X.label,onChange:e=>B({...X,label:e.target.value}),required:!0,helperText:"Human-readable label shown in dropdowns"}),(0,n.jsxs)(t.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(f.Z,{checked:X.enabled,onChange:e=>B({...X,enabled:e.target.checked}),color:"primary"}),(0,n.jsx)(s.Z,{children:"Enabled"})]})]})}),(0,n.jsxs)(S.Z,{children:[(0,n.jsx)(i.Z,{onClick:J,children:"Cancel"}),(0,n.jsx)(i.Z,{onClick:K,variant:"contained",color:"primary",children:U?"Update":"Add"})]})]})]})})})},77595:function(e,a,l){"use strict";l.d(a,{e:function(){return d},aD:function(){return u},Rd:function(){return o},getCrops:function(){return i},Ak:function(){return c}});var n=l(96171);let r={CONSTANTS:"constants",CROPS:"crops"};class t extends n.Z{async getCrops(){try{var e;let a=await this.getDocumentData(r.CONSTANTS,r.CROPS);if(null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.crops)return a.data.crops.filter(e=>!1!==e.enabled);return this.getDefaultCrops()}catch(e){return console.error("Error fetching crops:",e),this.getDefaultCrops()}}async getAllCrops(){try{var e;let a=await this.getDocumentData(r.CONSTANTS,r.CROPS);if(null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.crops)return a.data.crops;return this.getDefaultCrops()}catch(e){return console.error("Error fetching all crops:",e),this.getDefaultCrops()}}async updateCrops(e){try{let a=this.doc(this.db,r.CONSTANTS,r.CROPS);await this.updateDoc(a,{crops:e})}catch(e){throw console.error("Error updating crops:",e),e}}async addCrop(e){try{let a=await this.getAllCrops(),l={id:e.name,name:e.name,label:e.label||e.name,enabled:!1!==e.enabled};a.push(l),await this.updateCrops(a)}catch(e){throw console.error("Error adding crop:",e),e}}async updateCrop(e,a){try{let l=await this.getAllCrops(),n=l.findIndex(a=>a.id===e);-1!==n&&(l[n]={...l[n],...a},await this.updateCrops(l))}catch(e){throw console.error("Error updating crop:",e),e}}async deleteCrop(e){try{await this.updateCrop(e,{enabled:!1})}catch(e){throw console.error("Error deleting crop:",e),e}}getDefaultCrops(){return[{id:"Rice",name:"Rice",label:"Rice",enabled:!0},{id:"Corn",name:"Corn",label:"Corn",enabled:!0},{id:"Pili",name:"Pili",label:"Pili",enabled:!1},{id:"Ampalaya",name:"Ampalaya",label:"Ampalaya",enabled:!1},{id:"PoleSitao",name:"PoleSitao",label:"Pole Sitao",enabled:!1},{id:"Cassava",name:"Cassava",label:"Cassava",enabled:!1},{id:"Coconut",name:"Coconut",label:"Coconut",enabled:!1},{id:"Pineapple",name:"Pineapple",label:"Pineapple",enabled:!1},{id:"Abaca",name:"Abaca",label:"Abaca",enabled:!1},{id:"Cut-flowers",name:"Cut-flowers",label:"Cut Flowers",enabled:!1},{id:"Livestock",name:"Livestock",label:"Livestock",enabled:!1},{id:"Poultry",name:"Poultry",label:"Poultry",enabled:!1},{id:"Fisheries",name:"Fisheries (brackish and freshwater)",label:"Fisheries (brackish and freshwater)",enabled:!1}]}}let s=new t,i=()=>s.getCrops(),o=()=>s.getAllCrops(),d=e=>s.addCrop(e),c=(e,a)=>s.updateCrop(e,a),u=e=>s.deleteCrop(e)}},function(e){e.O(0,[3153,6856,190,8583,1664,6541,955,4073,6455,6080,4723,9227,8796,8591,2888,9774,179],function(){return e(e.s=67142)}),_N_E=e.O()}]);