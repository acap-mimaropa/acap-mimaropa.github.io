(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5740],{91099:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/sms",function(){return n(20155)}])},29365:function(e,t){"use strict";t.Z={button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"48px"}},container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",margin:"auto",borderColor:"#E2E8F0"},tabsContainer:{marginTop:e=>e.spacing(8),border:e=>"1px solid ".concat(e.palette.bacap.border),minHeight:"800px",borderRadius:"8px",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px"},customizedButtonLink:{cursor:"pointer",color:"#8BC24A",textDecoration:"underline",fontWeight:600}}},65328:function(e,t,n){"use strict";var i=n(85893),s=n(67294),a=n(11163),r=n(18853),l=n(98813);t.Z=function(e){function t(t){let n=(0,r.aC)(),o=(0,a.useRouter)();(0,s.useEffect)(()=>{if(!n.loading&&!n.user){let e=o.pathname.includes("/superadmin")?"/superadmin/login":"/admin/login";o.push(e)}n.user&&(n.user.accountlevel===l.DW.ADMIN&&o.pathname.includes("/superadmin")&&o.push("/unauthorized"),n.user.accountlevel===l.DW.SUPERADMIN&&o.pathname.includes("/admin")&&o.push("/unauthorized"))},[n.user,n.loading,o]);let c=async()=>{try{await n.logOut()}catch(e){}};return(0,i.jsx)(e,{...t,loading:n.loading,user:n.user,onBtnLogoutClick:c})}return t.customLayout=!0,t.adminPage=!0,t}},45773:function(e,t,n){"use strict";n.d(t,{Z:function(){return z}});var i=n(85893),s=n(60990),a=n(67294),r=n(14237),l=n(11032),o=n(56912),c=n(37958),d=n(47407),u=n(7638),x=n(32200),h=n(52311),p=n(88539),m=n(41664),j=n.n(m),g=n(11163),b=n(98813),v=n(29943),f=n(3916),Z=n(62967),y=n(14556),C=n(83108),S=n(93535),E=n(53916),k=n(22824),w=n(74972),T=n(93668);let R=[{text:"Get Started",link:"/admin",icon:(0,i.jsx)(Z.Z,{})},{text:"ACAP Settings",link:"/admin/weather",icon:(0,i.jsx)(S.Z,{})},{text:"Generate Bulletin",link:"/admin/bulletins/crops",icon:(0,i.jsx)(C.Z,{})},{text:"SMS Management",link:"/admin/sms",icon:(0,i.jsx)(y.Z,{})},{text:"Cropping Calendars",link:"/admin/cropping-calendars",icon:(0,i.jsx)(k.Z,{})},{text:"Crops Management",link:"/admin/crops",icon:(0,i.jsx)(T.Z,{})},{text:"Manage Recommendations",link:"/admin/manage-recommendations",icon:(0,i.jsx)(w.Z,{})}],N=[{text:"Profile",link:"/admin/profile",icon:(0,i.jsx)(E.Z,{})}];var _=n(58505);let D=[{text:"Get Started",link:"/superadmin",icon:(0,i.jsx)(Z.Z,{})},{text:"Users",link:"/superadmin/users",icon:(0,i.jsx)(_.Z,{})}],M=[{text:"Profile",link:"/superadmin/profile",icon:(0,i.jsx)(E.Z,{})}];var A=n(41796),O={padding:e=>e.spacing(1),width:"100%","& a":{textDecoration:"none",color:"rgba(0, 0, 0, 0.87)"},"& .MuiListItemButton-root:hover":{backgroundColor:e=>e.palette.primary.light},"& .Mui-selected":{backgroundColor:e=>"".concat((0,A.Fq)(e.palette.primary.light,.3)," !important")},"& .listitembutton-styled":{py:0,minHeight:48,color:e=>e.palette.primary.dark,borderRadius:e=>e.spacing(1),margin:e=>e.spacing(1),"&:hover, &:focus":{"& .MuiTypography-root":{color:e=>e.palette.primary.main}},"& a":{color:e=>e.palette.primary.dark}},"& .MuiListItemIcon-root":{marginRight:"-8px"},"@media (max-width: 600px)":{padding:"2px",width:"100vw"}};let I=[{text:"ACAP Website",link:"/",icon:(0,i.jsx)(v.Z,{})},{text:"Logout",link:"#",icon:(0,i.jsx)(f.Z,{})}];function L(e){let{window:t}=e,[n,m]=(0,a.useState)(!1),[v,f]=(0,a.useState)(null),Z=(0,g.useRouter)(),{user:y,onBtnLogoutClick:C}=e,S=(0,a.useMemo)(()=>{if(y)return y.accountlevel===b.DW.ADMIN?R:D},[y]),E=(0,a.useMemo)(()=>{if(y)return[...y.accountlevel===b.DW.ADMIN?N:M,...I]},[y]);(0,a.useEffect)(()=>{if(!(null==Z?void 0:Z.route)||!S||!E)return;let e=[...S,...E].find(e=>e.link===Z.route);f(null==e?void 0:e.link)},[e.user.accountlevel,Z.route,S,E]);let k=(0,i.jsxs)("div",{children:[(0,i.jsx)(p.Z,{}),(0,i.jsx)(o.Z,{}),(0,i.jsx)(d.Z,{sx:O,disablePadding:!0,children:S.map(e=>(0,i.jsx)(j(),{href:e.link,passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)(h.Z,{className:"listitembutton-styled",selected:v===e.link,children:[(0,i.jsx)(u.Z,{sx:{color:"inherit"},children:e.icon}),(0,i.jsx)(x.Z,{primaryTypographyProps:{fontSize:14,fontWeight:"medium"},children:e.text})]},e.label)},e.link))}),(0,i.jsx)(o.Z,{}),(0,i.jsx)(d.Z,{sx:O,children:E.map((e,t)=>"Logout"===e.text?(0,i.jsx)(j(),{href:e.link,passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)(h.Z,{className:"listitembutton-styled",selected:v===e.link,onClick:C,children:[(0,i.jsx)(u.Z,{sx:{color:"inherit"},children:e.icon}),(0,i.jsx)(x.Z,{primary:e.text,primaryTypographyProps:{fontSize:14,fontWeight:"medium"}})]})},e.link):(0,i.jsx)(j(),{href:e.link,passHref:!0,legacyBehavior:!0,children:(0,i.jsxs)(h.Z,{className:"listitembutton-styled",selected:v===e.link,children:[(0,i.jsx)(u.Z,{sx:{color:"inherit"},children:e.icon}),(0,i.jsx)(x.Z,{primaryTypographyProps:{fontSize:14,fontWeight:"medium"},children:e.text})]})},t))})]});return(0,i.jsxs)(s.Z,{sx:{display:"flex"},children:[(0,i.jsx)(r.ZP,{}),(0,i.jsxs)(s.Z,{component:"nav",sx:{width:{sm:280},flexShrink:{sm:0}},"aria-label":"mailbox folders",children:[(0,i.jsx)(c.ZP,{container:void 0!==t?()=>t().document.body:void 0,variant:"temporary",open:n,onClose:()=>{m(!n)},ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:280}},children:k}),(0,i.jsx)(c.ZP,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:280,boxShadow:"0px 0px 20px rgb(1 41 112 / 10%)",color:"#444444",border:"none",backgroundColor:"#fff"}},open:!0,children:k})]}),(0,i.jsx)(s.Z,{component:"main",sx:{flexGrow:1,padding:{xs:"16px 0 0 0",sm:"24px 24px 24px 24px"},width:{sm:"calc(100% - ".concat(280,"px)")}},children:(0,i.jsx)(l.Z,{maxWidth:"lg",children:e.children})})]})}var P=n(85229),z=function(e){return(0,i.jsxs)(s.Z,{sx:{marginTop:e=>e.spacing(4)},children:[e.loading&&(0,i.jsx)(P.Z,{}),!e.loading&&e.user&&e.user.accountlevel===e.accLevel&&(0,i.jsx)(L,{user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,children:e.children})]})}},85229:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var i=n(85893),s=n(60990),a=n(97182),r=n(96788),l={width:"100%",backgroundColor:"#fff",minHeight:"50vh",display:"grid",placeItems:"center"},o={display:"flex",justifyContent:"center",alignItems:"center"},c=function(e){let{sx:t}=e;return(0,i.jsx)(s.Z,{sx:{...l,...t&&{...t}},children:(0,i.jsxs)(s.Z,{sx:o,children:[(0,i.jsx)(r.Z,{variant:"subtitle1",children:"Loading..."}),(0,i.jsx)(a.Z,{size:"32px"})]})})}},17553:function(e,t,n){"use strict";var i=n(85893),s=n(67294),a=n(45697),r=n.n(a),l=n(70760),o=n(44723);let c=s.forwardRef(function(e,t){return(0,i.jsx)(o.Z,{elevation:6,ref:t,variant:"filled",...e})});function d(e){let{openSnackbar:t,message:n,severity:a="info",closeHandlerCB:r=()=>{}}=e,[o,d]=(0,s.useState)(t);(0,s.useEffect)(()=>{d(t)},[t]);let u=()=>{d(!1),r()},x=function(e){if(null==e)return"";if("string"==typeof e)return e;if(e instanceof Error)return e.message||e.toString();if("object"==typeof e&&"string"==typeof e.message)return e.message;try{return JSON.stringify(e)}catch(t){return String(e)}}(n);return(0,i.jsx)(l.Z,{open:o,autoHideDuration:3e3,onClose:u,children:(0,i.jsx)(c,{onClose:u,severity:a,sx:{width:"100%"},children:x})})}d.propTypes={openSnackbar:r().bool,message:r().any,severity:r().string,closeHandlerCB:r().func},t.Z=d},43691:function(e,t,n){"use strict";n.d(t,{x:function(){return a},P:function(){return r}});var i=n(85893),s=n(60990),a=function(e){let{children:t,value:n,index:a,...r}=e;return(0,i.jsx)("div",{role:"tabpanel",hidden:n!==a,id:"custom-tabpanel-".concat(a),"aria-labelledby":"custom-tab-".concat(a),...r,children:n===a&&(0,i.jsx)(s.Z,{sx:{p:3},children:t})})},r=function(e){return{id:"custom-tab-".concat(e),"aria-controls":"custom-tabpanel-".concat(e)}}},95858:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var i=n(63366),s=n(87462),a=n(67294),r=n(90512),l=n(94780),o=n(77527),c=n(83008),d=n(44001),u=n(96788),x=n(1588),h=n(34867);function p(e){return(0,h.ZP)("MuiDialogContentText",e)}(0,x.Z)("MuiDialogContentText",["root"]);var m=n(85893);let j=["children","className"],g=e=>{let{classes:t}=e,n=(0,l.Z)({root:["root"]},p,t);return(0,s.Z)({},t,n)},b=(0,o.ZP)(u.Z,{shouldForwardProp:e=>(0,c.Z)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({});var v=a.forwardRef(function(e,t){let n=(0,d.i)({props:e,name:"MuiDialogContentText"}),{className:a}=n,l=(0,i.Z)(n,j),o=g(l);return(0,m.jsx)(b,(0,s.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:l,className:(0,r.Z)(o.root,a)},n,{classes:o}))})},20155:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ed}});var i=n(85893),s=n(65328),a=n(67294),r=n(96788),l=n(60990),o=n(88607),c=n(28907),d=n(68573),u=n(43691),x=n(51015),h=n(59591),p=n(24022),m=n(29204),j=n(31051),g=n(33453),b=n(92365),v=n(40110),f=n(95858),Z=n(26541),y=n(96727),C=n(97182),S=n(94143),E=n(12166),k=n(6897),w=n(65806),T=n(85533),R=n(56894),N=n(15972),_=n(29346),D={display:"flex",alignItems:"baseline"};let M=/^09[0-9]{9}$/g;function A(e,t){return!!e.find(e=>e.cellnumber===t)}let O=(e,t,n,i)=>{if(null!==n){if(""===n)return"ERROR_MISSING_CELLNUMBER";if(!n.match(M))return"ERROR_INVALID_FORMAT_CELLNUMBER";if("EDIT"===e){if(i&&n!==i)return A(t,n)?"ERROR_CONTACT_ALREADY_EXIST":""}else if("ADD"!==e)return"";else if(A(t,n))return"ERROR_CONTACT_ALREADY_EXIST"}},I=e=>{switch(e){case"ERROR_MISSING_CELLNUMBER":case"ERROR_MISSING_CELLNUMBER":return"Cell number is required.";case"ERROR_INVALID_FORMAT_CELLNUMBER":return"Invalid cell number format.";case"ERROR_CONTACT_ALREADY_EXIST":return"Cell number already exists in the conact list.";default:return""}};var L=n(9704),P=function(e){var t,n;let{contacts:s,open:o,handleClose:c,handleAddContact:d,loadingButton:u,regions:h,province:p,setProvince:m,municipality:j,setMunicipality:M}=e,[A,P]=(0,a.useState)(""),[z,W]=(0,a.useState)(null),[B,F]=(0,a.useState)(""),[q,G]=(0,a.useState)([]),[H,U]=(0,a.useState)([]),[Y,V]=(0,a.useState)(u),K=Object.keys(h),{cropList:X}=(0,L.Z)();(0,a.useEffect)(()=>{V(u)},[u]),(0,a.useEffect)(()=>{p&&G(h[p])},[p,h]);let J=e=>{let{value:t,checked:n}=e.target;U(e=>n?[...e,t]:e.filter(e=>e!==t))};return(0,i.jsxs)(g.Z,{fullWidth:!0,maxWidth:"xs",open:o,onClose:c,children:[(0,i.jsx)(b.Z,{children:"Add Contact"}),(0,i.jsxs)(v.Z,{children:[(0,i.jsxs)(l.Z,{sx:D,children:[(0,i.jsx)(l.Z,{sx:{mr:9},children:(0,i.jsx)(f.Z,{children:"Name:"})}),(0,i.jsx)(Z.Z,{id:"outlined-basic",variant:"standard",size:"small",onChange:e=>{P(e.target.value)}})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(l.Z,{sx:D,children:[(0,i.jsx)(l.Z,{sx:{mr:3},children:(0,i.jsx)(f.Z,{children:"Cell Number:"})}),(0,i.jsx)(Z.Z,{error:(null===(t=O("ADD",s,z,null))||void 0===t?void 0:t.length)>0,helperText:I(O("ADD",s,z)),id:"outlined-basic",variant:"standard",size:"small",onChange:e=>{W(e.target.value)},type:"tel"})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(l.Z,{sx:D,children:[(0,i.jsx)(l.Z,{sx:{mr:5},children:(0,i.jsx)(f.Z,{children:"Nickname:"})}),(0,i.jsx)(Z.Z,{id:"outlined-basic",variant:"standard",size:"small",onChange:e=>{F(e.target.value)}})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{variant:"standard",fullWidth:!0,children:[(0,i.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Province"}),(0,i.jsx)(_.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:p,label:"Province",onChange:e=>{m(e.target.value),M("")},children:K.map(e=>(0,i.jsx)(N.Z,{value:e,children:e},e))})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{variant:"standard",fullWidth:!0,children:[(0,i.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Municipality"}),(0,i.jsx)(_.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:j,label:"Municipality",onChange:e=>{M(e.target.value)},disabled:!p,children:q.map(e=>(0,i.jsx)(N.Z,{value:e,children:e},e))})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{children:[(0,i.jsx)(T.Z,{id:"demo-checkbox-group-label",children:"Subscribed Crops"}),(0,i.jsx)(r.Z,{variant:"caption",children:"Select crops where farmer wants to receive SMS."}),(0,i.jsx)(R.Z,{row:!0,children:X.length?X.map(e=>(0,i.jsx)(w.Z,{control:(0,i.jsx)(E.Z,{value:e,checked:H.includes(e),onChange:J}),label:e},e)):(0,i.jsx)("p",{children:"No data available."})})]})]}),(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(x.Z,{disabled:Y,size:"small",onClick:c,children:"CANCEL"}),(0,i.jsxs)(x.Z,{disabled:(null===(n=O("ADD",s,z))||void 0===n?void 0:n.length)>0||null===z||""===p.length||""===j.length||!(B.length>0&&B.length<=5)||0===H.length||Y,size:"small",variant:"contained",onClick:()=>{d({name:A,cellnumber:z,nickname:B,province:p,municipality:j,subscribed_crops:H}),P(""),W(null),m(""),M(""),c()},children:[(0,i.jsx)("span",{style:{display:Y?"none":"block"},children:"SAVE"}),(0,i.jsx)(C.Z,{size:24,color:"secondary",sx:{display:Y?"block":"none"}})]})]})]})},z=function(e){var t,n;let{loadingButton:s,open:o,contact:c,contacts:d,handleClose:u,handleDeleteContact:h,handleEditContact:p,regions:m}=e,[j,M]=(0,a.useState)(!1),[A,P]=(0,a.useState)(c.name),[z,W]=(0,a.useState)(c.cellnumber),[B,F]=(0,a.useState)(c.nickname),[q,G]=(0,a.useState)(c.province),[H,U]=(0,a.useState)(c.municipality),[Y,V]=(0,a.useState)([]),[K,X]=(0,a.useState)(s),[J,Q]=(0,a.useState)(c.subscribed_crops),$=Object.keys(m),{cropList:ee}=(0,L.Z)();(0,a.useEffect)(()=>{Q(c.subscribed_crops)},[c]),(0,a.useEffect)(()=>{V(m[q])},[q,m]),(0,a.useEffect)(()=>{P(c.name),W(c.cellnumber),F(c.nickname),G(c.province),U(c.municipality)},[c]),(0,a.useEffect)(()=>{X(s)},[s]);let et=e=>{let{value:t,checked:n}=e.target;Q(e=>n?[...e,t]:e.filter(e=>e!==t))};return(0,i.jsxs)(g.Z,{fullWidth:!0,maxWidth:"xs",open:o,onClose:u,children:[(0,i.jsx)(b.Z,{children:"Contact Details"}),(0,i.jsxs)(v.Z,{children:[(0,i.jsxs)(l.Z,{sx:D,children:[(0,i.jsx)(l.Z,{sx:{mr:9},children:(0,i.jsx)(f.Z,{children:"Name:"})}),(0,i.jsx)(Z.Z,{disabled:!j,id:"outlined-basic",onChange:e=>{P(e.target.value)},value:A,variant:"standard",size:"small"})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(l.Z,{sx:D,children:[(0,i.jsx)(l.Z,{sx:{mr:3},children:(0,i.jsx)(f.Z,{children:"Cell Number:"})}),(0,i.jsx)(Z.Z,{error:(null===(t=O("EDIT",d,z,c.cellnumber))||void 0===t?void 0:t.length)>0,helperText:I(O("EDIT",d,z,c.cellnumber)),onChange:e=>{W(e.target.value)},disabled:!j,id:"outlined-basic",value:z,variant:"standard",size:"small",type:"tel"})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(l.Z,{sx:D,children:[(0,i.jsx)(l.Z,{sx:{mr:5},children:(0,i.jsx)(f.Z,{children:"Nickname:"})}),(0,i.jsx)(Z.Z,{disabled:!j,id:"outlined-basic",onChange:e=>{F(e.target.value)},value:B,variant:"standard",size:"small"})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{variant:"standard",fullWidth:!0,children:[(0,i.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Province"}),(0,i.jsx)(_.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:q,label:"Province",onChange:e=>{G(e.target.value),U("")},disabled:!j,children:$.map(e=>(0,i.jsx)(N.Z,{value:e,children:e},e))})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{variant:"standard",fullWidth:!0,children:[(0,i.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Municipality"}),(0,i.jsx)(_.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:H,label:"Municipality",onChange:e=>{U(e.target.value)},disabled:!j||!q,children:Y.map(e=>(0,i.jsx)(N.Z,{value:e,children:e},e))})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{children:[(0,i.jsx)(T.Z,{id:"demo-checkbox-group-label",children:"Subscribed Crops"}),(0,i.jsx)(r.Z,{variant:"caption",children:"Select crops where farmer wants to receive SMS."}),(0,i.jsx)(R.Z,{row:!0,children:ee.length?ee.map(e=>(0,i.jsx)(w.Z,{control:(0,i.jsx)(E.Z,{value:e,checked:J.includes(e),onChange:et,disabled:!j}),label:e},e)):(0,i.jsx)("p",{children:"No data available."})})]})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(y.Z,{children:[j?(0,i.jsxs)(x.Z,{disabled:(null===(n=O("EDIT",d,z,c.cellnumber))||void 0===n?void 0:n.length)>0||K,size:"small",variant:"outlined",onClick:()=>p({id:c.id,name:A,cellnumber:z,nickname:B,province:q,municipality:H,selectedCrops:J}),children:[(0,i.jsx)("span",{style:{display:K?"none":"block"},children:"SAVE"}),(0,i.jsx)(C.Z,{size:24,color:"secondary",sx:{display:K?"block":"none"}})]}):(0,i.jsx)(x.Z,{disabled:K,size:"small",variant:"outlined",onClick:()=>{M(!0),W(c.cellnumber)},children:"EDIT"}),j?(0,i.jsx)(x.Z,{disabled:K,size:"small",variant:"outlined",onClick:()=>{P(c.name),W(c.cellnumber),G(c.province),U(c.municipality),M(!1)},children:"CANCEL"}):(0,i.jsxs)(x.Z,{disabled:K,size:"small",color:"error",variant:"outlined",onClick:()=>h(c),children:[(0,i.jsx)("span",{style:{display:K?"none":"block"},children:"DELETE"}),(0,i.jsx)(C.Z,{size:24,color:"secondary",sx:{display:K?"block":"none"}})]}),(0,i.jsx)(x.Z,{disabled:K,size:"small",onClick:u,children:"CLOSE"})]})]})},W=n(17553),B=function(e){let{handleAddContact:t,handleDeleteContact:n,handleEditContact:s,loading:r,loadingButton:l,open:o,originalContacts:c,setOpen:d,regions:u,province:g,setProvince:b,municipality:v,setMunicipality:f}=e,[Z,y]=(0,a.useState)(null),[C,S]=(0,a.useState)(c),[E,k]=(0,a.useState)(null),[w,T]=(0,a.useState)(!1),[R,N]=(0,a.useState)(!1),[_,D]=(0,a.useState)({});(0,a.useEffect)(()=>{S(c)},[c]),(0,a.useEffect)(()=>{0!==c.length&&A(c)},[A,c]);let M=e=>{N(!1),D({}),d(!0),y(e)},A=(0,a.useCallback)(e=>{k(e.reduce((e,t)=>(e[t.province]||(e[t.province]={}),e[t.province][t.municipality]||(e[t.province][t.municipality]=[]),e[t.province][t.municipality].push(t),e),{}))},[k]);return(0,i.jsxs)("div",{children:[R&&Object.entries(_).length>0&&(0,i.jsx)(W.Z,{openSnackbar:!0,message:_.message,severity:_.severity}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.Z,{variant:"contained",color:"primary",onClick:()=>{T(!0),b(""),f("")},children:"ADD CONTACT"}),(0,i.jsx)(P,{contacts:c,open:w,handleClose:()=>{T(!1)},handleAddContact:t,loadingButton:l,regions:u,province:g,setProvince:b,municipality:v,setMunicipality:f})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)("div",{style:{width:"30vw"},children:r?"Updating List...":(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:E&&Object.keys(E).sort().map((e,t)=>(0,i.jsxs)(h.Z,{children:[(0,i.jsx)(p.Z,{expandIcon:(0,i.jsx)(j.Z,{}),"aria-controls":"panel1-content",id:"panel1-header",children:(0,i.jsx)("strong",{children:e})}),(0,i.jsx)(m.Z,{children:Object.keys(E[e]).sort().map(t=>(0,i.jsxs)("div",{children:[(0,i.jsx)("i",{children:t}),E[e][t].map(e=>(0,i.jsx)("ul",{children:(0,i.jsxs)("li",{style:{cursor:"pointer"},onClick:()=>M(e),children:[e.name," (",e.nickname,")"]})},e.cellnumber))]},t))})]},t))}),Z&&(0,i.jsx)(z,{contact:Z,contacts:C,handleClose:()=>{d(!1),y(null)},handleDeleteContact:n,handleEditContact:s,loadingButton:l,open:o,regions:u})]})})]})},F=n(9473),q=n(64740),G=n(84325),H=function(e){let{columns:t,loadingReports:n,rows:s,handleReportTypeChange:r}=e,[l,o]=(0,a.useState)(G.Ry.SEASONAL),c=(0,F.v9)(e=>e.dashboard.reportType);return(0,a.useEffect)(()=>{o(c)},[c]),(0,i.jsxs)("div",{children:[t.length>0&&(0,i.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"10px"},children:(0,i.jsxs)(k.Z,{sx:{m:1,width:{xs:"100%",sm:"100%",md:300}},size:"small",children:[(0,i.jsx)(S.Z,{id:"report-type",children:"Bulletin Type"}),(0,i.jsxs)(_.Z,{labelId:"report-type",id:"report-type",value:l,label:"Bulletin Type",onChange:r,children:[(0,i.jsx)(N.Z,{value:G.Ry.SEASONAL,children:"Seasonal Crop Recommendations"}),(0,i.jsx)(N.Z,{value:G.Ry.TEN_DAY,children:"10-Day Crop Recommendations"}),(0,i.jsx)(N.Z,{value:G.Ry.SPECIAL_WEATHER,children:"Special Weather Recommendations"})]})]})}),(0,i.jsx)("div",{style:{height:400,width:"100%"},children:(0,i.jsx)(q._,{rows:s,columns:t,loading:n,pageSize:5,rowsPerPageOptions:[5]})})]})},U=n(29365),Y=function(e){let{columns:t,contacts:n,getContacts:s,handleAddContact:x,handleDeleteContact:h,handleEditContact:p,handleOpenAddContact:m,handleReportTypeChange:j,loading:g,loadingButton:b,loadingReports:v,open:f,rows:Z,setOpen:y,toAddContact:C,regions:S,province:E,setProvince:k,municipality:w,setMunicipality:T}=e,[R,N]=(0,a.useState)(C?1:0);return(0,i.jsxs)("div",{children:[(0,i.jsx)(r.Z,{variant:"h5",children:"SMS Management"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"View Text (SMS) versions"})," of generated Crop Recommendations and send them to different individuals via SMS."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Manage your own phonebook"})," for ease of sending texts to individuals."]}),(0,i.jsxs)(l.Z,{sx:U.Z.tabsContainer,children:[(0,i.jsxs)(o.Z,{value:R,onChange:(e,t)=>{N(t)},"aria-label":"basic tabs example",children:[(0,i.jsx)(c.Z,{label:"SMS",...(0,u.P)(0)}),(0,i.jsx)(c.Z,{label:"PHONEBOOK",...(0,u.P)(1)})]}),(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(u.x,{value:R,index:0,children:(0,i.jsx)(H,{columns:t,handleReportTypeChange:j,loadingReports:v,rows:Z})}),(0,i.jsx)(u.x,{value:R,index:1,children:(0,i.jsx)(d.ZP,{container:!0,children:(0,i.jsx)(d.ZP,{item:!0,xs:12,md:4,children:(0,i.jsx)(B,{getContacts:s,handleAddContact:x,handleDeleteContact:h,handleEditContact:p,handleOpenAddContact:m,loading:g,loadingButton:b,open:f,originalContacts:n,setOpen:y,regions:S,province:E,setProvince:k,municipality:w,setMunicipality:T})})})})]})]})]})},V=n(45773),K=n(46560),X=n(98813),J=n(92246),Q=n(18853),$=n(97416),ee=n(40923),et=n(11163),en=n(31695),ei=n(25026),es=n(93454),ea=n(76592),er=n(70360),el=n(46577),eo=n(8863),ec=n(19827),ed=(0,s.Z)(function(e){let{loading:t,user:n,onBtnLogoutClick:s}=e,o=(0,Q.aC)(),c=(0,et.useRouter)(),d=(0,F.I0)(),[u,h]=(0,a.useState)([]),[p,m]=(0,a.useState)([]),[j,f]=(0,a.useState)([]),[Z,C]=(0,a.useState)([]),[S,E]=(0,a.useState)(!1),[k,w]=(0,a.useState)(!1),[T,R]=(0,a.useState)({}),[N,_]=(0,a.useState)(!1),[D,M]=(0,a.useState)(!1),[A,O]=(0,a.useState)([]),[I,L]=(0,a.useState)(!1),P=(0,F.v9)(e=>e.dashboard.reportType),[z,B]=(0,a.useState)([]),[q,G]=(0,a.useState)(""),[H,U]=(0,a.useState)(""),ed=async()=>{try{_(!0);let e=await (0,ee.K2)();C(e),_(!1)}catch(e){console.error(e.message)}},eu=e=>{let{logs:t}=e;return(0,i.jsx)(ei.Z,{component:es.Z,children:(0,i.jsxs)(ea.Z,{sx:{minWidth:650},"arial-label":"simple-table",children:[(0,i.jsx)(er.Z,{children:(0,i.jsxs)(el.Z,{children:[(0,i.jsx)(eo.Z,{children:"Number"}),(0,i.jsxs)(eo.Z,{children:["Date\xa0",(0,i.jsx)("span",{style:{fontSize:"10px"},children:"(MM/DD/YYYY)"})]}),(0,i.jsx)(eo.Z,{children:"Message"}),(0,i.jsx)(eo.Z,{children:"Recipients"})]})}),(0,i.jsx)(ec.Z,{children:t.map((e,t)=>{let n=JSON.parse(e),s=new Date(n.dateSent).toLocaleString();return(0,i.jsxs)(el.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,i.jsx)(eo.Z,{component:"th",scope:"row",children:t+1}),(0,i.jsx)(eo.Z,{children:s}),(0,i.jsx)(eo.Z,{children:n.sentMessage}),(0,i.jsx)(eo.Z,{children:n.recipientsWithName||n.recipientsNumber})]},n.dateSent)})})]})})};(0,a.useEffect)(()=>{null===o.user||o.loading||((async()=>{try{let e=await (0,en._8)(o.user.uid);f(e)}catch(e){console.error(e.message)}})(),ed())},[o]),(0,a.useEffect)(()=>{j.length>0&&ex(j.filter(e=>e.type===P))},[j]),(0,a.useEffect)(()=>{(async()=>{try{var e;let t=await (0,$.ur)();B(null!==(e=null==t?void 0:t.data)&&void 0!==e?e:[])}catch(e){console.error(e.message)}})()},[]);let ex=e=>{let t={action:"Action",logs:"Logs",crop:"Crop",text_recommendation:"Text-Form Recommendation",region:"Region",province:"Province",municipality:"Municipality",month:"Month",type:"Type",updated_by:"Updated by",date_created:"Date Created"},n=[];["action","logs","crop","text_recommendation","region","province","municipality","month","type","updated_by","date_created"].forEach(e=>{"action"===e?n.push({field:e,headerName:t[e],width:100,editable:!1,sortable:!1,disableColumnMenu:!0,renderCell:e=>(0,i.jsx)(x.Z,{variant:"outlined",size:"small",onClick:t=>{t.stopPropagation(),c.push({pathname:"/admin/sms/viewSMS/",query:{docId:e.row.docId}})},children:"SEND"})}):"logs"===e?n.push({field:e,headerName:t[e],width:100,editable:!1,sortable:!1,disableColumnMenu:!0,renderCell:e=>{var t;return(null===(t=e.row.logs)||void 0===t?void 0:t.length)>0?(0,i.jsx)(x.Z,{variant:"outlined",size:"small",onClick:()=>{M(!0),O(e.row)},children:"VIEW LOGS"}):(0,i.jsx)(l.Z,{sx:{fontWeight:"bold"},children:"UNSENT"})}}):n.push({field:e,headerName:t[e],width:150,editable:!1,sortable:!1,disableColumnMenu:!0})}),h(e.map((e,t)=>({id:t,docId:e.id,logs:e.logs,crop:e.crop,text_recommendation:e.smsRecommendations||"No SMS Recommendations available",logs:e.logs,region:e.region,province:e.province,municipality:e.municipality,month:e.month,type:e.type,updated_by:e.updated_by,date_created:"".concat(e.date_created.toDate().toDateString(),"\n          ").concat(e.date_created.toDate().toLocaleTimeString("it-IT",J.W6))}))),m(n)};(0,a.useEffect)(()=>{void 0===Object.keys(c.query)[0]&&(E(!1),R({})),"isSent"===Object.keys(c.query)[0]&&(_(!1),E(!0),eh({message:"true"===c.query.isSent?"Successfully sent Crop Recommendation via text!":"Unsuccessful in sending Crop Recommendation via text.",severity:"true"===c.query.isSent?"success":"error"}))},[c]),(0,a.useEffect)(()=>{o.loading||o.user||c.push("/admin/login")},[o.user,o.loading,c]);let eh=e=>{R(e)},ep=async e=>{try{L(!0),await (0,ee.rE)(e)&&await ed(),L(!1),E(!0),R({message:"Successfully added a New Contact!",severity:"success"})}catch(e){console.error(e.message)}},em=async e=>{try{L(!0);let t=await (0,ee.GK)({docId:e.id});w(!1),t&&await ed(),L(!1),E(!0),R({openSnackbar:!0,message:"Successfully deleted contact: ".concat(""===e.name?e.cellnumber:e.name,"!"),severity:"success"})}catch(e){console.error(e.message)}},ej=async e=>{try{L(!0);let t=await (0,ee.mP)({docId:e.id,name:e.name,cellnumber:e.cellnumber,nickname:e.nickname,province:e.province,municipality:e.municipality,subscribed_crops:e.selectedCrops});L(!1),w(!1),t&&await ed(),E(!0),R({openSnackbar:!0,message:"Successfully edit contact: ".concat(""===e.name?e.cellnumber:e.name,"!"),severity:"success"})}catch(e){console.error(e.message)}},eg=()=>{M(!1)};return(0,i.jsxs)(V.Z,{loading:t,user:n,onBtnLogoutClick:s,accLevel:X.DW.ADMIN,children:[(0,i.jsx)(e=>{let{report:t}=e;return(0,i.jsxs)(g.Z,{fullWidth:!0,maxWidth:"md",open:D,onClose:eg,children:[(0,i.jsx)(b.Z,{children:"SMS Recommendation Logs"}),(0,i.jsxs)(v.Z,{dividers:!0,children:[(0,i.jsx)(r.Z,{variant:"body2",children:"This is where you can check where you send your texts message."}),(0,i.jsx)("br",{}),(0,i.jsx)(eu,{logs:null==t?void 0:t.logs})]}),(0,i.jsx)(y.Z,{children:(0,i.jsx)(x.Z,{variant:"outlined",onClick:eg,children:"Close"})})]})},{report:A}),(0,i.jsx)(Y,{columns:p,contacts:Z,getContacts:ed,handleAddContact:ep,handleDeleteContact:em,handleEditContact:ej,handleReportTypeChange:e=>{let{value:t}=e.target;O(ex(j.filter(e=>e.type===t))),d((0,K.uq)(t))},loading:N,loadingReports:t,onBtnClick:s,open:k,rows:u,setOpen:w,toAddContact:c.query.toAddContact,user:o.user,loadingButton:I,regions:z,province:q,setProvince:G,municipality:H,setMunicipality:U}),!N&&S&&(0,i.jsx)(W.Z,{openSnackbar:!0,message:T.message,severity:T.severity,closeHandler:()=>{E(!1)}})]})})},9704:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(67294),s=n(61061);function a(){let[e,t]=(0,i.useState)([]),[n,a]=(0,i.useState)(!1),[r,l]=(0,i.useState)("");return(0,i.useEffect)(()=>{(async()=>{var e,n,i;try{a(!0);let n=await (0,s.TQ)();t(null!==(e=null==n?void 0:n.list)&&void 0!==e?e:[]),a(!1),l("")}catch(e){l(null!==(i=null==e?void 0:null===(n=e.response)||void 0===n?void 0:n.data)&&void 0!==i?i:e.message),a(!1),t([])}})()},[]),{cropList:e,loading:n,error:r}}},40923:function(e,t,n){"use strict";n.d(t,{rE:function(){return c},GK:function(){return d},mP:function(){return u},K2:function(){return x}});var i=n(9669),s=n.n(i),a=n(15426);let r={CREATE_CONTACT:"".concat("https://acap-mimaropa-server.onrender.com/api","/contact"),DELETE_CONTACT:"".concat("https://acap-mimaropa-server.onrender.com/api","/contact"),EDIT_CONTACT:"".concat("https://acap-mimaropa-server.onrender.com/api","/contact"),GET_CONTACTS:"".concat("https://acap-mimaropa-server.onrender.com/api","/contacts")};class l extends a.Z{async createContact(e){let t=await this.createRequestObject({body:e});return(await s()({...t,url:r.CREATE_CONTACT,method:"POST"})).data}async deleteContact(e){let t=await this.createRequestObject({body:e});return(await s()({...t,url:r.DELETE_CONTACT,method:"DELETE"})).data}async editContact(e){let t=await this.createRequestObject({body:e});return(await s()({...t,url:r.EDIT_CONTACT,method:"PATCH"})).data}async getContacts(){let e=await this.createRequestObject({});return(await s()({...e,url:r.GET_CONTACTS,method:"GET"})).data.contacts}}let o=new l,c=o.createContact.bind(o),d=o.deleteContact.bind(o),u=o.editContact.bind(o),x=o.getContacts.bind(o)}},function(e){e.O(0,[3153,7023,3745,1664,6541,955,7958,4073,4959,5837,6080,4723,3338,760,20,4740,9227,6547,2888,9774,179],function(){return e(e.s=91099)}),_N_E=e.O()}]);