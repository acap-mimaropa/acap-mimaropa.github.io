(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5740],{91099:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/sms",function(){return n(20155)}])},29365:function(e,t){"use strict";t.Z={button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"48px"}},container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",margin:"auto",borderColor:"#E2E8F0"},tabsContainer:{marginTop:e=>e.spacing(8),border:e=>"1px solid ".concat(e.palette.bacap.border),minHeight:"800px",borderRadius:"8px",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px"},customizedButtonLink:{cursor:"pointer",color:"#8BC24A",textDecoration:"underline",fontWeight:600}}},17553:function(e,t,n){"use strict";var s=n(85893),i=n(67294),a=n(45697),r=n.n(a),l=n(70760),o=n(44723);let c=i.forwardRef(function(e,t){return(0,s.jsx)(o.Z,{elevation:6,ref:t,variant:"filled",...e})});function d(e){let{openSnackbar:t,message:n,severity:a="info",closeHandlerCB:r=()=>{}}=e,[o,d]=(0,i.useState)(t);(0,i.useEffect)(()=>{d(t)},[t]);let u=()=>{d(!1),r()},h=function(e){if(null==e)return"";if("string"==typeof e)return e;if(e instanceof Error)return e.message||e.toString();if("object"==typeof e&&"string"==typeof e.message)return e.message;try{return JSON.stringify(e)}catch(t){return String(e)}}(n);return(0,s.jsx)(l.Z,{open:o,autoHideDuration:3e3,onClose:u,children:(0,s.jsx)(c,{onClose:u,severity:a,sx:{width:"100%"},children:h})})}d.propTypes={openSnackbar:r().bool,message:r().any,severity:r().string,closeHandlerCB:r().func},t.Z=d},43691:function(e,t,n){"use strict";n.d(t,{x:function(){return a},P:function(){return r}});var s=n(85893),i=n(60990),a=function(e){let{children:t,value:n,index:a,...r}=e;return(0,s.jsx)("div",{role:"tabpanel",hidden:n!==a,id:"custom-tabpanel-".concat(a),"aria-labelledby":"custom-tab-".concat(a),...r,children:n===a&&(0,s.jsx)(i.Z,{sx:{p:3},children:t})})},r=function(e){return{id:"custom-tab-".concat(e),"aria-controls":"custom-tabpanel-".concat(e)}}},95858:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var s=n(63366),i=n(87462),a=n(67294),r=n(90512),l=n(94780),o=n(77527),c=n(83008),d=n(44001),u=n(96788),h=n(1588),x=n(34867);function m(e){return(0,x.ZP)("MuiDialogContentText",e)}(0,h.Z)("MuiDialogContentText",["root"]);var p=n(85893);let j=["children","className"],b=e=>{let{classes:t}=e,n=(0,l.Z)({root:["root"]},m,t);return(0,i.Z)({},t,n)},v=(0,o.ZP)(u.Z,{shouldForwardProp:e=>(0,c.Z)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({});var g=a.forwardRef(function(e,t){let n=(0,d.i)({props:e,name:"MuiDialogContentText"}),{className:a}=n,l=(0,s.Z)(n,j),o=b(l);return(0,p.jsx)(v,(0,i.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:l,className:(0,r.Z)(o.root,a)},n,{classes:o}))})},56894:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var s=n(63366),i=n(87462),a=n(67294),r=n(90512),l=n(94780),o=n(77527),c=n(44001),d=n(1588),u=n(34867);function h(e){return(0,u.ZP)("MuiFormGroup",e)}(0,d.Z)("MuiFormGroup",["root","row","error"]);var x=n(57280),m=n(88962),p=n(85893);let j=["className","row"],b=e=>{let{classes:t,row:n,error:s}=e;return(0,l.Z)({root:["root",n&&"row",s&&"error"]},h,t)},v=(0,o.ZP)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.row&&t.row]}})(e=>{let{ownerState:t}=e;return(0,i.Z)({display:"flex",flexDirection:"column",flexWrap:"wrap"},t.row&&{flexDirection:"row"})});var g=a.forwardRef(function(e,t){let n=(0,c.i)({props:e,name:"MuiFormGroup"}),{className:a,row:l=!1}=n,o=(0,s.Z)(n,j),d=(0,x.Z)(),u=(0,m.Z)({props:n,muiFormControl:d,states:["error"]}),h=(0,i.Z)({},n,{row:l,error:u.error}),g=b(h);return(0,p.jsx)(v,(0,i.Z)({className:(0,r.Z)(g.root,a),ownerState:h,ref:t},o))})},20155:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ed}});var s=n(85893),i=n(65328),a=n(67294),r=n(96788),l=n(60990),o=n(88607),c=n(28907),d=n(68573),u=n(43691),h=n(51015),x=n(59591),m=n(24022),p=n(29204),j=n(31051),b=n(33453),v=n(92365),g=n(40110),Z=n(95858),f=n(26541),C=n(96727),y=n(97182),S=n(94143),E=n(12166),w=n(6897),T=n(51778),R=n(85533),_=n(56894),N=n(15972),k=n(29346),A={display:"flex",alignItems:"baseline"};let D=/^09[0-9]{9}$/g;function O(e,t){return!!e.find(e=>e.cellnumber===t)}let M=(e,t,n,s)=>{if(null!==n){if(""===n)return"ERROR_MISSING_CELLNUMBER";if(!n.match(D))return"ERROR_INVALID_FORMAT_CELLNUMBER";if("EDIT"===e){if(s&&n!==s)return O(t,n)?"ERROR_CONTACT_ALREADY_EXIST":""}else if("ADD"!==e)return"";else if(O(t,n))return"ERROR_CONTACT_ALREADY_EXIST"}},I=e=>{switch(e){case"ERROR_MISSING_CELLNUMBER":case"ERROR_MISSING_CELLNUMBER":return"Cell number is required.";case"ERROR_INVALID_FORMAT_CELLNUMBER":return"Invalid cell number format.";case"ERROR_CONTACT_ALREADY_EXIST":return"Cell number already exists in the conact list.";default:return""}};var L=n(9704),P=function(e){var t,n;let{contacts:i,open:o,handleClose:c,handleAddContact:d,loadingButton:u,regions:x,province:m,setProvince:p,municipality:j,setMunicipality:D}=e,[O,P]=(0,a.useState)(""),[F,z]=(0,a.useState)(null),[W,B]=(0,a.useState)(""),[G,q]=(0,a.useState)([]),[U,Y]=(0,a.useState)([]),[H,V]=(0,a.useState)(u),K=Object.keys(x),{cropList:X}=(0,L.Z)();(0,a.useEffect)(()=>{V(u)},[u]),(0,a.useEffect)(()=>{m&&q(x[m])},[m,x]);let J=e=>{let{value:t,checked:n}=e.target;Y(e=>n?[...e,t]:e.filter(e=>e!==t))};return(0,s.jsxs)(b.Z,{fullWidth:!0,maxWidth:"xs",open:o,onClose:c,children:[(0,s.jsx)(v.Z,{children:"Add Contact"}),(0,s.jsxs)(g.Z,{children:[(0,s.jsxs)(l.Z,{sx:A,children:[(0,s.jsx)(l.Z,{sx:{mr:9},children:(0,s.jsx)(Z.Z,{children:"Name:"})}),(0,s.jsx)(f.Z,{id:"outlined-basic",variant:"standard",size:"small",onChange:e=>{P(e.target.value)}})]}),(0,s.jsx)("br",{}),(0,s.jsxs)(l.Z,{sx:A,children:[(0,s.jsx)(l.Z,{sx:{mr:3},children:(0,s.jsx)(Z.Z,{children:"Cell Number:"})}),(0,s.jsx)(f.Z,{error:(null===(t=M("ADD",i,F,null))||void 0===t?void 0:t.length)>0,helperText:I(M("ADD",i,F)),id:"outlined-basic",variant:"standard",size:"small",onChange:e=>{z(e.target.value)},type:"tel"})]}),(0,s.jsx)("br",{}),(0,s.jsxs)(l.Z,{sx:A,children:[(0,s.jsx)(l.Z,{sx:{mr:5},children:(0,s.jsx)(Z.Z,{children:"Nickname:"})}),(0,s.jsx)(f.Z,{id:"outlined-basic",variant:"standard",size:"small",onChange:e=>{B(e.target.value)}})]}),(0,s.jsx)("br",{}),(0,s.jsxs)(w.Z,{variant:"standard",fullWidth:!0,children:[(0,s.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Province"}),(0,s.jsx)(k.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:m,label:"Province",onChange:e=>{p(e.target.value),D("")},children:K.map(e=>(0,s.jsx)(N.Z,{value:e,children:e},e))})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)(w.Z,{variant:"standard",fullWidth:!0,children:[(0,s.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Municipality"}),(0,s.jsx)(k.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:j,label:"Municipality",onChange:e=>{D(e.target.value)},disabled:!m,children:G.map(e=>(0,s.jsx)(N.Z,{value:e,children:e},e))})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)(w.Z,{children:[(0,s.jsx)(R.Z,{id:"demo-checkbox-group-label",children:"Subscribed Crops"}),(0,s.jsx)(r.Z,{variant:"caption",children:"Select crops where farmer wants to receive SMS."}),(0,s.jsx)(_.Z,{row:!0,children:X.length?X.map(e=>(0,s.jsx)(T.Z,{control:(0,s.jsx)(E.Z,{value:e,checked:U.includes(e),onChange:J}),label:e},e)):(0,s.jsx)("p",{children:"No data available."})})]})]}),(0,s.jsxs)(C.Z,{children:[(0,s.jsx)(h.Z,{disabled:H,size:"small",onClick:c,children:"CANCEL"}),(0,s.jsxs)(h.Z,{disabled:(null===(n=M("ADD",i,F))||void 0===n?void 0:n.length)>0||null===F||""===m.length||""===j.length||!(W.length>0&&W.length<=5)||0===U.length||H,size:"small",variant:"contained",onClick:()=>{d({name:O,cellnumber:F,nickname:W,province:m,municipality:j,subscribed_crops:U}),P(""),z(null),p(""),D(""),c()},children:[(0,s.jsx)("span",{style:{display:H?"none":"block"},children:"SAVE"}),(0,s.jsx)(y.Z,{size:24,color:"secondary",sx:{display:H?"block":"none"}})]})]})]})},F=function(e){var t,n;let{loadingButton:i,open:o,contact:c,contacts:d,handleClose:u,handleDeleteContact:x,handleEditContact:m,regions:p}=e,[j,D]=(0,a.useState)(!1),[O,P]=(0,a.useState)(c.name),[F,z]=(0,a.useState)(c.cellnumber),[W,B]=(0,a.useState)(c.nickname),[G,q]=(0,a.useState)(c.province),[U,Y]=(0,a.useState)(c.municipality),[H,V]=(0,a.useState)([]),[K,X]=(0,a.useState)(i),[J,Q]=(0,a.useState)(c.subscribed_crops),$=Object.keys(p),{cropList:ee}=(0,L.Z)();(0,a.useEffect)(()=>{Q(c.subscribed_crops)},[c]),(0,a.useEffect)(()=>{V(p[G])},[G,p]),(0,a.useEffect)(()=>{P(c.name),z(c.cellnumber),B(c.nickname),q(c.province),Y(c.municipality)},[c]),(0,a.useEffect)(()=>{X(i)},[i]);let et=e=>{let{value:t,checked:n}=e.target;Q(e=>n?[...e,t]:e.filter(e=>e!==t))};return(0,s.jsxs)(b.Z,{fullWidth:!0,maxWidth:"xs",open:o,onClose:u,children:[(0,s.jsx)(v.Z,{children:"Contact Details"}),(0,s.jsxs)(g.Z,{children:[(0,s.jsxs)(l.Z,{sx:A,children:[(0,s.jsx)(l.Z,{sx:{mr:9},children:(0,s.jsx)(Z.Z,{children:"Name:"})}),(0,s.jsx)(f.Z,{disabled:!j,id:"outlined-basic",onChange:e=>{P(e.target.value)},value:O,variant:"standard",size:"small"})]}),(0,s.jsx)("br",{}),(0,s.jsxs)(l.Z,{sx:A,children:[(0,s.jsx)(l.Z,{sx:{mr:3},children:(0,s.jsx)(Z.Z,{children:"Cell Number:"})}),(0,s.jsx)(f.Z,{error:(null===(t=M("EDIT",d,F,c.cellnumber))||void 0===t?void 0:t.length)>0,helperText:I(M("EDIT",d,F,c.cellnumber)),onChange:e=>{z(e.target.value)},disabled:!j,id:"outlined-basic",value:F,variant:"standard",size:"small",type:"tel"})]}),(0,s.jsx)("br",{}),(0,s.jsxs)(l.Z,{sx:A,children:[(0,s.jsx)(l.Z,{sx:{mr:5},children:(0,s.jsx)(Z.Z,{children:"Nickname:"})}),(0,s.jsx)(f.Z,{disabled:!j,id:"outlined-basic",onChange:e=>{B(e.target.value)},value:W,variant:"standard",size:"small"})]}),(0,s.jsx)("br",{}),(0,s.jsxs)(w.Z,{variant:"standard",fullWidth:!0,children:[(0,s.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Province"}),(0,s.jsx)(k.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:G,label:"Province",onChange:e=>{q(e.target.value),Y("")},disabled:!j,children:$.map(e=>(0,s.jsx)(N.Z,{value:e,children:e},e))})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)(w.Z,{variant:"standard",fullWidth:!0,children:[(0,s.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Municipality"}),(0,s.jsx)(k.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:U,label:"Municipality",onChange:e=>{Y(e.target.value)},disabled:!j||!G,children:H.map(e=>(0,s.jsx)(N.Z,{value:e,children:e},e))})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)(w.Z,{children:[(0,s.jsx)(R.Z,{id:"demo-checkbox-group-label",children:"Subscribed Crops"}),(0,s.jsx)(r.Z,{variant:"caption",children:"Select crops where farmer wants to receive SMS."}),(0,s.jsx)(_.Z,{row:!0,children:ee.length?ee.map(e=>(0,s.jsx)(T.Z,{control:(0,s.jsx)(E.Z,{value:e,checked:J.includes(e),onChange:et,disabled:!j}),label:e},e)):(0,s.jsx)("p",{children:"No data available."})})]})]}),(0,s.jsx)("br",{}),(0,s.jsxs)(C.Z,{children:[j?(0,s.jsxs)(h.Z,{disabled:(null===(n=M("EDIT",d,F,c.cellnumber))||void 0===n?void 0:n.length)>0||K,size:"small",variant:"outlined",onClick:()=>m({id:c.id,name:O,cellnumber:F,nickname:W,province:G,municipality:U,selectedCrops:J}),children:[(0,s.jsx)("span",{style:{display:K?"none":"block"},children:"SAVE"}),(0,s.jsx)(y.Z,{size:24,color:"secondary",sx:{display:K?"block":"none"}})]}):(0,s.jsx)(h.Z,{disabled:K,size:"small",variant:"outlined",onClick:()=>{D(!0),z(c.cellnumber)},children:"EDIT"}),j?(0,s.jsx)(h.Z,{disabled:K,size:"small",variant:"outlined",onClick:()=>{P(c.name),z(c.cellnumber),q(c.province),Y(c.municipality),D(!1)},children:"CANCEL"}):(0,s.jsxs)(h.Z,{disabled:K,size:"small",color:"error",variant:"outlined",onClick:()=>x(c),children:[(0,s.jsx)("span",{style:{display:K?"none":"block"},children:"DELETE"}),(0,s.jsx)(y.Z,{size:24,color:"secondary",sx:{display:K?"block":"none"}})]}),(0,s.jsx)(h.Z,{disabled:K,size:"small",onClick:u,children:"CLOSE"})]})]})},z=n(17553),W=function(e){let{handleAddContact:t,handleDeleteContact:n,handleEditContact:i,loading:r,loadingButton:l,open:o,originalContacts:c,setOpen:d,regions:u,province:b,setProvince:v,municipality:g,setMunicipality:Z}=e,[f,C]=(0,a.useState)(null),[y,S]=(0,a.useState)(c),[E,w]=(0,a.useState)(null),[T,R]=(0,a.useState)(!1),[_,N]=(0,a.useState)(!1),[k,A]=(0,a.useState)({});(0,a.useEffect)(()=>{S(c)},[c]),(0,a.useEffect)(()=>{0!==c.length&&O(c)},[O,c]);let D=e=>{N(!1),A({}),d(!0),C(e)},O=(0,a.useCallback)(e=>{w(e.reduce((e,t)=>(e[t.province]||(e[t.province]={}),e[t.province][t.municipality]||(e[t.province][t.municipality]=[]),e[t.province][t.municipality].push(t),e),{}))},[w]);return(0,s.jsxs)("div",{children:[_&&Object.entries(k).length>0&&(0,s.jsx)(z.Z,{openSnackbar:!0,message:k.message,severity:k.severity}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{variant:"contained",color:"primary",onClick:()=>{R(!0),v(""),Z("")},children:"ADD CONTACT"}),(0,s.jsx)(P,{contacts:c,open:T,handleClose:()=>{R(!1)},handleAddContact:t,loadingButton:l,regions:u,province:b,setProvince:v,municipality:g,setMunicipality:Z})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("div",{style:{width:"30vw"},children:r?"Updating List...":(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:E&&Object.keys(E).sort().map((e,t)=>(0,s.jsxs)(x.Z,{children:[(0,s.jsx)(m.Z,{expandIcon:(0,s.jsx)(j.Z,{}),"aria-controls":"panel1-content",id:"panel1-header",children:(0,s.jsx)("strong",{children:e})}),(0,s.jsx)(p.Z,{children:Object.keys(E[e]).sort().map(t=>(0,s.jsxs)("div",{children:[(0,s.jsx)("i",{children:t}),E[e][t].map(e=>(0,s.jsx)("ul",{children:(0,s.jsxs)("li",{style:{cursor:"pointer"},onClick:()=>D(e),children:[e.name," (",e.nickname,")"]})},e.cellnumber))]},t))})]},t))}),f&&(0,s.jsx)(F,{contact:f,contacts:y,handleClose:()=>{d(!1),C(null)},handleDeleteContact:n,handleEditContact:i,loadingButton:l,open:o,regions:u})]})})]})},B=n(9473),G=n(64740),q=n(84325),U=function(e){let{columns:t,loadingReports:n,rows:i,handleReportTypeChange:r}=e,[l,o]=(0,a.useState)(q.Ry.SEASONAL),c=(0,B.v9)(e=>e.dashboard.reportType);return(0,a.useEffect)(()=>{o(c)},[c]),(0,s.jsxs)("div",{children:[t.length>0&&(0,s.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"10px"},children:(0,s.jsxs)(w.Z,{sx:{m:1,width:{xs:"100%",sm:"100%",md:300}},size:"small",children:[(0,s.jsx)(S.Z,{id:"report-type",children:"Bulletin Type"}),(0,s.jsxs)(k.Z,{labelId:"report-type",id:"report-type",value:l,label:"Bulletin Type",onChange:r,children:[(0,s.jsx)(N.Z,{value:q.Ry.SEASONAL,children:"Seasonal Crop Recommendations"}),(0,s.jsx)(N.Z,{value:q.Ry.TEN_DAY,children:"10-Day Crop Recommendations"}),(0,s.jsx)(N.Z,{value:q.Ry.SPECIAL_WEATHER,children:"Special Weather Recommendations"})]})]})}),(0,s.jsx)("div",{style:{height:400,width:"100%"},children:(0,s.jsx)(G._,{rows:i,columns:t,loading:n,pageSize:5,rowsPerPageOptions:[5]})})]})},Y=n(29365),H=function(e){let{columns:t,contacts:n,getContacts:i,handleAddContact:h,handleDeleteContact:x,handleEditContact:m,handleOpenAddContact:p,handleReportTypeChange:j,loading:b,loadingButton:v,loadingReports:g,open:Z,rows:f,setOpen:C,toAddContact:y,regions:S,province:E,setProvince:w,municipality:T,setMunicipality:R}=e,[_,N]=(0,a.useState)(y?1:0);return(0,s.jsxs)("div",{children:[(0,s.jsx)(r.Z,{variant:"h5",children:"SMS Management"}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"View Text (SMS) versions"})," of generated Crop Recommendations and send them to different individuals via SMS."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Manage your own phonebook"})," for ease of sending texts to individuals."]}),(0,s.jsxs)(l.Z,{sx:Y.Z.tabsContainer,children:[(0,s.jsxs)(o.Z,{value:_,onChange:(e,t)=>{N(t)},"aria-label":"basic tabs example",children:[(0,s.jsx)(c.Z,{label:"SMS",...(0,u.P)(0)}),(0,s.jsx)(c.Z,{label:"PHONEBOOK",...(0,u.P)(1)})]}),(0,s.jsxs)(l.Z,{children:[(0,s.jsx)(u.x,{value:_,index:0,children:(0,s.jsx)(U,{columns:t,handleReportTypeChange:j,loadingReports:g,rows:f})}),(0,s.jsx)(u.x,{value:_,index:1,children:(0,s.jsx)(d.ZP,{container:!0,children:(0,s.jsx)(d.ZP,{item:!0,xs:12,md:4,children:(0,s.jsx)(W,{getContacts:i,handleAddContact:h,handleDeleteContact:x,handleEditContact:m,handleOpenAddContact:p,loading:b,loadingButton:v,open:Z,originalContacts:n,setOpen:C,regions:S,province:E,setProvince:w,municipality:T,setMunicipality:R})})})})]})]})]})},V=n(45773),K=n(46560),X=n(98813),J=n(92246),Q=n(18853),$=n(97416),ee=n(40923),et=n(11163),en=n(31695),es=n(25026),ei=n(93454),ea=n(76592),er=n(70360),el=n(46577),eo=n(8863),ec=n(19827),ed=(0,i.Z)(function(e){let{loading:t,user:n,onBtnLogoutClick:i}=e,o=(0,Q.aC)(),c=(0,et.useRouter)(),d=(0,B.I0)(),[u,x]=(0,a.useState)([]),[m,p]=(0,a.useState)([]),[j,Z]=(0,a.useState)([]),[f,y]=(0,a.useState)([]),[S,E]=(0,a.useState)(!1),[w,T]=(0,a.useState)(!1),[R,_]=(0,a.useState)({}),[N,k]=(0,a.useState)(!1),[A,D]=(0,a.useState)(!1),[O,M]=(0,a.useState)([]),[I,L]=(0,a.useState)(!1),P=(0,B.v9)(e=>e.dashboard.reportType),[F,W]=(0,a.useState)([]),[G,q]=(0,a.useState)(""),[U,Y]=(0,a.useState)(""),ed=async()=>{try{k(!0);let e=await (0,ee.K2)();y(e),k(!1)}catch(e){console.error(e.message)}},eu=e=>{let{logs:t}=e;return(0,s.jsx)(es.Z,{component:ei.Z,children:(0,s.jsxs)(ea.Z,{sx:{minWidth:650},"arial-label":"simple-table",children:[(0,s.jsx)(er.Z,{children:(0,s.jsxs)(el.Z,{children:[(0,s.jsx)(eo.Z,{children:"Number"}),(0,s.jsxs)(eo.Z,{children:["Date\xa0",(0,s.jsx)("span",{style:{fontSize:"10px"},children:"(MM/DD/YYYY)"})]}),(0,s.jsx)(eo.Z,{children:"Message"}),(0,s.jsx)(eo.Z,{children:"Recipients"})]})}),(0,s.jsx)(ec.Z,{children:t.map((e,t)=>{let n=JSON.parse(e),i=new Date(n.dateSent).toLocaleString();return(0,s.jsxs)(el.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,s.jsx)(eo.Z,{component:"th",scope:"row",children:t+1}),(0,s.jsx)(eo.Z,{children:i}),(0,s.jsx)(eo.Z,{children:n.sentMessage}),(0,s.jsx)(eo.Z,{children:n.recipientsWithName||n.recipientsNumber})]},n.dateSent)})})]})})};(0,a.useEffect)(()=>{null===o.user||o.loading||((async()=>{try{let e=await (0,en._8)(o.user.uid);Z(e)}catch(e){console.error(e.message)}})(),ed())},[o]),(0,a.useEffect)(()=>{j.length>0&&eh(j.filter(e=>e.type===P))},[j]),(0,a.useEffect)(()=>{(async()=>{try{var e;let t=await (0,$.ur)();W(null!==(e=null==t?void 0:t.data)&&void 0!==e?e:[])}catch(e){console.error(e.message)}})()},[]);let eh=e=>{let t={action:"Action",logs:"Logs",crop:"Crop",text_recommendation:"Text-Form Recommendation",region:"Region",province:"Province",municipality:"Municipality",month:"Month",type:"Type",updated_by:"Updated by",date_created:"Date Created"},n=[];["action","logs","crop","text_recommendation","region","province","municipality","month","type","updated_by","date_created"].forEach(e=>{"action"===e?n.push({field:e,headerName:t[e],width:100,editable:!1,sortable:!1,disableColumnMenu:!0,renderCell:e=>(0,s.jsx)(h.Z,{variant:"outlined",size:"small",onClick:t=>{t.stopPropagation(),c.push({pathname:"/admin/sms/viewSMS/",query:{docId:e.row.docId}})},children:"SEND"})}):"logs"===e?n.push({field:e,headerName:t[e],width:100,editable:!1,sortable:!1,disableColumnMenu:!0,renderCell:e=>{var t;return(null===(t=e.row.logs)||void 0===t?void 0:t.length)>0?(0,s.jsx)(h.Z,{variant:"outlined",size:"small",onClick:()=>{D(!0),M(e.row)},children:"VIEW LOGS"}):(0,s.jsx)(l.Z,{sx:{fontWeight:"bold"},children:"UNSENT"})}}):n.push({field:e,headerName:t[e],width:150,editable:!1,sortable:!1,disableColumnMenu:!0})}),x(e.map((e,t)=>({id:t,docId:e.id,logs:e.logs,crop:e.crop,text_recommendation:e.smsRecommendations||"No SMS Recommendations available",logs:e.logs,region:e.region,province:e.province,municipality:e.municipality,month:e.month,type:e.type,updated_by:e.updated_by,date_created:"".concat(e.date_created.toDate().toDateString(),"\n          ").concat(e.date_created.toDate().toLocaleTimeString("it-IT",J.W6))}))),p(n)};(0,a.useEffect)(()=>{void 0===Object.keys(c.query)[0]&&(E(!1),_({})),"isSent"===Object.keys(c.query)[0]&&(k(!1),E(!0),ex({message:"true"===c.query.isSent?"Successfully sent Crop Recommendation via text!":"Unsuccessful in sending Crop Recommendation via text.",severity:"true"===c.query.isSent?"success":"error"}))},[c]),(0,a.useEffect)(()=>{o.loading||o.user||c.push("/admin/login")},[o.user,o.loading,c]);let ex=e=>{_(e)},em=async e=>{try{L(!0),await (0,ee.rE)(e)&&await ed(),L(!1),E(!0),_({message:"Successfully added a New Contact!",severity:"success"})}catch(e){console.error(e.message)}},ep=async e=>{try{L(!0);let t=await (0,ee.GK)({docId:e.id});T(!1),t&&await ed(),L(!1),E(!0),_({openSnackbar:!0,message:"Successfully deleted contact: ".concat(""===e.name?e.cellnumber:e.name,"!"),severity:"success"})}catch(e){console.error(e.message)}},ej=async e=>{try{L(!0);let t=await (0,ee.mP)({docId:e.id,name:e.name,cellnumber:e.cellnumber,nickname:e.nickname,province:e.province,municipality:e.municipality,subscribed_crops:e.selectedCrops});L(!1),T(!1),t&&await ed(),E(!0),_({openSnackbar:!0,message:"Successfully edit contact: ".concat(""===e.name?e.cellnumber:e.name,"!"),severity:"success"})}catch(e){console.error(e.message)}},eb=()=>{D(!1)};return(0,s.jsxs)(V.Z,{loading:t,user:n,onBtnLogoutClick:i,accLevel:X.DW.ADMIN,children:[(0,s.jsx)(e=>{let{report:t}=e;return(0,s.jsxs)(b.Z,{fullWidth:!0,maxWidth:"md",open:A,onClose:eb,children:[(0,s.jsx)(v.Z,{children:"SMS Recommendation Logs"}),(0,s.jsxs)(g.Z,{dividers:!0,children:[(0,s.jsx)(r.Z,{variant:"body2",children:"This is where you can check where you send your texts message."}),(0,s.jsx)("br",{}),(0,s.jsx)(eu,{logs:null==t?void 0:t.logs})]}),(0,s.jsx)(C.Z,{children:(0,s.jsx)(h.Z,{variant:"outlined",onClick:eb,children:"Close"})})]})},{report:O}),(0,s.jsx)(H,{columns:m,contacts:f,getContacts:ed,handleAddContact:em,handleDeleteContact:ep,handleEditContact:ej,handleReportTypeChange:e=>{let{value:t}=e.target;M(eh(j.filter(e=>e.type===t))),d((0,K.uq)(t))},loading:N,loadingReports:t,onBtnClick:i,open:w,rows:u,setOpen:T,toAddContact:c.query.toAddContact,user:o.user,loadingButton:I,regions:F,province:G,setProvince:q,municipality:U,setMunicipality:Y}),!N&&S&&(0,s.jsx)(z.Z,{openSnackbar:!0,message:R.message,severity:R.severity,closeHandler:()=>{E(!1)}})]})})},9704:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var s=n(67294),i=n(61061);function a(){let[e,t]=(0,s.useState)([]),[n,a]=(0,s.useState)(!1),[r,l]=(0,s.useState)("");return(0,s.useEffect)(()=>{(async()=>{var e,n,s;try{a(!0);let n=await (0,i.TQ)();t(null!==(e=null==n?void 0:n.list)&&void 0!==e?e:[]),a(!1),l("")}catch(e){l(null!==(s=null==e?void 0:null===(n=e.response)||void 0===n?void 0:n.data)&&void 0!==s?s:e.message),a(!1),t([])}})()},[]),{cropList:e,loading:n,error:r}}},40923:function(e,t,n){"use strict";n.d(t,{rE:function(){return c},GK:function(){return d},mP:function(){return u},K2:function(){return h}});var s=n(9669),i=n.n(s),a=n(15426);let r={CREATE_CONTACT:"".concat("https://amia-cis-tmtk.onrender.com/api","/contact"),DELETE_CONTACT:"".concat("https://amia-cis-tmtk.onrender.com/api","/contact"),EDIT_CONTACT:"".concat("https://amia-cis-tmtk.onrender.com/api","/contact"),GET_CONTACTS:"".concat("https://amia-cis-tmtk.onrender.com/api","/contacts")};class l extends a.Z{async createContact(e){let t=await this.createRequestObject({body:e});return(await i()({...t,url:r.CREATE_CONTACT,method:"POST"})).data}async deleteContact(e){let t=await this.createRequestObject({body:e});return(await i()({...t,url:r.DELETE_CONTACT,method:"DELETE"})).data}async editContact(e){let t=await this.createRequestObject({body:e});return(await i()({...t,url:r.EDIT_CONTACT,method:"PATCH"})).data}async getContacts(){let e=await this.createRequestObject({});return(await i()({...e,url:r.GET_CONTACTS,method:"GET"})).data.contacts}}let o=new l,c=o.createContact.bind(o),d=o.deleteContact.bind(o),u=o.editContact.bind(o),h=o.getContacts.bind(o)}},function(e){e.O(0,[3153,6856,190,8583,1664,6541,955,4073,2380,5837,6080,3481,3338,7988,3805,3270,4740,9227,8591,2888,9774,179],function(){return e(e.s=91099)}),_N_E=e.O()}]);