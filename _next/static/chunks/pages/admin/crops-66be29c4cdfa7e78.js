(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7794,7595],{67142:function(e,a,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/crops",function(){return r(83935)}])},60762:function(e,a,r){"use strict";r.d(a,{Z:function(){return f}});var t=r(87462),n=r(63366),l=r(67294),s=r(90512),o=r(94780),i=r(77527),d=r(44001),c=r(93454),u=r(1588),h=r(34867);function p(e){return(0,h.ZP)("MuiCard",e)}(0,u.Z)("MuiCard",["root"]);var C=r(85893);let b=["className","raised"],m=e=>{let{classes:a}=e;return(0,o.Z)({root:["root"]},p,a)},x=(0,i.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,a)=>a.root})(()=>({overflow:"hidden"}));var f=l.forwardRef(function(e,a){let r=(0,d.i)({props:e,name:"MuiCard"}),{className:l,raised:o=!1}=r,i=(0,n.Z)(r,b),c=(0,t.Z)({},r,{raised:o}),u=m(c);return(0,C.jsx)(x,(0,t.Z)({className:(0,s.Z)(u.root,l),elevation:o?8:void 0,ref:a,ownerState:c},i))})},71919:function(e,a,r){"use strict";r.d(a,{Z:function(){return x}});var t=r(87462),n=r(63366),l=r(67294),s=r(90512),o=r(94780),i=r(77527),d=r(44001),c=r(1588),u=r(34867);function h(e){return(0,u.ZP)("MuiCardContent",e)}(0,c.Z)("MuiCardContent",["root"]);var p=r(85893);let C=["className","component"],b=e=>{let{classes:a}=e;return(0,o.Z)({root:["root"]},h,a)},m=(0,i.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,a)=>a.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}}));var x=l.forwardRef(function(e,a){let r=(0,d.i)({props:e,name:"MuiCardContent"}),{className:l,component:o="div"}=r,i=(0,n.Z)(r,C),c=(0,t.Z)({},r,{component:o}),u=b(c);return(0,p.jsx)(m,(0,t.Z)({as:o,className:(0,s.Z)(u.root,l),ownerState:c,ref:a},i))})},12193:function(e,a,r){"use strict";r(67294);var t=r(13077),n=r(85893);a.Z=(0,t.Z)((0,n.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},83935:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return _}});var t=r(85893),n=r(65328),l=r(45773),s=r(67294),o=r(60990),i=r(96788),d=r(51015),c=r(44723),u=r(60762),h=r(71919),p=r(97182),C=r(25026),b=r(93454),m=r(76592),x=r(70360),f=r(46577),Z=r(8863),j=r(19827),y=r(13539),g=r(52857),w=r(33453),v=r(92365),A=r(40110),S=r(26541),N=r(96727),P=r(13077),k=(0,P.Z)((0,t.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),D=(0,P.Z)((0,t.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit"),M=(0,P.Z)((0,t.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),E=r(77595),R=function(){let[e,a]=(0,s.useState)([]),[r,n]=(0,s.useState)(!0),[l,P]=(0,s.useState)(""),[R,T]=(0,s.useState)(""),[_,O]=(0,s.useState)(!1),[L,z]=(0,s.useState)(null),[F,I]=(0,s.useState)({name:"",label:"",enabled:!0});(0,s.useEffect)(()=>{q()},[]);let q=async()=>{try{n(!0);let e=await (0,E.Rd)();a(e),P("")}catch(e){P("Failed to load crops: "+e.message)}finally{n(!1)}},H=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(z(e),I({name:e.name,label:e.label,enabled:e.enabled})):(z(null),I({name:"",label:"",enabled:!0})),O(!0)},V=()=>{O(!1),z(null),I({name:"",label:"",enabled:!0})},W=async()=>{try{if(P(""),T(""),!F.name||!F.label){P("Name and Label are required");return}L?(await (0,E.Ak)(L.id,F),T("Crop updated successfully")):(await (0,E.e)(F),T("Crop added successfully")),await q(),V()}catch(e){P("Failed to save crop: "+e.message)}},B=async e=>{try{P(""),await (0,E.Ak)(e.id,{enabled:!e.enabled}),await q(),T("Crop ".concat(e.enabled?"disabled":"enabled"," successfully"))}catch(e){P("Failed to update crop: "+e.message)}},U=async e=>{if(confirm('Are you sure you want to delete "'.concat(e.label,'"?')))try{P(""),await (0,E.aD)(e.id),await q(),T("Crop deleted successfully")}catch(e){P("Failed to delete crop: "+e.message)}};return(0,t.jsxs)(o.Z,{sx:{p:3},children:[(0,t.jsxs)(o.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,t.jsx)(i.Z,{variant:"h4",children:"Crops Management"}),(0,t.jsx)(d.Z,{variant:"contained",color:"primary",startIcon:(0,t.jsx)(k,{}),onClick:()=>H(),children:"Add New Crop"})]}),l&&(0,t.jsx)(c.Z,{severity:"error",sx:{mb:2},onClose:()=>P(""),children:l}),R&&(0,t.jsx)(c.Z,{severity:"success",sx:{mb:2},onClose:()=>T(""),children:R}),(0,t.jsx)(u.Z,{children:(0,t.jsxs)(h.Z,{children:[(0,t.jsx)(i.Z,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Manage crops available in the system. Only enabled crops will appear in dropdowns throughout the application."}),r?(0,t.jsx)(o.Z,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,t.jsx)(p.Z,{})}):(0,t.jsx)(C.Z,{component:b.Z,children:(0,t.jsxs)(m.Z,{children:[(0,t.jsx)(x.Z,{children:(0,t.jsxs)(f.Z,{children:[(0,t.jsx)(Z.Z,{children:"Name"}),(0,t.jsx)(Z.Z,{children:"Label"}),(0,t.jsx)(Z.Z,{children:"Status"}),(0,t.jsx)(Z.Z,{align:"right",children:"Actions"})]})}),(0,t.jsx)(j.Z,{children:e.map(e=>(0,t.jsxs)(f.Z,{children:[(0,t.jsx)(Z.Z,{children:e.name}),(0,t.jsx)(Z.Z,{children:e.label}),(0,t.jsxs)(Z.Z,{children:[(0,t.jsx)(y.Z,{checked:e.enabled,onChange:()=>B(e),color:"primary"}),e.enabled?"Enabled":"Disabled"]}),(0,t.jsxs)(Z.Z,{align:"right",children:[(0,t.jsx)(g.Z,{color:"primary",onClick:()=>H(e),size:"small",children:(0,t.jsx)(D,{})}),(0,t.jsx)(g.Z,{color:"error",onClick:()=>U(e),size:"small",children:(0,t.jsx)(M,{})})]})]},e.id))})]})})]})}),(0,t.jsxs)(w.Z,{open:_,onClose:V,maxWidth:"sm",fullWidth:!0,children:[(0,t.jsx)(v.Z,{children:L?"Edit Crop":"Add New Crop"}),(0,t.jsx)(A.Z,{children:(0,t.jsxs)(o.Z,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,t.jsx)(S.Z,{label:"Crop Name",value:F.name,onChange:e=>I({...F,name:e.target.value}),disabled:!!L,required:!0,helperText:"Unique identifier (e.g., Rice, Corn)"}),(0,t.jsx)(S.Z,{label:"Display Label",value:F.label,onChange:e=>I({...F,label:e.target.value}),required:!0,helperText:"Human-readable label shown in dropdowns"}),(0,t.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,t.jsx)(y.Z,{checked:F.enabled,onChange:e=>I({...F,enabled:e.target.checked}),color:"primary"}),(0,t.jsx)(i.Z,{children:"Enabled"})]})]})}),(0,t.jsxs)(N.Z,{children:[(0,t.jsx)(d.Z,{onClick:V,children:"Cancel"}),(0,t.jsx)(d.Z,{onClick:W,variant:"contained",color:"primary",children:L?"Update":"Add"})]})]})]})},T=r(98813),_=(0,n.Z)(function(e){let{loading:a,user:r,onBtnLogoutClick:n}=e;return(0,t.jsx)(l.Z,{loading:a,user:r,onBtnLogoutClick:n,accLevel:T.DW.ADMIN,children:(0,t.jsx)(R,{})})})},77595:function(e,a,r){"use strict";r.d(a,{e:function(){return d},aD:function(){return u},Rd:function(){return i},getCrops:function(){return o},Ak:function(){return c}});var t=r(96171);let n={CONSTANTS:"constants",CROPS:"crops"};class l extends t.Z{async getCrops(){try{let e=await this.getDocumentData(n.CONSTANTS,n.CROPS);if(null==e?void 0:e.crops)return e.crops.filter(e=>!1!==e.enabled);return this.getDefaultCrops()}catch(e){return console.error("Error fetching crops:",e),this.getDefaultCrops()}}async getAllCrops(){try{let e=await this.getDocumentData(n.CONSTANTS,n.CROPS);if(null==e?void 0:e.crops)return e.crops;return this.getDefaultCrops()}catch(e){return console.error("Error fetching all crops:",e),this.getDefaultCrops()}}async updateCrops(e){try{let a=this.doc(this.db,n.CONSTANTS,n.CROPS);await this.updateDoc(a,{crops:e})}catch(e){throw console.error("Error updating crops:",e),e}}async addCrop(e){try{let a=await this.getAllCrops(),r={id:e.name,name:e.name,label:e.label||e.name,enabled:!1!==e.enabled};a.push(r),await this.updateCrops(a)}catch(e){throw console.error("Error adding crop:",e),e}}async updateCrop(e,a){try{let r=await this.getAllCrops(),t=r.findIndex(a=>a.id===e);-1!==t&&(r[t]={...r[t],...a},await this.updateCrops(r))}catch(e){throw console.error("Error updating crop:",e),e}}async deleteCrop(e){try{let a=(await this.getAllCrops()).filter(a=>a.id!==e);await this.updateCrops(a)}catch(e){throw console.error("Error deleting crop:",e),e}}getDefaultCrops(){return[{id:"Rice",name:"Rice",label:"Rice",enabled:!0},{id:"Corn",name:"Corn",label:"Corn",enabled:!0},{id:"Pili",name:"Pili",label:"Pili",enabled:!1},{id:"Ampalaya",name:"Ampalaya",label:"Ampalaya",enabled:!1},{id:"PoleSitao",name:"PoleSitao",label:"Pole Sitao",enabled:!1},{id:"Cassava",name:"Cassava",label:"Cassava",enabled:!1},{id:"Coconut",name:"Coconut",label:"Coconut",enabled:!1},{id:"Pineapple",name:"Pineapple",label:"Pineapple",enabled:!1},{id:"Abaca",name:"Abaca",label:"Abaca",enabled:!1},{id:"Cut-flowers",name:"Cut-flowers",label:"Cut Flowers",enabled:!1},{id:"Livestock",name:"Livestock",label:"Livestock",enabled:!1},{id:"Poultry",name:"Poultry",label:"Poultry",enabled:!1},{id:"Fisheries",name:"Fisheries (brackish and freshwater)",label:"Fisheries (brackish and freshwater)",enabled:!1}]}}let s=new l,o=()=>s.getCrops(),i=()=>s.getAllCrops(),d=e=>s.addCrop(e),c=(e,a)=>s.updateCrop(e,a),u=e=>s.deleteCrop(e)}},function(e){e.O(0,[3153,7023,3745,1664,6541,8848,6294,6905,6080,4723,20,9227,8591,2888,9774,179],function(){return e(e.s=67142)}),_N_E=e.O()}]);