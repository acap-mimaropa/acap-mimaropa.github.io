(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7794,7595],{67142:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/crops",function(){return l(23950)}])},23950:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return O}});var n=l(85893),r=l(65328),t=l(45773),s=l(67294),i=l(60990),o=l(96788),d=l(51015),c=l(44723),u=l(60762),p=l(71919),h=l(97182),b=l(25026),C=l(93454),x=l(76592),m=l(70360),f=l(46577),y=l(8863),j=l(19827),Z=l(13539),g=l(52857),w=l(33453),v=l(92365),A=l(40110),S=l(26541),k=l(96727),N=l(53839),P=l(17071),D=l(89090),E=l(77595),T=function(){let[e,a]=(0,s.useState)([]),[l,r]=(0,s.useState)(!0),[t,T]=(0,s.useState)(""),[_,O]=(0,s.useState)(""),[R,F]=(0,s.useState)(!1),[L,I]=(0,s.useState)(null),[q,M]=(0,s.useState)({name:"",label:"",enabled:!0});(0,s.useEffect)(()=>{W()},[]);let W=async()=>{try{r(!0);let e=await (0,E.Rd)();a(e),T("")}catch(e){T("Failed to load crops: "+e.message)}finally{r(!1)}},z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(I(e),M({name:e.name,label:e.label,enabled:e.enabled})):(I(null),M({name:"",label:"",enabled:!0})),F(!0)},U=()=>{F(!1),I(null),M({name:"",label:"",enabled:!0})},X=async()=>{try{if(T(""),O(""),!q.name||!q.label){T("Name and Label are required");return}L?(await (0,E.Ak)(L.id,q),O("Crop updated successfully")):(await (0,E.e)(q),O("Crop added successfully")),await W(),U()}catch(e){T("Failed to save crop: "+e.message)}},B=async e=>{try{T(""),await (0,E.Ak)(e.id,{enabled:!e.enabled}),await W(),O("Crop ".concat(e.enabled?"disabled":"enabled"," successfully"))}catch(e){T("Failed to update crop: "+e.message)}},H=async e=>{if(confirm('Are you sure you want to disable "'.concat(e.label,'"?')))try{T(""),await (0,E.aD)(e.id),await W(),O("Crop disabled successfully")}catch(e){T("Failed to delete crop: "+e.message)}};return(0,n.jsxs)(i.Z,{sx:{p:3},children:[(0,n.jsxs)(i.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,n.jsx)(o.Z,{variant:"h4",children:"Crops Management"}),(0,n.jsx)(d.Z,{variant:"contained",color:"primary",startIcon:(0,n.jsx)(N.Z,{}),onClick:()=>z(),children:"Add New Crop"})]}),t&&(0,n.jsx)(c.Z,{severity:"error",sx:{mb:2},onClose:()=>T(""),children:t}),_&&(0,n.jsx)(c.Z,{severity:"success",sx:{mb:2},onClose:()=>O(""),children:_}),(0,n.jsx)(u.Z,{children:(0,n.jsxs)(p.Z,{children:[(0,n.jsx)(o.Z,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Manage crops available in the system. Only enabled crops will appear in dropdowns throughout the application."}),l?(0,n.jsx)(i.Z,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,n.jsx)(h.Z,{})}):(0,n.jsx)(b.Z,{component:C.Z,children:(0,n.jsxs)(x.Z,{children:[(0,n.jsx)(m.Z,{children:(0,n.jsxs)(f.Z,{children:[(0,n.jsx)(y.Z,{children:"Name"}),(0,n.jsx)(y.Z,{children:"Label"}),(0,n.jsx)(y.Z,{children:"Status"}),(0,n.jsx)(y.Z,{align:"right",children:"Actions"})]})}),(0,n.jsx)(j.Z,{children:e.map(e=>(0,n.jsxs)(f.Z,{children:[(0,n.jsx)(y.Z,{children:e.name}),(0,n.jsx)(y.Z,{children:e.label}),(0,n.jsxs)(y.Z,{children:[(0,n.jsx)(Z.Z,{checked:e.enabled,onChange:()=>B(e),color:"primary"}),e.enabled?"Enabled":"Disabled"]}),(0,n.jsxs)(y.Z,{align:"right",children:[(0,n.jsx)(g.Z,{color:"primary",onClick:()=>z(e),size:"small",children:(0,n.jsx)(P.Z,{})}),(0,n.jsx)(g.Z,{color:"error",onClick:()=>H(e),size:"small",children:(0,n.jsx)(D.Z,{})})]})]},e.id))})]})})]})}),(0,n.jsxs)(w.Z,{open:R,onClose:U,maxWidth:"sm",fullWidth:!0,children:[(0,n.jsx)(v.Z,{children:L?"Edit Crop":"Add New Crop"}),(0,n.jsx)(A.Z,{children:(0,n.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,n.jsx)(S.Z,{label:"Crop Name",value:q.name,onChange:e=>M({...q,name:e.target.value}),disabled:!!L,required:!0,helperText:"Unique identifier (e.g., Rice, Corn)"}),(0,n.jsx)(S.Z,{label:"Display Label",value:q.label,onChange:e=>M({...q,label:e.target.value}),required:!0,helperText:"Human-readable label shown in dropdowns"}),(0,n.jsxs)(i.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(Z.Z,{checked:q.enabled,onChange:e=>M({...q,enabled:e.target.checked}),color:"primary"}),(0,n.jsx)(o.Z,{children:"Enabled"})]})]})}),(0,n.jsxs)(k.Z,{children:[(0,n.jsx)(d.Z,{onClick:U,children:"Cancel"}),(0,n.jsx)(d.Z,{onClick:X,variant:"contained",color:"primary",children:L?"Update":"Add"})]})]})]})},_=l(98813),O=(0,r.Z)(function(e){let{loading:a,user:l,onBtnLogoutClick:r}=e;return(0,n.jsx)(t.Z,{loading:a,user:l,onBtnLogoutClick:r,accLevel:_.DW.ADMIN,children:(0,n.jsx)(T,{})})})},77595:function(e,a,l){"use strict";l.d(a,{e:function(){return d},aD:function(){return u},Rd:function(){return o},getCrops:function(){return i},Ak:function(){return c}});var n=l(96171);let r={CONSTANTS:"constants",CROPS:"crops"};class t extends n.Z{async getCrops(){try{var e;let a=await this.getDocumentData(r.CONSTANTS,r.CROPS);if(null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.crops)return a.data.crops.filter(e=>!1!==e.enabled);return this.getDefaultCrops()}catch(e){return console.error("Error fetching crops:",e),this.getDefaultCrops()}}async getAllCrops(){try{var e;let a=await this.getDocumentData(r.CONSTANTS,r.CROPS);if(null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.crops)return a.data.crops;return this.getDefaultCrops()}catch(e){return console.error("Error fetching all crops:",e),this.getDefaultCrops()}}async updateCrops(e){try{let a=this.doc(this.db,r.CONSTANTS,r.CROPS);await this.updateDoc(a,{crops:e})}catch(e){throw console.error("Error updating crops:",e),e}}async addCrop(e){try{let a=await this.getAllCrops(),l={id:e.name,name:e.name,label:e.label||e.name,enabled:!1!==e.enabled};a.push(l),await this.updateCrops(a)}catch(e){throw console.error("Error adding crop:",e),e}}async updateCrop(e,a){try{let l=await this.getAllCrops(),n=l.findIndex(a=>a.id===e);-1!==n&&(l[n]={...l[n],...a},await this.updateCrops(l))}catch(e){throw console.error("Error updating crop:",e),e}}async deleteCrop(e){try{await this.updateCrop(e,{enabled:!1})}catch(e){throw console.error("Error deleting crop:",e),e}}getDefaultCrops(){return[{id:"Rice",name:"Rice",label:"Rice",enabled:!0},{id:"Corn",name:"Corn",label:"Corn",enabled:!0},{id:"Pili",name:"Pili",label:"Pili",enabled:!1},{id:"Ampalaya",name:"Ampalaya",label:"Ampalaya",enabled:!1},{id:"PoleSitao",name:"PoleSitao",label:"Pole Sitao",enabled:!1},{id:"Cassava",name:"Cassava",label:"Cassava",enabled:!1},{id:"Coconut",name:"Coconut",label:"Coconut",enabled:!1},{id:"Pineapple",name:"Pineapple",label:"Pineapple",enabled:!1},{id:"Abaca",name:"Abaca",label:"Abaca",enabled:!1},{id:"Cut-flowers",name:"Cut-flowers",label:"Cut Flowers",enabled:!1},{id:"Livestock",name:"Livestock",label:"Livestock",enabled:!1},{id:"Poultry",name:"Poultry",label:"Poultry",enabled:!1},{id:"Fisheries",name:"Fisheries (brackish and freshwater)",label:"Fisheries (brackish and freshwater)",enabled:!1}]}}let s=new t,i=()=>s.getCrops(),o=()=>s.getAllCrops(),d=e=>s.addCrop(e),c=(e,a)=>s.updateCrop(e,a),u=e=>s.deleteCrop(e)}},function(e){e.O(0,[3153,6856,190,8583,1664,6541,955,4073,6455,6080,4723,9227,8796,8591,2888,9774,179],function(){return e(e.s=67142)}),_N_E=e.O()}]);