(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3359],{29926:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/weather",function(){return t(75427)}])},43691:function(e,a,t){"use strict";t.d(a,{x:function(){return s},P:function(){return l}});var n=t(85893),i=t(60990),s=function(e){let{children:a,value:t,index:s,...l}=e;return(0,n.jsx)("div",{role:"tabpanel",hidden:t!==s,id:"custom-tabpanel-".concat(s),"aria-labelledby":"custom-tab-".concat(s),...l,children:t===s&&(0,n.jsx)(i.Z,{sx:{p:3},children:a})})},l=function(e){return{id:"custom-tab-".concat(e),"aria-controls":"custom-tabpanel-".concat(e)}}},75427:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return au}});var n=t(85893),i=t(67294),s=t(9473),l=t(444),r=t(65328),o=t(45773),d=t(60990),c=t(28907),p=t(88607),u=t(43691),h=t(7520),x=t(96788),g=t(83993),m=t(49833),f=t(71713),j=t(92246),v=t(25517),b=t(26525),y=t(51015),S=t(68573),C=t(95611),Z=t(26541),w=t(73705),E=t(22233),A={marginTop:e=>e.spacing(3)},T={color:"gray",marginBottom:e=>e.spacing(1),marginTop:e=>e.spacing(1)},_={display:"flex",marginTop:"12px",maxWidth:"250px"},P=t(90117),M=t(70290),I=t(63662),L=function(e){let{state:a,file:t,isDisabled:i,handleInputChange:s,handleClearClick:l,handleFileUpload:r,handleFileSelected:o}=e;return(0,n.jsxs)(S.ZP,{container:!0,sx:A,children:[(0,n.jsx)(S.ZP,{item:!0,xs:12,children:(0,n.jsx)(E.Z,{label:"Upload an excel file",name:"excelfile",fileAccepts:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",isDisabled:i,fileUploadMethod:r,onFileSelectedCB:o})}),(0,n.jsxs)(S.ZP,{item:!0,xs:12,sx:{marginTop:"24px"},children:[(0,n.jsx)(x.Z,{variant:"h6",children:"Tropical Cyclone Input"}),(0,n.jsxs)(x.Z,{variant:"body2",sx:T,children:["Select PAGASA's shared seasonal weather forecast excel file on the ",(0,n.jsx)("strong",{children:"Upload an excel file"})," selector to unlock the Tropical Cyclone Input items below.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Then, enter the number of tropical cyclones (0 up to 10) for each month with following its picture reference on the 3rd tab ",(0,n.jsx)("br",{})," from the selected PAGASA-shared seasonal weather forecast excel file.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Write ",(0,n.jsx)("span",{style:{color:"orange"},children:(0,n.jsx)("b",{children:"nda"})}),' if there is "no data available" for the given month.']})]}),(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:7,children:a.map((e,a)=>(0,n.jsx)(Z.Z,{id:"month-".concat(a),size:"small",label:e.full,value:e.value,placeholder:"".concat(e.full," no. of cyclones"),sx:_,disabled:i||null===t,onChange:s,InputProps:{startAdornment:(0,n.jsx)(C.Z,{position:"start",children:""===e.value?(0,n.jsx)(P.Z,{fontSize:"small",color:"primary"}):e.isValid?(0,n.jsx)(M.Z,{fontSize:"small",color:"secondary"}):(0,n.jsx)(I.Z,{fontSize:"small",sx:{color:w.Z[500]}})})}},a))}),(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:5,children:"\xa0"}),(0,n.jsx)(S.ZP,{item:!0,xs:4,sx:{marginTop:"12px"},children:(0,n.jsx)(y.Z,{variant:"text",onClick:l,disableElevation:!0,children:"Clear All"})})]})};let k=["1st month","2nd month","3rd month","4th month","5th month","6th month"],O=e=>{let a=[0,1,2,3,4,5,6,7,8,9,10].map(e=>e.toString()).includes(e),t=/^([0-9]|10) or ([0-9]|10)$/g.test(e),n=/^([0-9]|10) to ([0-9]|10)$/g.test(e);return t||n||a||"nda"===e};var D=function(){let[e,a]=(0,i.useState)([]),[t,l]=(0,i.useState)(null),r=(0,s.I0)(),o=(0,s.v9)(e=>e.seasonalweather.status);(0,i.useEffect)(()=>{6===k.length&&a(k.reduce((e,a,t)=>[...e,{id:t,full:a,month:a,isValid:!1,value:""}],[]))},[!1]);let d=()=>{a(e.map(e=>({...e,isValid:!1,value:""})))},c=async a=>new Promise(async(t,n)=>{if(e.filter(e=>!e.isValid).length>=1)n(Error("Please check your tropical cyclones list input"));else try{let n=await (0,m.BZ)(a);await (0,m.eg)({type:b.M.SUB_SEASONAL_COMMON,body:{data:e.map(e=>({id:e.id,value:e.value})),region:"mimaropa",type:b.M.COMMON_SEASONAL_REGIONAL_TYPE.CYCLONES_COUNT}}),r((0,f.Mj)(n.map(e=>({...e,date_created:(0,j.NK)(e.date_created)})))),d(),t(!0)}catch(e){n(e)}});return(0,n.jsx)(L,{state:e,file:t,isDisabled:o===v.G.PENDING,handleInputChange:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update",{id:i,value:s}=t.target,l=i.split("-")[1],r=[...e];r[l]&&("clear"===n?(r[l].value="",r[l].isValid=!1):(r[l].value=s,s.length>=10?r[l].isValid=!1:r[l].isValid=""!==s&&O(s)),a(e=>r))},handleClearClick:d,handleFileUpload:c,handleFileSelected:e=>{l(e),e||d()}})},N=t(91154),G=t(49986),F=t(9883),R=t(20481),W=t(16729),U=t(17553),z=t(32209),B={marginTop:e=>e.spacing(3)},V={color:"gray",marginBottom:e=>e.spacing(1),marginTop:e=>e.spacing(1)},H={display:"flex",marginTop:"12px",maxWidth:"parent","& .MuiOutlinedInput-root":{paddingLeft:e=>e.spacing(2)}},Y={height:e=>e.spacing(5),width:"40px",borderTopLeftRadius:0,borderBottomLeftRadius:0,"& span":{marginRight:0}},X={marginTop:"8px","& button":{width:"110px"},display:{sm:"flex",md:"unset"},flexDirection:{sm:"column"}},J=t(4145),K=function(e){let{state:a,message:t,log:i,isLoading:s,handleInputChange:l,handleDeleteClick:r,handleClearClick:o,handleReset:d,handleAddClick:c,handleSaveClick:p,handleCancelSaveClick:u,handleResetMsg:h,onSaveClick:g}=e;return(0,n.jsxs)(S.ZP,{container:!0,sx:B,children:[t.openLoadingModal&&(0,n.jsx)(W.Z,{isOpen:!0,title:"Save changes",contentText:t.modalMsg,loading:s,openButtonText:null,modalConfirmHandlerCB:g,modalCancelHandlerCB:u}),""!==t.msg&&(0,n.jsx)(U.Z,{openSnackbar:!0,message:t.msg,severity:t.type,closeHandlerCB:h}),(0,n.jsxs)(S.ZP,{item:!0,xs:12,sx:{marginTop:"24px",marginBottom:"8px"},children:[(0,n.jsx)(x.Z,{variant:"h6",children:"Weather Systems that May Affect the Region"}),(0,n.jsxs)(x.Z,{variant:"body2",sx:V,children:["Below is a list of other weather systems that may affect the region. Edit the existing contents or add/delete some items,",(0,n.jsx)("br",{}),"then press the ",(0,n.jsx)("strong",{children:"SAVE"})," button to save your changes. ",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Press the ",(0,n.jsx)("strong",{children:"RESET"})," button to undo your changes to the last SAVE point. Press the ",(0,n.jsx)("strong",{children:"CLEAR ALL"})," button to remove all items."]}),(0,n.jsx)(z.Z,{children:s?"Loading...":"Updated by ".concat(i.updated_by," on ").concat(i.date_created,".")})]}),(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:6,children:a.map((e,a)=>(0,n.jsx)(R.Z,{id:"misc-".concat(a),size:"small",label:e.full,value:e.value,placeholder:"Enter a weather system",sx:H,disabled:s,onChange:l,InputProps:{startAdornment:(0,n.jsx)(C.Z,{position:"start",children:""===e.value?(0,n.jsx)(P.Z,{fontSize:"small",color:"primary"}):e.isValid?(0,n.jsx)(M.Z,{fontSize:"small",color:"secondary"}):(0,n.jsx)(I.Z,{fontSize:"small",sx:{color:w.Z[500]}})}),endAdornment:(0,n.jsx)(F.Z,{disableElevation:!0,disabled:s,startIcon:(0,n.jsx)(J.Z,{fontSize:"small"}),sx:Y,onClick:()=>r(a)})}},a))}),(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:5,children:"\xa0"}),(0,n.jsx)(S.ZP,{item:!0,xs:12,sx:{marginTop:"24px"},children:(0,n.jsxs)(G.Z,{variant:"text",disableElevation:!0,size:"small",sx:X,disabled:s,children:[(0,n.jsx)(F.Z,{onClick:o,children:"Clear All"}),(0,n.jsx)(F.Z,{onClick:d,children:"Reset"}),(0,n.jsx)(F.Z,{onClick:c,children:"Add"}),(0,n.jsx)(F.Z,{onClick:p,variant:"contained",children:"Save"})]})})]})};let Q={success:"success",error:"error",info:"info"},q={msg:"",type:"",modalMsg:"Save changes to the weather systems list?",openLoadingModal:!1};var $=function(){let[e,a]=(0,i.useState)([]),[t,l]=(0,i.useState)(q),[r,o]=(0,i.useState)(!1),d=(0,s.I0)(),c=(0,i.useRef)(!1),{ids:p,entities:u,status:h,updated_by:x,date_created:g}=(0,s.v9)(e=>e.seasonalcommon_misc);(0,i.useEffect)(()=>(c.current=!0,d((0,N.h)()).unwrap().then(()=>{c.current&&o(!0)}),()=>{c.current=!1}),[d]);let m=(0,i.useCallback)(()=>{c.current&&(l(e=>q),a(e=>Object.values(u).map(e=>({...e,isValid:!0}))))},[u]);return(0,i.useEffect)(()=>{h===v.G.FULLFILLED&&p.length>0&&r&&m()},[h,p,r,m]),(0,n.jsx)(K,{state:e,message:t,log:{updated_by:x,date_created:g},isLoading:h===v.G.PENDING,handleInputChange:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update",{id:i,value:s}=t.target,l=i.split("-")[1],r=[...e];r[l]&&("clear"===n?(r[l].value="",r[l].isValid=!1):(r[l].value=s,s.length>=30?r[l].isValid=!1:r[l].isValid=""!==s),c.current&&a(e=>r))},handleClearClick:()=>a([]),handleDeleteClick:t=>{c.current&&a(a=>e.reduce((e,a,n)=>(n!==t&&(e=[...e,a]),e),[]).map((e,a)=>({...e,id:a})))},handleReset:m,handleAddClick:()=>{if(25===e.length||!c.current)return;let t=[...e];t.push({id:t.length,value:""}),a(t)},handleSaveClick:()=>l({...t,openLoadingModal:!0}),handleCancelSaveClick:()=>l({...t,openLoadingModal:!1}),handleResetMsg:()=>l(q),onSaveClick:()=>{if(c.current){if(void 0!==e.find(e=>""===e.value)){l(e=>({...e,msg:"Please check your input",type:Q.info,openLoadingModal:!1}));return}l({...t,modalMsg:"Saving..."}),d((0,N.O)(e)).unwrap().then(()=>{c.current&&l(e=>({...q,msg:"Successfully saved changes.",type:Q.success}))}).catch(e=>{c.current&&l(a=>({...q,msg:e,type:Q.error}))})}}})},ee=t(31292),ea=function(){return(0,n.jsxs)("div",{children:[(0,n.jsx)(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:e=>e.spacing(1)},children:(0,n.jsx)(x.Z,{variant:"h6",children:"Seasonal Weather Forecast Updater"})}),(0,n.jsx)("br",{}),(0,n.jsx)(x.Z,{variant:"h7",children:(0,n.jsx)("strong",{children:"Upload an Excel File"})}),(0,n.jsxs)(x.Z,{variant:"body2",sx:ee.Z.subheader,children:["Update ACAP's seasonal weather forecast rainfall, tropical cyclones, and weather systems affecting the region data by uploading the updated seasonal weather forecast raw data in the excel file provided by PAGASA by clicking the SEARCH button, followed by clicking the UPLOAD button under the ",(0,n.jsx)("strong",{children:"Upload an Excel File"})," option below.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:(0,n.jsx)("span",{style:{color:"orange"},children:"CAUTION:"})})," ","Since PAGASA's shared seasonal Excel file has no year data, the seasonal Excel file upload will take the current year as a basis for the starting 1st seasonal month.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"You can use the attached seasonal weather forecast excel file from PAGASA as a template when uploading an excel file. The excel file should follow the format and structure of the attached sample.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Write"," ",(0,n.jsx)("span",{style:{color:"orange"},children:(0,n.jsx)("b",{children:"nda"})})," ",'for Excel cell values with "no data available" for given month or parameter.',(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsxs)("label",{style:{fontSize:"12px"},children:["PAGASA's latest seasonal weather forecast is availabe on"," ",(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/climate/climate-prediction/seasonal-forecast",target:"_blank",rel:"noreferrer",children:"PAGASA' Seasonal (Rainfall) Forecast"})," ","web page for reference."]}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("a",{href:"https://firebasestorage.googleapis.com/v0/b/acap-mimaropa-dev.appspot.com/o/files%2Ftemplates%2Fpagasa_seasonal_v2.xlsx?alt=media&token=a0c3a02d-733a-47d7-9f86-42649fe4506e",target:"__blank",children:"[Seasonal Forecast Excel template]"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(g.Z,{withBorder:!0}),(0,n.jsx)(D,{}),(0,n.jsx)($,{})]})]})},et=t(18938),en=t(76281),ei=t(77527),es=t(81873),el=t(97182),er=t(44723);let eo=(0,ei.ZP)(e=>(0,n.jsx)(d.Z,{...e}))(e=>{let{theme:a}=e;return{display:"flex",alignItems:"center",maxWidth:"500px",minHeight:"100px",border:"1px solid gray",borderRadius:"8px",marginTop:a.spacing(1),marginBottom:a.spacing(3),"& ul":{listStyle:"none",paddingLeft:a.spacing(3)}}});var ed=function(e){return(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(x.Z,{sx:{marginTop:e=>e.spacing(4)},variant:"h6",children:e.title}),(0,n.jsx)(eo,{children:e.children})]})},ec=t(98813),ep=t(25675),eu=t.n(ep),eh=t(71604),ex=function(e){let{text:a,label:t,imagePath:i}=e;return(0,n.jsx)(d.Z,{sx:{borderRadius:"4px",margin:"4px",padding:"8.5px 14px 8.5px 8.5px",fontSize:"1rem",lineHeight:"1.4375em","& span":{marginLeft:"8px"}},children:(0,n.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(eu(),{unoptimized:!0,src:(0,eh.assetPrefixer)(i),height:20,width:20,loader:eh.imageLoader,alt:"moon phase"}),(0,n.jsxs)("span",{children:[t,":"]}),(0,n.jsx)("span",{children:a})]})})},eg={container:{marginTop:e=>e.spacing(3)},text:{color:"gray",marginBottom:e=>e.spacing(1),marginTop:e=>e.spacing(1)},rowItem:{display:"flex",marginTop:"16px",maxWidth:{xs:"100%",sm:"300px"}},btnGroup:{"& button":{width:"110px"},display:{sm:"flex",md:"unset"},flexDirection:{sm:"column"}}},em=function(e){let{state:a,message:t,log:i,isDisabled:s,isViewInfo:l,handleInputChange:r,handleClearClick:o,handleSaveClick:c,handleCancelSaveClick:p,handleSwitchClick:u,onSaveClick:h}=e;return(0,n.jsxs)(S.ZP,{container:!0,sx:eg.container,children:[t.openLoadingModal&&(0,n.jsx)(W.Z,{isOpen:!0,title:"Save changes",contentText:t.modalMsg,loading:s,openButtonText:null,modalConfirmHandlerCB:h,modalCancelHandlerCB:p}),""!==t.msg&&(0,n.jsx)(U.Z,{openSnackbar:!0,message:t.msg,severity:t.type,closeHandlerCB:p}),(0,n.jsxs)(S.ZP,{item:!0,xs:12,sx:{marginTop:"32px"},children:[(0,n.jsx)(x.Z,{variant:"h6",children:"Moon Phases Input"}),(0,n.jsxs)(x.Z,{variant:"body2",sx:eg.text,children:["Listed below are the moon phases data for the 10-Day weather outlook PDF moon phases section.",(0,n.jsx)("br",{}),"Click the ",(0,n.jsx)("strong",{children:"EDIT"})," button to start editing it's content."]}),(0,n.jsxs)(z.Z,{children:["Updated by ",i.updated_by," on ",i.date_created," from PAGASA's ",(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/astronomy/astronomical-diary",target:"_blank",rel:"noreferrer",children:"Astronomical Diary"})," web page."]})]}),(0,n.jsxs)(S.ZP,{item:!0,xs:12,lg:7,sx:{marginTop:"8px"},children:[l?a.map((e,a)=>(0,n.jsx)(ex,{text:e.value,label:e.label,imagePath:e.image},a)):a.map((e,a)=>(0,n.jsx)(Z.Z,{id:"month-".concat(a),size:"small",label:e.label,value:e.value,placeholder:"".concat(e.label," date i.e., 29-Jun-22"),sx:eg.rowItem,disabled:s,onChange:r,InputProps:{startAdornment:(0,n.jsx)(C.Z,{position:"start",children:""===e.value?(0,n.jsx)(P.Z,{fontSize:"small",color:"primary"}):e.isValid?(0,n.jsx)(M.Z,{fontSize:"small",color:"secondary"}):(0,n.jsx)(I.Z,{fontSize:"small",sx:{color:w.Z[500]}})})}},a)),(0,n.jsx)(d.Z,{sx:{marginTop:"24px",marginLeft:"8px"},children:(0,n.jsx)(G.Z,{variant:"text",size:"small",disabled:s,disableElevation:!0,sx:eg.btnGroup,children:l?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(F.Z,{variant:"contained",onClick:u,children:"Edit"})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(F.Z,{onClick:o,children:"Clear All"}),(0,n.jsx)(F.Z,{onClick:u,children:"Cancel"}),(0,n.jsx)(F.Z,{variant:"contained",onClick:c,disabled:s,children:"Save"})]})})})]})]})};let ef={NEW_MOON:{code:"new_moon",label:"New Moon"},FIRST_QUARTER:{code:"first_quarter",label:"First Quarter"},FULL_MOON:{code:"full_moon",label:"Full Moon"},LAST_QUARTER:{code:"last_quarter",label:"Last Quarter"}},ej={msg:"",type:"",action:"view",loading:!1,modalMsg:"Save changes to the moon phases list?",openLoadingModal:!1},ev={updated_by:"",date_created:""};var eb=function(){let[e,a]=(0,i.useState)([]),[t,s]=(0,i.useState)(ej),[l,r]=(0,i.useState)(ev),[o,d]=(0,i.useState)(!0),c=(0,i.useRef)(!1),[p,u,h]=(0,et.ky)(b.M.WEATHER_FORECASTS,"".concat("mimaropa","/").concat(b.M.SUB_TENDAY_COMMON,"/").concat(b.M.COMMON_TENDAY_TYPE.MOON_PHASES)),x=(0,i.useCallback)(e=>{e&&e.data&&a(a=>{let t=[...a];return e.data.forEach((e,a)=>{t[a]&&(t[a].value=e.value,t[a].isValid=""!==e.value)}),t})},[]);(0,i.useEffect)(()=>(c.current=!0,a(Object.values(ef).reduce((e,a,t)=>[...e,{id:t,value:"-",phase:a.code,label:a.label,image:"images/icons/moon/".concat(a.code,".svg"),isValid:!1}],[])),()=>{c.current=!1}),[]),(0,i.useEffect)(()=>{!u&&c.current&&p&&(x(p),r(e=>({...e,updated_by:p.updated_by,date_created:(0,j.Xn)(p.date_created)}))),""!==h&&c.current&&s({...ej,msg:h,type:ec.C7.ERROR})},[p,u,h,x]);let g=e=>{o||x(e||p),d(e=>!e)},f=async()=>{if(c.current)try{s({...ej,loading:!0,openLoadingModal:!0,modalMsg:"Saving changes..."});let a=await (0,m.eg)({type:b.M.SUB_TENDAY_COMMON,body:{region:"mimaropa",type:b.M.COMMON_TENDAY_TYPE.MOON_PHASES,data:e.map((e,a)=>({id:a,value:e.value,phase:e.phase}))}});c.current&&(s(e=>({...ej,msg:"Successfully saved changes",type:ec.C7.SUCCESS})),r(e=>({...e,updated_by:a.updated_by,date_created:(0,j.NK)(a.date_created)})),g(a))}catch(e){if(c.current){let a="";void 0!==e.response&&(a=void 0!==e.response.data?e.response.data:""),""===a&&(a=e.message),s({...ej,msg:a,type:ec.C7.ERROR})}}};return(0,n.jsx)(em,{state:e,message:t,log:l,isDisabled:t.loading,isViewInfo:o,handleInputChange:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update",{id:i,value:s}=t.target,l=i.split("-")[1],r=[...e];r[l]&&("clear"===n?(r[l].value="",r[l].isValid=!1):(r[l].value=s,s.length>=10?r[l].isValid=!1:r[l].isValid=""!==s),a(e=>r))},handleClearClick:()=>{a(e=>e.map(e=>({...e,isValid:!1,value:""})))},handleSaveClick:()=>{if(void 0!==e.find(e=>""===e.value)){s(e=>({...e,msg:"Please check your input",type:ec.C7.INFO,openLoadingModal:!1}));return}s({...t,openLoadingModal:!0})},handleCancelSaveClick:()=>s(ej),handleSwitchClick:()=>g(null),onSaveClick:f})},ey=e=>({marginBottom:e.spacing(2),color:"gray",marginTop:e.spacing(1),"& a":{color:e.palette.green.dark,textDecoration:"none"},"& a:visited":{color:e.palette.green.dark},"& a:hover, span:hover":{textDecoration:"underline"}}),eS={display:"flex",alignItems:"center",maxWidth:"500px",minHeight:"90px",border:"1px solid gray",borderRadius:"8px",fontSize:"14px",color:e=>e.palette.text.secondary,padding:e=>e.spacing(2),marginTop:e=>e.spacing(1),marginBottom:e=>e.spacing(1)},eC={maxWidth:"500px",marginBottom:e=>e.spacing(2)};let eZ=(0,ei.ZP)("input")({display:"none"});var ew=function(e){let{files:a=[],status:t,logs:i,handleSubmit:s,handleSelectFiles:l}=e;return(0,n.jsxs)(d.Z,{sx:{"& li":{fontSize:"14px"}},children:[(0,n.jsx)(x.Z,{sx:{marginTop:e=>e.spacing(1)},variant:"h6",children:"10-Day Weather Forecast Updater"}),(0,n.jsxs)(x.Z,{variant:"body2",sx:ey,children:["ACAP's system updates its internal 10-Day Weather Forecast data by automatically downloading, parsing, and uploading the 10-day weather forecast excel files from PAGASA's ",(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/climate/climate-prediction/10-day-climate-forecast",target:"_blank",rel:"noreferrer",children:"10-Day Climate Forecast"})," web page to ACAP's database.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"ACAP's daily automatic 10-Day Weather Forecast updating runs daily between 9:00 AM to 12:00 PM PH time.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"This panel updates the site's 10-Day Weather Forecast data by allowing admins to manually upload the excel files downloaded from PAGASA's web page. Follow the steps to update the site's 10-Day Weather Forecast data:"]}),(0,n.jsxs)("ol",{children:[(0,n.jsxs)("li",{children:["Download all (10) excel files from PAGASA's ",(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/climate/climate-prediction/10-day-climate-forecast",target:"_blank",rel:"noreferrer",children:"10 Day Climate Forecast"})," web page."]}),(0,n.jsx)("li",{children:"Press the SELECT FILES button and select all the excel files."}),(0,n.jsx)("li",{children:"Press the SUBMIT button."}),(0,n.jsx)("li",{children:"Wait for the upload process to finish."})]}),(0,n.jsx)(ed,{title:"Current Data Update Summary",children:(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Updated by:"}),"\xa0 ",i.updated_by]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Valid Until:"}),"\xa0 ",i.date_valid]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Date of Forecast:"}),"\xa0 ",i.date_forecast]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Date synced:"}),"\xa0 ",i.date_synced]})]})}),(0,n.jsx)(d.Z,{sx:eS,children:0===a.length?(0,n.jsx)("span",{children:"Select excel files."}):(0,n.jsx)(d.Z,{sx:{"& div":{margin:"2px"}},children:Array.from(a).map((e,a)=>(0,n.jsx)(es.Z,{label:e.name,size:"small"},"excel-".concat(a)))})}),(0,n.jsxs)(d.Z,{sx:eC,children:[!t.loading&&""!==t.error&&(0,n.jsx)(er.Z,{severity:"error",children:t.error}),!t.loading&&""!==t.msg&&(0,n.jsx)(er.Z,{severity:"success",children:t.msg})]}),(0,n.jsxs)("label",{htmlFor:"contained-button-file",children:[(0,n.jsx)(eZ,{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",id:"contained-button-file",multiple:!0,type:"file",name:"excel-files",onChange:l,disabled:t.loading}),(0,n.jsxs)(F.Z,{variant:"text",component:"span",size:"small",disabled:t.loading,disableElevation:!0,sx:{width:"110px"},children:["Select Files",(0,n.jsx)(el.Z,{size:20,color:"secondary",sx:{display:t.loading?"block":"none"}})]}),(0,n.jsx)(F.Z,{type:"submit",variant:"contained",size:"small",onClick:s,disabled:t.loading,disableElevation:!0,sx:{width:"110px"},children:"Submit"})]}),(0,n.jsx)(eb,{})]})};let eE={loading:!1,error:"",msg:""},eA={updated_by:"",date_forecast:"",date_synced:"",date_valid:""};var eT=function(e){let{getDateToString:a}=e,[t,s]=(0,i.useState)([]),[l,r]=(0,i.useState)(eE),[o,d]=(0,i.useState)(eA),{documents:c,loading:p,error:u}=(0,et.tl)(b.M.WEATHER_FORECASTS,"mimaropa","ten_day","name",1),h=(0,i.useCallback)(e=>{if(!e||!e.length)return;let t=e[0]||{},n=t.municipalities||{},i=Object.keys(n)[0];if(!i)return;let s=(n[i]||[])[0];s&&d({updated_by:t.updated_by||"",date_synced:t.date_created?a(t.date_created):"",date_forecast:s.date_forecast||"",date_valid:s.date_range||""})},[a]);(0,i.useEffect)(()=>{!p&&""===u&&c.length>0&&h(c)},[p,u,c,h]);let x=async()=>{let e=new FormData;for(let a=0;a<t.length;a+=1)e.append("excel-files",t[a]);try{r({...eE,loading:!0}),await (0,m.pc)(e),r({...eE,loading:!1,msg:"Upload success."})}catch(a){let e=a.response?a.response.data:a.message;r({...eE,loading:!1,error:e});return}try{let e=await (0,en.vx)();h(e)}catch(e){console.error(e.message)}};return(0,n.jsx)(ew,{files:t,status:l,logs:o,handleSubmit:x,handleSelectFiles:e=>{r(eE),s(e.target.files)}})},e_=t(819),eP=t(84325),eM=t(25837),eI=t(12166),eL=t(87406),ek=t(27151),eO={minHeight:"420px",margin:"8px","& .windsignalrow":{margin:"24px 0 24px 0"}};let eD={id:"municipalities",label:"Select All...",all:!0};var eN=function(e){let{item:a,signalNum:t="",onItemChange:l}=e,[r,o]=(0,i.useState)(!1),{ids:c,entities:p,status:u}=(0,s.v9)(e=>e.provinces),{ids:h,entities:g,status:m}=(0,s.v9)(e=>e.municipalities),f=(0,i.useMemo)(()=>[eD,...h.map(e=>g[e])],[g,h]);(0,i.useEffect)(()=>{var e,t;if(!r||!a.municipalities)return;let n=null!==(t=null===(e=f.filter(e=>e.disabled||void 0!==e.iscalendar))||void 0===e?void 0:e.length)&&void 0!==t?t:0;r&&a.municipalities.length!==h.length-n&&o(!1)},[null==a?void 0:a.municipalities,f,h,r]);let j=(0,n.jsx)(ek.Z,{fontSize:"small"}),b=(0,n.jsx)(eL.Z,{fontSize:"small"});return(0,n.jsxs)(d.Z,{sx:eO,children:[(0,n.jsxs)(d.Z,{className:"windsignalrow",children:[(0,n.jsx)(x.Z,{variant:"h5",color:"primary",children:(0,n.jsx)("strong",{children:"Wind Signal # ".concat(t)})}),(0,n.jsxs)(x.Z,{variant:"body2",sx:{marginTop:"8px"},children:["Select affected ",(0,n.jsx)("strong",{children:"provinces"})," and ",(0,n.jsx)("strong",{children:"municipalities"}),". Press the ",(0,n.jsx)("strong",{children:"OK"})," button to confirm your selection."]})]}),(0,n.jsx)(d.Z,{className:"windsignalrow",children:(0,n.jsx)(eM.Z,{disablePortal:!0,id:"province",value:a[0],disabled:0===c.length||u===v.G.PENDING||m===v.G.PENDING,options:c.map(e=>p[e]),renderInput:e=>(0,n.jsx)(Z.Z,{...e,variant:"standard",label:0===c.length?"Loading...":"Select a province"}),isOptionEqualToValue:(e,a)=>e.label===a.label,onChange:(e,a)=>{l({target:{id:"province",value:a,signal:t}})}})}),(0,n.jsx)(d.Z,{className:"windsignalrow",children:(0,n.jsx)(eM.Z,{multiple:!0,limitTags:4,disableCloseOnSelect:!0,id:"municipalities",value:a.municipalities,options:f,ListboxProps:{style:{maxHeight:"200px"}},sx:{".inputRoot":{color:"res"}},disabled:null===a.province||0===c.length||0===h.length||u===v.G.PENDING||m===v.G.PENDING,renderInput:e=>(0,n.jsx)(Z.Z,{...e,variant:"standard",label:0===c.length?"Loading...":"Select municipalities"}),renderOption:(e,a,t)=>{let{selected:i}=t;if(i&&a.label!==eD.label)return;let s=a.label===eD.label?r:i;return(0,n.jsxs)("li",{...e,children:[(0,n.jsx)(eI.Z,{icon:j,checkedIcon:b,style:{marginRight:8},checked:s}),a.label]})},getOptionDisabled:e=>e.disabled||void 0!==e.iscalendar,isOptionEqualToValue:(e,a)=>e.label===a.label,onChange:(e,a)=>{a.find(e=>e.label===eD.label)?(o(!0),l({target:{id:"municipalities",value:r?[]:f.filter(e=>!e.disabled&&!e.iscalendar&&e.label!==eD.label),signal:t}})):l({target:{id:"municipalities",value:a,signal:t}})}})})]})},eG=t(56112),eF=t(42823),eR={rowItem:{display:"flex",marginTop:"24px",maxWidth:"parent","& .MuiOutlinedInput-root":{paddingLeft:e=>e.spacing(2)}},btnCancel:{height:e=>e.spacing(5),width:"40px",borderTopLeftRadius:0,borderBottomLeftRadius:0,"& span":{marginRight:0}},btnGroup:{marginTop:"8px","& button":{width:"110px"},display:{sm:"flex",md:"unset"},flexDirection:{sm:"column"}},listContainer:{marginTop:"8px",padding:"16px",display:"flex",justifyContent:"space-between"}},eW=t(71687),eU=function(e){let{state:a,appstate:t,message:l,windsignalitems:r,updateinfo:o,onConfirmClick:c,onCancelClick:p,onLocationItemChange:u,handleInputChange:g,handleAddClick:m,handleClearClick:f,handleDeleteClick:j,handleDeleteProvince:b,handleReset:y,handleSaveClick:Z,handleAppState:E,currentItem:A}=e,T=(0,s.v9)(e=>e.provinces.status),_=(0,s.v9)(e=>e.municipalities.status),[L,k]=(0,i.useState)(!0),[O,D]=(0,i.useState)(0),[N,B]=(0,i.useState)(!1);(0,i.useEffect)(()=>{k(T===v.G.PENDING||_===v.G.PENDING||l.saving)},[T,_,l.saving]);let V=e=>{B(e=>!e),D(e)};return(0,n.jsxs)(d.Z,{sx:{minWidth:"300px",width:"100%",marginTop:"40px"},children:[(0,n.jsx)(x.Z,{variant:"h6",children:"Wind Speed List Editor"}),""!==l.MSG&&(0,n.jsx)(U.Z,{openSnackbar:!0,message:l.MSG,severity:l.TYPE}),(0,n.jsx)(W.Z,{openButtonText:null,maxWidth:"sm",title:l.TITLE,loading:l.saving,contentText:t!==eP.yf.EDIT?l.MODAL_MSG:null,modalConfirmHandlerCB:()=>{switch(t){case eP.yf.EDIT:B(e=>!e),c(O);break;case eP.yf.SAVE:Z()}},modalCancelHandlerCB:()=>{B(e=>!e),p()},isOpen:t===eP.yf.EDIT?N&&l.openLoadingModal:l.openLoadingModal,children:t===eP.yf.EDIT&&(0,n.jsx)(eN,{item:A,signalNum:O,onItemChange:u})}),(0,n.jsx)(S.ZP,{item:!0,xs:12,md:4,children:(0,n.jsxs)(S.ZP,{container:!0,spacing:3,children:[0===a.length?(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:7,children:(0,n.jsx)(eF.Z,{message:"There are no wind signal data. Encode wind signal data now for future viewing.",style:{marginTop:"16px"}})}):(0,n.jsx)(S.ZP,{item:!0,xs:12,lg:7,children:a.map((e,a)=>(0,n.jsxs)(eG.Z,{sx:{marginTop:"16px"},children:[(0,n.jsx)(R.Z,{id:"wsignal-".concat(a),size:"small",label:e.full,value:e.value,disabled:L,placeholder:"Enter a wind signal number",sx:eR.rowItem,onChange:g,InputProps:{startAdornment:(0,n.jsx)(C.Z,{position:"start",children:""===e.value?(0,n.jsx)(P.Z,{fontSize:"small",color:"primary"}):e.isValid?(0,n.jsx)(M.Z,{fontSize:"small",color:"secondary"}):(0,n.jsx)(I.Z,{fontSize:"small",sx:{color:w.Z[500]}})}),endAdornment:(0,n.jsxs)(G.Z,{disableElevation:!0,children:[(0,n.jsx)(F.Z,{size:"small",disabled:""===e.value||!e.isValid||L,sx:{width:"80px",borderTopLeftRadius:"0px",borderBottomLeftRadius:"0px"},onClick:()=>{V(e.value),E(eP.yf.EDIT,a)},children:"Edit"}),(0,n.jsx)(F.Z,{startIcon:(0,n.jsx)(J.Z,{fontSize:"small"}),sx:eR.btnCancel,onClick:()=>j(a,e.value),disabled:L})]})}},a),r.map((a,t)=>{if(a.signal===parseInt(e.value))return(0,n.jsxs)(h.Z,{sx:eR.listContainer,children:[(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(x.Z,{variant:"body1",children:(0,n.jsx)("strong",{children:a.province.label})}),(0,n.jsxs)(x.Z,{variant:"body2",children:["(",a.municipalities.map(e=>e.label).toString().split(",").join(", "),")"]})]}),(0,n.jsx)(d.Z,{children:(0,n.jsx)(F.Z,{sx:eR.btnCancel,startIcon:(0,n.jsx)(eW.Z,{fontSize:"small"}),disabled:L,onClick:()=>{b(parseInt(e.value),a.province.label)}})})]},"itm-".concat(t))})]},a))}),(0,n.jsxs)(S.ZP,{item:!0,xs:12,lg:5,children:[(0,n.jsx)(h.Z,{sx:{width:"parent",marginTop:"16px"},children:(0,n.jsxs)(z.Z,{sx:{fontWeight:400,fontSize:"0.875rem",lineHeight:"1.43",letterSpacing:"0.01071em",color:"rgba(0, 0, 0, 0.6)"},children:["Encode wind speed for hand-picked ",ec.Gt,' provinces and municipalities here. This data will be display on ACAP"s Special Weather Forecast section and used as reference on the Tropical Cyclone bulletins, if a typhoon will be detected from PAGASA"s web page.']})}),(0,n.jsx)(h.Z,{sx:{width:"parent",marginTop:"16px"},children:(0,n.jsx)(z.Z,{children:o})})]})]})}),(0,n.jsx)(S.ZP,{item:!0,xs:12,sx:{marginTop:"40px"},children:(0,n.jsxs)(G.Z,{variant:"text",disableElevation:!0,size:"small",sx:eR.btnGroup,disabled:L,children:[(0,n.jsx)(F.Z,{onClick:f,children:"Clear All"}),(0,n.jsx)(F.Z,{onClick:y,children:"Reset"}),(0,n.jsx)(F.Z,{onClick:m,children:"Add"}),(0,n.jsx)(F.Z,{onClick:()=>{B(e=>!e),E(eP.yf.SAVE)},variant:"contained",children:"Save"})]})})]})};let ez={id:-1,signal:-1,province:null,municipalities:[]},eB={MSG:"",TITLE:"",TYPE:"",MODAL_MSG:"",openLoadingModal:!1,saving:!1},eV={[eP.yf.SAVE]:{TITLE:"Save changes",MSG:"Save changes to the wind speed list?",SUCCESS:"Changes saved."},[eP.yf.SAVING]:{TITLE:"Save changes",MSG:"Saving data...",SUCCESS:"Changes saved."},[eP.yf.EDIT]:{TITLE:"Affected Provinces and Municipalities Form",MSG:"",SUCCESS:"Changes saved."}};var eH=function(){let{ids:e,entities:a,status:t,municipalities:r}=(0,s.v9)(e=>e.provinces),[o,d]=(0,i.useState)([]),[c,p]=(0,i.useState)(eB),[u,h]=(0,i.useState)([]),[x,g]=(0,i.useState)(ez),[f,y]=(0,i.useState)(eP.yf.VIEW),[S,C]=(0,i.useState)(""),[Z,w]=(0,i.useState)(-1),E=(0,s.I0)(),A=(0,i.useRef)(!1);!function(e){let[a,t]=(0,i.useState)([]),[n,r]=(0,i.useState)([]),[o,d]=(0,i.useState)(""),[c,p]=(0,i.useState)(!1),u=(0,s.I0)(),{ids:h,entities:x,municipalities:g,status:m,error:f}=(0,s.v9)(e=>e.provinces);(0,i.useEffect)(()=>{0===h.length?u((0,l.Q)()):(t(Object.values(x)),r([]))},[u,h.length,x]),(0,i.useEffect)(()=>{""!==f&&d(f)},[f]),(0,i.useEffect)(()=>{p(m===v.G.PENDING)},[m]),(0,i.useEffect)(()=>{},[u,void 0,g])}();let[T,_,P]=(0,et.ky)(b.M.WEATHER_FORECASTS,"".concat("mimaropa","/").concat(b.M.SUB_SPECIAL_COMMON,"/").concat(b.M.COMMON_SPECIAL_TYPE.WIND_SPEED));(0,i.useEffect)(()=>(A.current=!0,()=>{A.current=!1}),[]);let M=(0,i.useCallback)(()=>{if(!T||!T.data)return;let e=T.data.map(e=>e.value).filter((e,a,t)=>t.indexOf(e)===a).map((e,a)=>({id:a,value:e.toString(),isValid:!0,full:"Wind Signal"})),t=T.data.map((e,t)=>({id:t,signal:e.value,province:Object.values(a).find(a=>a.label===e.province),municipalities:e.municipalities.map((e,a)=>({id:a,label:e}))}));A.current&&(d(t),h(e),C("Updated by ".concat(T.updated_by," on ").concat((0,j.Xn)(T.date_created))))},[T,a]);(0,i.useEffect)(()=>{_||t!==v.G.FULLFILLED||M()},[e,_,t,P,M]);let I=e=>{let a=!1;for(let e=0;e<o.length;e+=1)if(o[e].province.label===x.province.label&&o[e].signal!==x.signal){let t=o[e].municipalities.map(e=>e.label);if(x.municipalities.map(e=>e.label).some(e=>t.indexOf(e)>=0)){a=!0;break}}return a},L=(e,a)=>{if(!A.current)return;let t=[...o];for(let e=0;e<t.length;e+=1)if(t[e].signal===parseInt(a)){for(let a=0;a<t[e].municipalities.length;a+=1)t[e].municipalities[a]=null;t[e].province=null,t[e]=null}d(e=>t.filter(e=>null!==e).map((e,a)=>({...e,id:a})));let n=[...u];n[e]=null,n.splice(e,1),h(e=>n.map((e,a)=>({...e,id:a})))},k=async()=>{if(void 0!==u.find(e=>""===e.value)||void 0!==u.find(e=>!1===e.isValid)){p(e=>({...eB,MSG:"Please check your input",TYPE:eP.J3.INFO,openLoadingModal:!e.openLoadingModal}));return}if(o.filter(e=>0===e.municipalities.length).length>0||o.map(e=>e.signal).filter((e,a,t)=>t.indexOf(e)===a).length!==u.length){p(e=>({...eB,MSG:"Please check your input",TYPE:eP.J3.INFO,openLoadingModal:!e.openLoadingModal}));return}try{p(e=>({...e,MODAL_MSG:"Saving data...",saving:!0}));let e=await (0,m.eg)({type:b.M.SUB_SPECIAL_COMMON,body:{data:o.map(e=>({...e,value:e.signal,province:e.province.label,municipalities:e.municipalities.map(e=>e.label)})),region:"mimaropa",type:b.M.COMMON_SPECIAL_TYPE.WIND_SPEED}});A.current&&(p(e=>({...eB,MSG:"Data successfully saved.",TYPE:eP.J3.SUCCESS,openLoadingModal:!e.openLoadingModal,saving:!1})),C(a=>"Updated by ".concat(e.updated_by," on ").concat((0,j.NK)(e.date_created))))}catch(e){A.current&&p({...eB,MSG:e.message,TYPE:eP.J3.ERROR,openLoadingModal:!1,saving:!1})}};return(0,n.jsx)(eU,{state:u,appstate:f,message:c,windsignalitems:o,updateinfo:S,onConfirmClick:e=>{let a=[...o];if(null===x.province)return;if(I(e)){p(e=>({...eB,MSG:"One or more of your selected municipalities have duplicates.",TYPE:eP.J3.INFO,openLoadingModal:!0})),g(ez);return}let t=o.findIndex(a=>a.signal===parseInt(e)&&a.province.label===x.province.label);if(-1===t){let t={id:o.length,signal:parseInt(e),province:x.province,municipalities:[...x.municipalities]};a.push(t);let n=[{...t,municipalities:t.municipalities}];d(e=>[...e,...n])}else a[t].municipalities=[...x.municipalities],d(e=>a);g(ez)},onCancelClick:()=>{g(ez),p(e=>({...e,openLoadingModal:!1}))},onLocationItemChange:e=>{let{id:a,value:t,signal:n}=e.target;if(null==t){"province"===a&&g(ez);return}if("province"===a){let e=t.label,a=o.filter(a=>a.province.label===e&&a.signal===parseInt(n));1===a.length?g(a[0]):g({...ez,id:o.length,signal:parseInt(n),province:{...t}}),E((0,e_.X4)(r[e]))}"municipalities"===a&&g(e=>({...e,municipalities:t}))},handleInputChange:function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update",{id:t,value:n}=e.target,i=t.split("-")[1],s=[...u];if(s[i]){if("clear"===a)s[i].value="",s[i].isValid=!1;else{if(""!==n&&void 0!==u.find(e=>e.value===n)){s[i].isValid=!1;return}let e={...s[i]};s[i].value=n,n.length>2||isNaN(n)||n>10?s[i].isValid=!1:(s[i].isValid=""!==n,""===n&&L(t,e.value))}A.current&&h(e=>s)}},handleAddClick:()=>{if(5===u.length||!A.current)return;let e=[...u];e.push({id:e.length,value:"",full:"Wind Signal"}),h(e)},handleClearClick:()=>{h([]),d([])},handleDeleteClick:L,handleDeleteProvince:(e,a)=>{let t=[...o];for(let n=0;n<t.length;n+=1)if(t[n].signal===parseInt(e)&&t[n].province.label===a){for(let e=0;e<t[n].municipalities.length;e+=1)t[n].municipalities[e]=null;t[n].province=null,t[n]=null}d(e=>t.filter(e=>null!==e).map((e,a)=>({...e,id:a})))},handleReset:()=>{A.current&&M()},handleSaveClick:k,handleAppState:(e,a)=>{w(e=>null!=a?a:-1),y(a=>e),p(a=>({...a,MSG:"",MODAL_MSG:eV[e].MSG,TITLE:eV[e].TITLE,openLoadingModal:!0}))},currentItem:x})},eY=function(e){let{state:a,cycloneLoading:t,onSyncPress:i}=e;return(0,n.jsxs)(d.Z,{sx:{fontSize:"14px"},children:[(0,n.jsx)(U.Z,{openSnackbar:""!==a.error||""!==a.msg,message:""!==a.error?a.error:a.msg,severity:""!==a.error?"error":"success"}),(0,n.jsx)(x.Z,{sx:{marginTop:e=>e.spacing(1)},variant:"h6",children:"Tropical Cyclone Bulletin Updater"}),(0,n.jsxs)(x.Z,{variant:"body2",sx:ey,children:["ACAP's system updates its ",(0,n.jsx)("strong",{children:"Special Weather Advisory"})," information by automatically scanning, extracting, and uploading the latest Tropical Cyclone data from PAGASA's ",(0,n.jsx)("strong",{children:(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/tropical-cyclone/severe-weather-bulletin",target:"_blank",rel:"noreferrer",children:"Tropical Cyclone Bulletin"})})," web page to ACAP's database.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"ACAP's  automatic Special Weather Advisory updates run daily every (2) two hours, starting from midnight PH time, with a lag time of 20 minutes to (1) one and a half hours.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"This panel updates ACAP's ",(0,n.jsx)("strong",{children:"Special Weather Advisory"})," content by manually initiating the  process of syncing PAGASA's latest published tropical cyclone data from their ",(0,n.jsx)("strong",{children:(0,n.jsx)("a",{href:"https://www.pagasa.dost.gov.ph/tropical-cyclone/severe-weather-bulletin",target:"_blank",rel:"noreferrer",children:"Tropical Cyclone Bulletin"})})," web page to ACAP."]}),(0,n.jsx)(x.Z,{variant:"body2",sx:ey,children:"Press the SYNC button below to start the data syncing process."}),(0,n.jsx)(ed,{title:"Current Data Update Summary",children:!t&&(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Updated by:"}),"\xa0 ",a.updated_by]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Date synced:"}),"\xa0 ",a.date_updated]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Summary:"}),"\xa0 ",a.summary]})]})}),(0,n.jsx)(y.Z,{variant:"contained",onClick:i,disabled:t||a.loading,children:"Sync"}),(0,n.jsx)("hr",{}),(0,n.jsx)(eH,{})]})},eX=t(88002),eJ=t(9669),eK=t.n(eJ),eQ=t(15426);let eq={SPECIAL_WEATHER_CYCLONE:"".concat("https://amia-cis-tmtk.onrender.com/api","/cyclone")};class e$ extends eQ.Z{async updateSpecialWeather(e){let a=await this.createRequestObject({body:e});return(await eK()({...a,url:eq.SPECIAL_WEATHER_CYCLONE,method:"POST"})).data}}let e0=new e$,e1=e0.updateSpecialWeather.bind(e0),{useEffect:e2,useState:e3,useRef:e5}=t(67294),e7={loading:!1,error:"",msg:"",updated_by:"",date_updated:"",summary:""};var e8=function(e){let{getDateToString:a}=e,[t,i,s]=(0,et.ky)(eX.K.GLOBAL_COLLECTIONS,eX.K.CYCLONE_ADVISORY),[l,r]=e3(e7),o=e5(!1);e2(()=>(o.current=!0,()=>{o.current=!1}),[]),e2(()=>{!i&&o.current&&(s?r({error:s}):r({loading:!1,error:"",msg:"",updated_by:"system"===t.updated_by?"system":t.email,date_updated:a(t.date_updated),summary:t.summary}))},[i,t,s,a]);let d=async()=>{try{r({...l,loading:!0,error:"",msg:""});let e=await e1({}),a=new Date(1e3*e.date_updated._seconds);e.date_updated="".concat(a.toDateString()," ").concat(a.toLocaleTimeString("it-IT",j.W6)),o.current&&r(a=>({...a,loading:!1,msg:"Successfully synced data.",updated_by:"system"===e.updated_by?"system":e.email,date_updated:e.date_updated,summary:e.summary}))}catch(e){o.current&&r(a=>({...a,loading:!1,error:e.message}))}};return(0,n.jsx)(eY,{state:l,cycloneLoading:i,onSyncPress:d})},e4=t(47407),e6=t(19304),e9=t(52311),ae=t(7638),aa=t(32200),at=t(76786),an=t(97535),ai=t(77745),as=t(95639),al=t(38660),ar=t(98037),ao=function(){let e={message:"",severity:"success"},[a,t]=(0,i.useState)(""),[s,l]=(0,i.useState)(!1),[r,o]=(0,i.useState)(null),[c,p]=(0,i.useState)(""),[u,h]=(0,i.useState)(e),{services:g,loading:m,error:f}=(0,al.Z)(a,s);(0,i.useEffect)(()=>{l(m||s)},[m,s]);let j=async()=>{if(a)try{l(!0),await (0,ar.Wn)({supportService:a}),h({message:"Successfully added a new support service.",severity:"success"}),t(""),l(!1),setTimeout(()=>h(e),1500)}catch(a){throw h({message:"Something went wrong.",severity:"error"}),l(!1),setTimeout(()=>h(e),1500),Error(a)}},v=(e,a)=>{o(e),p(a.data)},b=async a=>{if(a)try{l(!0),await (0,ar.vo)(a),h({message:"Successfully deleted a support service.",severity:"success"}),t(""),l(!1),setTimeout(()=>h(e),1500)}catch(a){throw h({message:"Something went wrong.",severity:"error"}),l(!1),setTimeout(()=>h(e),1500),Error(a)}},C=async a=>{try{l(!0),await (0,ar.Ef)({data:c,docId:a.docId,date:new Date}),h({message:"Successfully updated a support service.",severity:"success"}),o(null),p(""),l(!1),setTimeout(()=>h(e),1500)}catch(a){throw h({message:"Something went wrong.",severity:"error"}),l(!1),setTimeout(()=>h(e),1500),Error(a)}},w=()=>{o(null),p("")};return(0,n.jsxs)(d.Z,{sx:{"& li":{fontSize:"14px"}},children:[(0,n.jsxs)(x.Z,{sx:{marginTop:e=>e.spacing(1)},variant:"h6",children:["DA RFO ",ec.Tf," Support Services"]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px"},children:[(0,n.jsx)(Z.Z,{style:{width:"75%"},id:"outlined-basic",label:"Add Support Service",variant:"outlined",size:"small",value:a,onChange:e=>{t(e.target.value)},disabled:s}),s?(0,n.jsx)(el.Z,{size:24,color:"primary"}):(0,n.jsx)(y.Z,{disableElevation:!0,variant:"contained",disabled:!a,onClick:j,children:"ADD"})]}),(0,n.jsx)(S.ZP,{children:m?(0,n.jsx)("p",{children:"Loading data..."}):(0,n.jsx)(n.Fragment,{children:f?(0,n.jsx)("p",{children:"Something went wrong."}):(0,n.jsx)(n.Fragment,{children:g.length?(0,n.jsx)(e4.Z,{children:g.map((e,a)=>(0,n.jsx)(e6.ZP,{disablePadding:!0,children:(0,n.jsxs)(e9.Z,{disabled:s,children:[(0,n.jsx)(aa.Z,{primary:r===a?(0,n.jsx)(Z.Z,{value:c,onChange:e=>p(e.target.value),label:"Edit Support Service",variant:"outlined",size:"small",multiline:!0,style:{width:"75%"}}):e.data}),(0,n.jsx)("div",{style:{display:"flex",justifyItems:"center"},children:r===a?(0,n.jsxs)("span",{children:[(0,n.jsx)(ae.Z,{children:(0,n.jsx)(ai.Z,{color:"primary",onClick:()=>C(e)})}),(0,n.jsx)(ae.Z,{children:(0,n.jsx)(as.Z,{color:"primary",onClick:w})})]}):(0,n.jsx)(at.Z,{color:"primary",onClick:()=>v(a,e)})}),r!==a&&(0,n.jsx)(ae.Z,{children:(0,n.jsx)(an.Z,{color:"primary",disabled:s,onClick:()=>b(e.docId)})})]})},a))}):(0,n.jsx)("p",{children:"No data available."})})})}),(0,n.jsx)(U.Z,{openSnackbar:""!==u.message,message:u.message,severity:u.severity})]})},ad={marginTop:e=>e.spacing(6),border:e=>"1px solid ".concat(e.palette.bacap.border),minHeight:"800px",borderRadius:"8px",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px"},ac=function(){let[e,a]=(0,i.useState)(0);return(0,n.jsxs)("div",{children:[(0,n.jsxs)(h.Z,{sx:{border:"none"},children:[(0,n.jsx)(x.Z,{variant:"h5",children:"Weather Services Updater"}),(0,n.jsxs)("p",{children:["Update the site-wide ",(0,n.jsx)("strong",{children:"ACAP Services"})," weather forecast information for the ",(0,n.jsx)("strong",{children:"Seasonal"}),", ",(0,n.jsx)("strong",{children:"10-Day"})," ","and ",(0,n.jsx)("strong",{children:"Special Weather"})," Forecast sections by providing updated data."]}),(0,n.jsxs)("p",{children:["Please take caution in updating this information because they will be automatically referenced by all site admins when creating crop recommendations bulletins on the"," ",(0,n.jsx)("strong",{children:"Create Crop Bulletins"})," (10-Day and Seasonal) Admin pages. Global data updates made by admins are also viewable on the site's public ",(0,n.jsx)("strong",{children:"ACAP Services"})," page and used as references on the ",(0,n.jsx)("strong",{children:"Crop Recommendations"})," page."]})]}),(0,n.jsxs)(d.Z,{sx:ad,children:[(0,n.jsxs)(p.Z,{value:e,onChange:(e,t)=>{a(t)},"aria-label":"weather services updater",children:[(0,n.jsx)(c.Z,{label:"Seasonal",...(0,u.P)(0)}),(0,n.jsx)(c.Z,{label:"10-Day",...(0,u.P)(1)}),(0,n.jsx)(c.Z,{label:"Tropical Cyclone",...(0,u.P)(2)}),(0,n.jsx)(c.Z,{label:"Support Services",...(0,u.P)(3)})]}),(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(u.x,{value:e,index:0,children:(0,n.jsx)(ea,{})}),(0,n.jsx)(u.x,{value:e,index:1,children:(0,n.jsx)(eT,{getDateToString:j.Xn})}),(0,n.jsx)(u.x,{value:e,index:2,children:(0,n.jsx)(e8,{getDateToString:j.Xn})}),(0,n.jsx)(u.x,{value:e,index:3,children:(0,n.jsx)(ao,{})})]})]})]})};class ap extends i.Component{static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,a){console.error("Weather Page Error:",e,a),this.setState({error:e,errorInfo:a})}render(){return this.state.hasError?(0,n.jsxs)(d.Z,{sx:{padding:4},children:[(0,n.jsx)(x.Z,{variant:"h5",color:"error",gutterBottom:!0,children:"Something went wrong loading the Weather Services page"}),(0,n.jsx)(x.Z,{variant:"body1",paragraph:!0,children:this.state.error&&this.state.error.toString()}),(0,n.jsx)(y.Z,{variant:"contained",onClick:()=>window.location.reload(),children:"Reload Page"}),!1]}):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}}var au=(0,r.Z)(function(e){let a=(0,s.I0)(),t=(0,s.v9)(e=>e.provinces.ids);return(0,i.useEffect)(()=>{0===t.length&&a((0,l.Q)()).catch(e=>{console.error("Error fetching provinces:",e)})},[a,t]),(0,n.jsx)(o.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,accLevel:ec.DW.ADMIN,children:(0,n.jsx)(ap,{children:(0,n.jsx)(ac,{})})})})}},function(e){e.O(0,[3153,6856,190,8583,1664,6541,955,4073,2380,5837,6080,3481,3338,7988,3353,9227,1607,8591,2233,9503,2888,9774,179],function(){return e(e.s=29926)}),_N_E=e.O()}]);